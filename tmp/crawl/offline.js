(function(g){var window=this;'use strict';var B8s=function(C){var l=new g.nk("und",new g.AO("Default","und",!0));l.captionTracks=C.captionTracks;return l},zPR=function(C){return new g.du(function(l,b){var Q=C.length,O=[];
if(Q)for(var M=function(B,z){Q--;O[B]=z;Q==0&&l(O)},x=function(B){b(B)},Z,n=0;n<C.length;n++)Z=C[n],g.qQp(Z,g.On(M,n),x);
else l(O)})},f6=function(C){this.U=C},oT=function(){f6.apply(this,arguments)},T8M=function(){oT.apply(this,arguments)},m4B=function(){oT.apply(this,arguments)},ttn=function(){oT.apply(this,arguments)},U4$=function(){oT.apply(this,arguments)},A13=function(){oT.apply(this,arguments)},r1U=function(){oT.apply(this,arguments)},IKX=function(){f6.apply(this,arguments)},S5X=function(){oT.apply(this,arguments)},Xln=function(){oT.apply(this,arguments)},KpG=function(){oT.apply(this,arguments)},RPG=function(){oT.apply(this,
arguments)},uWU=function(){oT.apply(this,arguments)},wlY=function(){oT.apply(this,arguments)},ePs=function(){oT.apply(this,arguments)},d4M=function(){oT.apply(this,arguments)},c1I=function(){oT.apply(this,arguments)},PNR=function(){oT.apply(this,arguments)},v5s=function(){oT.apply(this,arguments)},aKR=function(){oT.apply(this,arguments)},Lpm=function(){f6.apply(this,arguments)},Vts=function(){oT.apply(this,arguments)},fKs=function(){oT.apply(this,arguments)},o5n=function(){oT.apply(this,arguments)},
FpM=function(){oT.apply(this,arguments)},jbX=function(){oT.apply(this,arguments)},y1M=function(){oT.apply(this,arguments)},Y5B=function(){oT.apply(this,arguments)},D4G=function(){oT.apply(this,arguments)},kRC=function(){oT.apply(this,arguments)},hPm=function(){f6.apply(this,arguments)},pls=function(){f6.apply(this,arguments)},Wp$=function(){f6.apply(this,arguments)},q53=function(){oT.apply(this,arguments)},J1B=function(){oT.apply(this,arguments)},Hd$=function(){oT.apply(this,arguments)},N8B=function(){oT.apply(this,
arguments)},E5R=function(){oT.apply(this,arguments)},g5M=function(){oT.apply(this,arguments)},C6R=function(){oT.apply(this,arguments)},leC=function(){oT.apply(this,arguments)},byB=function(){oT.apply(this,arguments)},iys=function(){oT.apply(this,arguments)},soq=function(){oT.apply(this,arguments)},QoY=function(){oT.apply(this,arguments)},OyB=function(){oT.apply(this,arguments)},M$B=function(){oT.apply(this,arguments)},xPX=function(){oT.apply(this,arguments)},Gmm=function(){oT.apply(this,arguments)},
$PU=function(){oT.apply(this,arguments)},ZyC=function(){oT.apply(this,arguments)},nDm=function(){oT.apply(this,arguments)},B3$=function(){oT.apply(this,arguments)},zIs=function(){oT.apply(this,arguments)},T3M=function(){oT.apply(this,arguments)},mPX=function(){oT.apply(this,arguments)},t$q=function(){oT.apply(this,arguments)},UPB=function(){oT.apply(this,arguments)},A0m=function(){oT.apply(this,arguments)},r0X=function(){f6.apply(this,arguments)},Ien=function(){oT.apply(this,arguments)},S2q=function(){oT.apply(this,
arguments)},XMG=function(){oT.apply(this,arguments)},Ksq=function(){oT.apply(this,arguments)},RIY=function(){oT.apply(this,arguments)},uIM=function(){oT.apply(this,arguments)},wMC=function(){oT.apply(this,arguments)},eIl=function(){oT.apply(this,arguments)},dP$=function(){oT.apply(this,arguments)},c0q=function(){oT.apply(this,arguments)},P6C=function(){oT.apply(this,arguments)},vD3=function(){oT.apply(this,arguments)},aeM=function(){oT.apply(this,arguments)},LsM=function(){oT.apply(this,arguments)},
V$m=function(){oT.apply(this,arguments)},feq=function(){oT.apply(this,arguments)},oDq=function(){oT.apply(this,arguments)},FsM=function(){oT.apply(this,arguments)},joG=function(){oT.apply(this,arguments)},y0M=function(){oT.apply(this,arguments)},Y2C=function(){oT.apply(this,arguments)},DP3=function(){oT.apply(this,arguments)},kmm=function(){oT.apply(this,arguments)},hI$=function(){oT.apply(this,arguments)},pM$=function(){oT.apply(this,arguments)},WsC=function(){oT.apply(this,arguments)},q2I=function(){oT.apply(this,
arguments)},J0I=function(){oT.apply(this,arguments)},HyR=function(){oT.apply(this,arguments)},N3I=function(){oT.apply(this,arguments)},EDm=function(){oT.apply(this,arguments)},gD$=function(){oT.apply(this,arguments)},C_3=function(C){C=C.key||C.id;
if(!C)throw Error("Entity key is missing");return C},liB=function(){if(FX)return FX();
var C={};FX=g.li("PersistentEntityStoreDb",{R5:(C.EntityStore={Zy:1},C.EntityAssociationStore={Zy:2},C),shared:!1,upgrade:function(l,b){b(1)&&g.fC(g.c8(l,"EntityStore",{keyPath:"key"}),"entityType","entityType");b(2)&&(l=g.c8(l,"EntityAssociationStore",{keyPath:["parentEntityKey","childEntityKey"]}),g.fC(l,"byParentEntityKey","parentEntityKey"),g.fC(l,"byChildEntityKey","childEntityKey"))},
version:3});return FX()},b8q=function(C){return g.hB(liB(),C)},i8R=function(C){return g.hB((0,g.YYU)(),C)},jJ=function(C){this.token=C},yA=function(C,l){l=l===void 0?{}:l;
g.qO.call(this,g.DoX[C],Object.assign({},{name:"PESEncoderError",type:C},l));this.type=C;this.level="WARNING";Object.setPrototypeOf(this,yA.prototype)},s5R=function(C){return new yA("WRONG_DATA_TYPE",{XY:C})},Q5U=function(C){return C instanceof Error?new yA("UNKNOWN_ENCODE_ERROR",{originalMessage:C.message}):new yA("UNKNOWN_ENCODE_ERROR")},O8Y=function(C){return C instanceof Error?new yA("UNKNOWN_DECODE_ERROR",{originalMessage:C.message}):new yA("UNKNOWN_DECODE_ERROR")},M5s=function(C,l){C=C instanceof
yA?C:l(C);
g.f9(C);throw C;},xEn=function(){},G8M=function(C,l,b){try{return C.Z(l,b)}catch(Q){M5s(Q,Q5U)}},$El=function(C){C=(new TextEncoder).encode(C).subarray(0,16);
var l=new Uint8Array(16);l.set(C);return l},YW=function(C){this.U=C},n4l=function(C){var l=Z83[C];
if(l)return l;g.os(new g.qO("Entity model not found.",{entityType:C}))},Bum=function(C,l){this.U=C;
this.j=l;this.Z={}},Tu3=function(C,l){a:{C=ze$(C.j,l.version);
try{var b=C.j(l.data,l.key);break a}catch(Q){M5s(Q,O8Y)}b=void 0}return b},D4=function(C,l,b){return C.U.objectStore("EntityStore").get(l).then(function(Q){if(Q){if(b&&Q.entityType!==b)throw Error("Incorrect entity type");
return Tu3(C,Q)}})},kW=function(C,l,b){return b?(b=b.map(function(Q){return D4(C,Q,l)}),g.R9.all(b)):C.U.objectStore("EntityStore").index("entityType").getAll(IDBKeyRange.only(l)).then(function(Q){return Q.map(function(O){return Tu3(C,O)})})},p6=function(C,l,b){var Q=C_3(l),O=ze$(C.j,1),M=Object.assign({},l);
return C.U.objectStore("EntityStore").get(Q).then(function(x){if(x){if(x.entityType!==b)throw Error("Incorrect entity type");M.entityMetadata||(x=Tu3(C,x),M.entityMetadata=x.entityMetadata)}}).then(function(){var x={key:Q,
entityType:b,data:G8M(O,M,Q),version:1};return g.R9.all([g.a9(C.U.objectStore("EntityStore"),x),mEn(C,M,b)])}).then(function(){hK(C,Q,b);
return Q})},t5s=function(C,l,b){l=l.map(function(Q){return p6(C,Q,b)});
return g.R9.all(l)},WK=function(C,l,b){if(b==null?0:b.U1){var Q=new Set;
return UEn(C,l,Q).then(function(){for(var M=[],x=g.I(Q),Z=x.next();!Z.done;Z=x.next())M.push(WK(C,Z.value));return g.R9.all(M).then(function(){})})}var O=g.Eb(l).entityType;
return g.R9.all([C.U.objectStore("EntityStore").delete(l),A2U(C,l)]).then(function(){hK(C,l,O)})},r2$=function(C,l){return g.yn(C.U.objectStore("EntityStore").index("entityType"),{query:IDBKeyRange.only(l)},function(b){return g.R9.all([b.delete(),
A2U(C,b.cursor.primaryKey)]).then(function(){hK(C,b.cursor.primaryKey,l);return g.FD(b)})})},Iiq=function(C,l,b,Q){var O=ze$(C.j,1);
return D4(C,l,Q).then(function(M){if(M){M=g.Ub(M,b);var x={key:l,entityType:Q,data:G8M(O,M,l),version:1};return g.R9.all([g.a9(C.U.objectStore("EntityStore"),x),mEn(C,M,Q)])}}).then(function(){hK(C,l,Q);
return l})},hK=function(C,l,b){var Q=C.Z[b];
Q||(Q=new Set,C.Z[b]=Q);Q.add(l)},SJB=function(C,l,b){var Q=C_3(l);
b=n4l(b);if(!b)return g.R9.resolve([]);b=new b(l);C=C.U.objectStore("EntityAssociationStore");l=[];b=g.I(b.j());for(var O=b.next();!O.done;O=b.next())l.push(g.a9(C,{parentEntityKey:Q,childEntityKey:O.value}));return g.R9.all(l).then(function(M){return M.map(function(x){return x[1]})})},A2U=function(C,l){return C.U.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(l))},mEn=function(C,l,b){var Q=C_3(l);
return A2U(C,Q).then(function(){return SJB(C,l,b)})},UEn=function(C,l,b){if(b.has(l))return g.R9.resolve(void 0);
b.add(l);return XAY(C,l).then(function(Q){return C.U.objectStore("EntityAssociationStore").index("byParentEntityKey").delete(IDBKeyRange.only(l)).then(function(){return Q})}).then(function(Q){var O=g.R9.resolve(void 0);
Q=g.I(Q);for(var M=Q.next(),x={};!M.done;x={gj:void 0},M=Q.next())x.gj=M.value,O=O.then(function(Z){return function(){return UEn(C,Z.gj,b)}}(x));
return O}).then(function(){})},XAY=function(C,l){var b=C.U.objectStore("EntityAssociationStore");
return b.index("byParentEntityKey").getAll(IDBKeyRange.only(l)).then(function(Q){var O=[];Q=g.I(Q);for(var M=Q.next();!M.done;M=Q.next())M=M.value,O.push(b.index("byChildEntityKey").getAll(M.childEntityKey));return g.R9.all(O)}).then(function(Q){var O=[];
Q=g.I(Q);for(var M=Q.next();!M.done;M=Q.next())M=M.value,M.length===1&&O.push(M[0].childEntityKey);return O})},qR=function(){},KeI=function(){this.U={};
this.U[0]=new qR;if(!g.ID("aes_pes_encoder_killswitch")){var C=this.U;try{var l=g.J3();var b=$El(l);var Q=new YW(new g.Kn(b),new g.XJ(b))}catch(O){throw C=O instanceof Error?new yA("KEY_CREATION_FAILED",{originalMessage:O.message}):new yA("KEY_CREATION_FAILED"),g.f9(C),C;}C[1]=Q}},ze$=function(C,l){l=l===void 0?0:l;
C=C.U[l];if(!C)throw l=new yA("INVALID_ENCODER_VERSION",{XY:l}),g.f9(l),l;return C},JK=function(C,l){g.F.call(this);
this.token=C;this.U=l;this.observers=[];C=new g.qp.BroadcastChannel("PERSISTENT_ENTITY_STORE_SYNC:"+g.J3());C.onmessage=this.j.bind(this);this.channel=C},HK=function(C,l,b){var Q,O,M,x;
return g.V(function(Z){if(Z.j==1)return g.P(Z,b8q(C.token),2);if(Z.j!=3)return Q=Z.U,g.P(Z,g.v8(Q,["EntityStore","EntityAssociationStore"],l,function(n){O=new Bum(n,C.U);return b(O)}),3);
M=Z.U;O&&(x=O.Z,Object.keys(x).length>0&&(C.channel.postMessage(x),ReM(C,x)));return Z.return(M)})},NR=function(C,l,b){return HK(C,{mode:"readwrite",
Wm:!0},function(Q){return p6(Q,l,b)})},uxI=function(C,l){return HK(C,{mode:"readwrite",
Wm:!0},function(b){return t5s(b,l,"offlineOrchestrationActionWrapperEntity")})},wAs=function(C,l){return HK(C,{mode:"readwrite",
Wm:!0},function(b){return WK(b,l)})},eeI=function(C){return HK(C,{mode:"readwrite",
Wm:!0},function(l){return r2$(l,"videoPlaybackPositionEntity")})},Ec=function(C,l,b){return HK(C,{mode:"readonly",
Wm:!0},function(Q){return D4(Q,l,b)})},gF=function(C,l,b){return HK(C,{mode:"readonly",
Wm:!0},function(Q){return kW(Q,l,b)})},ReM=function(C,l){C=g.I(C.observers);
for(var b=C.next();!b.done;b=C.next())b=b.value,b(l)},dEX=function(){var C,l,b;
return g.V(function(Q){if(Q.j==1)return g.IP(Q,2),g.P(Q,g.gJ(),4);if(Q.j!=2){C=Q.U;if(!C||!g.Hx()||typeof g.qp.BroadcastChannel==="undefined")return Q.return();l=new KeI;return Q.return(new JK(C,l))}b=g.ek(Q);b instanceof Error&&g.f9(b);return Q.return()})},Cc=function(){c2R||(c2R=dEX());
return c2R},P_G=function(C){var l;
C=(l=C.options)==null?void 0:l.persistenceOption;return C==="ENTITY_PERSISTENCE_OPTION_PERSIST"||C==="ENTITY_PERSISTENCE_OPTION_INMEMORY_AND_PERSIST"},v4$=function(C){var l;
return g.V(function(b){return b.j==1?g.P(b,Cc(),2):(l=b.U)?g.P(b,HK(l,"readwrite",function(Q){for(var O={},M=g.I(C),x=M.next(),Z={};!x.done;Z={L5:void 0,Yd:void 0},x=M.next())Z.L5=x.value,Z.L5.entityKey&&P_G(Z.L5)&&(Z.Yd=g.hG(Z.L5.payload),x=void 0,Z.L5.type==="ENTITY_MUTATION_TYPE_REPLACE"&&(x=function(n){return function(){return p6(Q,n.L5.payload[n.Yd],n.Yd)}}(Z)),Z.L5.type==="ENTITY_MUTATION_TYPE_DELETE"&&(x=function(n){return function(){return WK(Q,n.L5.entityKey)}}(Z)),Z.L5.type==="ENTITY_MUTATION_TYPE_UPDATE"&&
(x=function(n){return function(){return Iiq(Q,n.L5.entityKey,n.L5.payload[n.Yd],n.Yd)}}(Z)),x&&(O[Z.L5.entityKey]=O[Z.L5.entityKey]?O[Z.L5.entityKey].then(x):x()));
return g.R9.all(Object.values(O))}),0):b.return()})},aiY=function(C){var l;
return g.V(function(b){if(b.j==1){l=C.mutations;if(!l||l.length<=0)return b.return();if(g.OA){var Q={type:"ENTITY_LOADED"};l!==void 0&&(Q.payload=l);g.OA.dispatch(Q)}return g.P(b,v4$(l),2)}l.length=0;g.r6(b)})},LeR=function(C){return C!==void 0},V5M=function(C){var l=g.ax();
l=Object.assign({},l);C=Object.assign({},C);for(var b in l)C[b]?(l[b]!==4&&(l[b]=C[b]),delete C[b]):l[b]!==2&&(l[b]=4);Object.assign(l,C);g.xHS(l);JSON.stringify(l);return l},fi$=function(C){var l,b;
return g.V(function(Q){if(Q.j==1)return g.P(Q,g.gJ(),2);if(Q.j!=3)return(l=Q.U)?g.P(Q,g.fv(l),3):Q.return();b=Q.U;return Q.return(g.v8(b,["index","media","captions"],{mode:"readwrite",Wm:!0},function(O){var M=IDBKeyRange.bound(C+"|",C+"~");O=[O.objectStore("index").delete(M),O.objectStore("media").delete(M),O.objectStore("captions").delete(M)];return g.R9.all(O).then(function(){})}))})},o4C=function(){var C,l;
return g.V(function(b){if(b.j==1)return g.P(b,g.gJ(),2);if(b.j!=3){C=b.U;if(!C)throw g.XD("rvdfd");return g.P(b,g.fv(C),3)}l=b.U;return b.return(g.v8(l,["index","media"],{mode:"readwrite",Wm:!0},function(Q){var O={};return g.o9(Q.objectStore("index"),{},function(M){var x=M.cursor.key.match(/^([\w\-_]+)\|(a|v)$/),Z=g.R9.resolve(void 0);if(x){var n=x[1];x=x[2];O[n]=O[n]||{};var B;O[n][x]=g.BPg((B=M.getValue())==null?void 0:B.fmts)}else Z=M.delete().then(function(){});
return g.R9.all([g.FD(M),Z]).then(function(z){return g.I(z).next().value})}).then(function(){for(var M={},x=g.I(Object.keys(O)),Z=x.next();!Z.done;Z=x.next()){Z=Z.value;
var n=O[Z].v;M[Z]=O[Z].a&&n?1:2}var B=V5M(M);return g.K7p(Q.objectStore("media"),{},function(z){var T=z.cursor.key.match(g.tn6);T&&M[T[1]]||Q.objectStore("media").delete(z.cursor.key);return g.TAC(z)}).then(function(){return B})})}))})},Fe$=function(C,l){var b,Q;
return g.V(function(O){if(O.j==1)return g.P(O,g.gJ(),2);if(O.j!=3){b=O.U;if(!b)throw g.XD("wct");return g.P(O,g.fv(b),3)}Q=O.U;return g.P(O,g.v8(Q,["captions"],{mode:"readwrite",Wm:!0},function(M){var x=[];M=M.objectStore("captions");for(var Z=0;Z<l.length;Z++){var n=g.a9(M,l[Z],C+"|"+l[Z].metadata.vss_id);x.push(n)}return g.R9.all(x)}),0)})},j5s=function(C){var l,b,Q;
return g.V(function(O){if(O.j==1)return l=IDBKeyRange.bound(C+"|",C+"~"),g.P(O,g.gJ(),2);if(O.j!=3){b=O.U;if(!b)throw g.XD("gactfv");return g.P(O,g.fv(b),3)}Q=O.U;return O.return(Q.getAll("captions",l))})},y2q=function(C){return g.V(function(l){g.Vc(C,0);
return l.return(fi$(C))})},YJq=function(C){return{context:g.gZ(),
videoIds:C}},DE$=function(C){return{context:g.gZ(),
playlistIds:C}},k8s=function(C){return{context:g.gZ(),
offlinePlaylistSyncChecks:C}},heI=function(){this.U=new Map},We3=function(){pAl||(pAl=new heI);
return pAl},qJX=function(C,l){return{eventType:{flowEventNamespace:"FLOW_EVENT_NAMESPACE_OFFLINE_ORCHESTRATION",
flowEventType:C},metadata:l,statusCode:void 0,csn:void 0,can:void 0}},J2n=function(C,l,b){if(!b){var Q=Q===void 0?!1:Q;
b=C.U.get("FLOW_TYPE_OFFLINE_ORCHESTRATION");if(!b||Q)b=g.KA(16),C.U.set("FLOW_TYPE_OFFLINE_ORCHESTRATION",b)}C={flowNonce:b,flowType:"FLOW_TYPE_OFFLINE_ORCHESTRATION",flowEventType:l.eventType};l.metadata&&(C.flowMetadata=l.metadata);l.statusCode!==void 0&&(C.flowEventStatus=l.statusCode);l.csn&&(C.csn=l.csn);l.can&&(C.can=l.can);g.ZM("flowEvent",C,void 0)},H8U=function(C){var l,b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a,y,J,W,io,Qp,CR,GT,N,Sk,w6,km,RI,Gq,d6,uo,Qm,K,xm,WB,Sd;
return g.V(function(cB){if(cB.j==1)return g.P(cB,HK(C,{mode:"readonly",Wm:!0},function(mC){return kW(mC,"playbackData").then(function(yp){var Vm=yp.map(function(c){return c.transfer}).filter(function(c){return!!c}),PB=yp.map(function(c){return c.offlineVideoPolicy}).filter(function(c){return!!c}),e=yp.filter(function(c){return!!c.key}).map(function(c){return g.gG(g.Eb(c.key).entityId,"downloadStatusEntity")});
Vm=kW(mC,"transfer",Vm);PB=kW(mC,"offlineVideoPolicy",PB);e=kW(mC,"downloadStatusEntity",e);var d=Vm.then(function(c){c=c.reduce(function(L,k){(k==null?0:k.offlineVideoStreams)&&L.push.apply(L,g.w(k.offlineVideoStreams));return L},[]).filter(function(L){return!!L});
return kW(mC,"offlineVideoStreams",c)});
return g.R9.all([Vm,PB,d,e]).then(function(c){var L=g.I(c);c=L.next().value;var k=L.next().value;var KR=L.next().value;L=L.next().value;return[yp,c,k,KR,L]})})}),2);
if(cB.j!=3)return l=cB.U,g.P(cB,HK(C,{mode:"readonly",Wm:!0},function(mC){return kW(mC,"mainDownloadsListEntity").then(function(yp){var Vm,PB;return(PB=(Vm=yp[0])==null?void 0:Vm.downloads)!=null?PB:[]})}),3);
b=cB.U;Q=g.I(l);O=Q.next().value;M=Q.next().value;x=Q.next().value;Z=Q.next().value;n=Q.next().value;B=O;z=M;T=x;m=Z;t=n;U={};S={};X={};u={};R={};v=[];a=g.I(z);for(y=a.next();!y.done;y=a.next())(J=y.value)&&(U[J.key]=J);W=g.I(T);for(io=W.next();!io.done;io=W.next())(Qp=io.value)&&(S[Qp.key]=Qp);CR=g.I(t);for(GT=CR.next();!GT.done;GT=CR.next())(N=GT.value)&&(X[N.key]=N);Sk=g.I(m);for(w6=Sk.next();!w6.done;w6=Sk.next())(km=w6.value)&&(u[km.key]=km);RI=g.I(b);for(Gq=RI.next();!Gq.done;Gq=RI.next())d6=
Gq.value,uo=void 0,R[(uo=d6.videoItem)!=null?uo:""]=!0,d6.videoItem&&(K=Qm=void 0,xm=(K=(Qm=g.Eb(d6.videoItem))==null?void 0:Qm.entityId)!=null?K:"",v.push({externalVideoId:xm}));WB=B.filter(function(mC){if(!mC||!mC.key||!mC.offlineVideoPolicy)return!1;mC=g.Eb(mC.key).entityId;mC=g.gG(mC,"downloadStatusEntity");var yp;return!(mC&&((yp=X[mC])==null?void 0:yp.downloadState)==="DOWNLOAD_STATE_USER_DELETED")});
Sd=WB.map(function(mC){var yp=U[mC.transfer],Vm=[];if(yp==null?0:yp.offlineVideoStreams)for(var PB=g.I(yp.offlineVideoStreams),e=PB.next();!e.done;e=PB.next())(e=u[e.value])&&Vm.push(e);PB=S[mC.offlineVideoPolicy];e=R;var d=mC==null?void 0:mC.playerResponseTimestamp,c=g.Eb(PB.key).entityId;mC=g.gG(c,"mainVideoEntity");if(PB.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"){var L="OFFLINE_VIDEO_STATE_DISABLED";PB.expirationTimestamp&&Number(PB.expirationTimestamp)<Date.now()/1E3&&(L="OFFLINE_VIDEO_STATE_EXPIRED")}else if(PB.action===
"OFFLINE_VIDEO_POLICY_ACTION_DOWNLOAD_FAILED")L="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";else{switch(yp==null?void 0:yp.transferState){case "TRANSFER_STATE_TRANSFER_IN_QUEUE":L="OFFLINE_VIDEO_STATE_PENDING";break;case "TRANSFER_STATE_TRANSFERRING":L="OFFLINE_VIDEO_STATE_TRANSFERRING";break;case "TRANSFER_STATE_PAUSED_BY_USER":L="OFFLINE_VIDEO_STATE_PAUSED_TRANSFER";break;case "TRANSFER_STATE_FAILED":L="OFFLINE_VIDEO_STATE_OFFLINE_FAILED";break;case "TRANSFER_STATE_COMPLETE":L="OFFLINE_VIDEO_STATE_PLAYABLE";
break;case "TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH":L="OFFLINE_VIDEO_STATE_STREAMS_OUT_OF_DATE";break;default:L="OFFLINE_VIDEO_STATE_UNKNOWN"}if(L==="OFFLINE_VIDEO_STATE_OFFLINE_FAILED")switch(yp==null?void 0:yp.failureReason){case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":L="OFFLINE_VIDEO_STATE_OUT_OF_STORAGE_ERROR";break;case "TRANSFER_FAILURE_REASON_STREAM_MISSING":L="OFFLINE_VIDEO_STATE_STREAMS_MISSING";break;case "TRANSFER_FAILURE_REASON_NETWORK":case "TRANSFER_FAILURE_REASON_NETWORK_LOST":L=
"OFFLINE_VIDEO_STATE_NETWORK_ERROR"}}c={id:c,videoState:L};if(yp==null?0:yp.cotn)c.cotn=yp.cotn;if(yp==null?0:yp.maximumDownloadQuality)c.selectedVideoQuality=yp==null?void 0:yp.maximumDownloadQuality;if(yp==null?0:yp.lastProgressTimeMs)c.lastProgressTimeMs=yp.lastProgressTimeMs;d&&(c.playerResponseSavedTimeMs=String(Number(d)*1E3));yp=String;d=0;Vm=g.I(Vm);for(L=Vm.next();!L.done;L=Vm.next())if(L=L.value,L.streamsProgress){L=g.I(L.streamsProgress);for(var k=L.next();!k.done;k=L.next()){var KR=void 0;
d+=Number((KR=k.value.numBytesDownloaded)!=null?KR:0)}}c.downloadedBytes=yp(d);c.selectedOfflineMode=e[mC]?"OFFLINE_MODE_TYPE_AUTO_OFFLINE":"OFFLINE_NOW";PB.action==="OFFLINE_VIDEO_POLICY_ACTION_DISABLE"&&(c.offlinePlaybackDisabledReason=PB.offlinePlaybackDisabledReason);return c});
return cB.return({offlineVideos:Sd,additionalOfflineClientState:{mainAppAdditionalOfflineClientState:{smartDownloadVideos:v}}})})},NuI=function(){this.locks=navigator.locks},E4q=function(){try{var C=g.HF("ytglobal.locks_");
if(C)return C;var l;if(l=navigator){var b=navigator;l="locks"in b&&!!b.locks}if(l)return g.qp.localStorage&&g.qp.localStorage.getItem("noop"),C=new NuI,g.JL("ytglobal.locks_",C),C}catch(Q){}},l9=function(){},g4m=function(){},CHM=function(C){if(C.includes(":"))throw Error("Invalid user cache name: "+C);
return C+":"+g.J3("CacheStorage get")},lvn=function(){return g.V(function(C){if(b9!==void 0)return C.return(b9);
b9=new Promise(function(l){var b;return g.V(function(Q){switch(Q.j){case 1:return g.IP(Q,2),g.P(Q,i9.open("test-only"),4);case 4:return g.P(Q,i9.delete("test-only"),5);case 5:g.RP(Q,3);break;case 2:if(b=g.ek(Q),b instanceof Error&&b.name==="SecurityError")return l(!1),Q.return();case 3:l("caches"in window),g.r6(Q)}})});
return C.return(b9)})},iWC=function(){return g.V(function(C){if(C.j==1)return g.P(C,lvn(),2);
if(!C.U)return C.return(void 0);bWB||(bWB=new g4m);return C.return(bWB)})},sV=function(C,l,b){g.os(new g.qO("Woffle: "+C,b?{cotn:b}:""));
l instanceof Error&&g.os(l)},svX=function(C){var l;
return g.V(function(b){if(b.j==1)return g.P(b,H8U(C),2);l=b.U;g.ZM("offlineStateSnapshot",l);g.r6(b)})},Qt=function(C){g.F.call(this);
var l=this;this.api=C;this.dF={E2y:function(){return l.U},
qgC:function(){return l.j}};
typeof g.qp.BroadcastChannel!=="undefined"&&(this.U=new g.qp.BroadcastChannel("PLAYER_OFFLINE_ERROR_SYNC:"+g.J3()),this.U.onmessage=this.Z.bind(this),this.j=new g.qp.BroadcastChannel("PLAYER_OFFLINE_PAUSE_SYNC:"+g.J3()),this.j.onmessage=this.C.bind(this))},OV=function(C,l){C.api.VY("onOfflineOperationFailure",l);
var b;(b=C.U)==null||b.postMessage(l)},QvG=function(C,l,b,Q){var O=this;
this.N=C;this.Y=l;this.visibility=b;this.D=Q;this.B=this.K=this.S=this.Z=this.U=!1;this.C=new g.Nc(function(){O.pG()});
this.dF={wZ:function(){return O.j},
pG:function(){O.pG()},
AHi:function(){return O.C}};
this.visibility.subscribe("visibilitystatechange",function(){O.df()})},OWl=function(C){if(!C.Z&&!C.U){var l=E4q();
if(l){C.Z=!0;var b=g.J3("OfflineLockManager");l.request("woffle_orchestration_leader:"+b,{},function(){var Q,O,M,x;return g.V(function(Z){switch(Z.j){case 1:return g.IP(Z,2),C.j=new g.zQ,C.U=!0,C.Z=!1,g.P(Z,C.N(),4);case 4:return g.P(Z,C.j.promise,5);case 5:g.RP(Z,0);break;case 2:Q=g.ek(Z),((M=(O=C).D)==null?0:M.call(O,"wo_relinquish_leadership_on_lock_request_error"))||C.pG(),Q instanceof Error&&(x=Q,x.args=[{name:"WoLockManagerError",CG:Q.name}],g.f9(x)),g.r6(Z)}})})}}},MCq=function(C){C.U&&(C.B=
!0,MF(C))},xmX=function(C,l){C.U&&(C.S=l,MF(C))},GQq=function(C,l){C.U&&(C.K=l,MF(C))},MF=function(C){C.K&&C.S&&C.B&&C.visibility.isBackground()?g.Eg(C.C,6E4):C.C.stop()},xs=function(C){var l;
C.offlineDeleteReason=(l=C.offlineDeleteReason)!=null?l:"OFFLINE_DELETE_REASON_UNKNOWN";var b;C.offlineModeType=(b=C.offlineModeType)!=null?b:"OFFLINE_NOW";g.ZM("offlineDeleteEvent",C)},GY=function(C,l){var b=l.videoId;
var Q=l.s0;l=l.offlineModeType;C.encryptedVideoId=b;C.cotn=Q==null?void 0:Q.cotn;C.offlineabilityFormatType=Q==null?void 0:Q.maximumDownloadQuality;var O;C.isRefresh=(O=Q==null?void 0:Q.isRefresh)!=null?O:!1;var M;C.softErrorCount=(M=Q==null?void 0:Q.transferRetryCount)!=null?M:0;C.offlineModeType=l!=null?l:"OFFLINE_NOW";(C.transferStatusType==="TRANSFER_STATUS_TYPE_UNKNOWN"&&C.statusType==="UNKNOWN_STATUS_TYPE"||!C.transferStatusType&&!C.statusType)&&g.os(Error("Woffle unknown transfer status"));
g.ZM("offlineTransferStatusChanged",C)},$m3=function(C){GY({transferStatusType:"TRANSFER_STATUS_TYPE_ENQUEUED",
statusType:"ADDED_TO_QUEUE"},C)},ZWC=function(C,l,b,Q){Q={transferStatusType:"TRANSFER_STATUS_TYPE_PROCESSING",
statusType:"OFFLINING_STARTED",transferFirstStarted:!!Q};l&&b&&(l=Math.floor(l/1024).toFixed(),b=Math.floor(b/1024).toFixed(),Q.alreadyDownloadedKbytes=l,Q.totalFetchedKbytes=l,Q.totalContentKbytes=b);GY(Q,C)},nBI=function(C){GY({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_PLAYER_RESPONSE_REFRESH"},C)},BrM=function(C){GY({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_USER_PAUSE",
statusType:"SUSPENDED"},C)},zqn=function(C){switch(C){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":return"OFFLINE_DATABASE_ERROR";
case "TRANSFER_FAILURE_REASON_PLAYABILITY":return"NOT_PLAYABLE";case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":return"TOO_MANY_RETRIES";case "TRANSFER_FAILURE_REASON_INTERNAL":return"OFFLINE_DOWNLOAD_CONTROLLER_ERROR";case "TRANSFER_FAILURE_REASON_STREAM_MISSING":return"STREAM_VERIFICATION_FAILED";case "TRANSFER_FAILURE_REASON_SERVER":case "TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING":return"OFFLINE_REQUEST_FAILURE";case "TRANSFER_FAILURE_REASON_NETWORK":return"OFFLINE_NETWORK_ERROR";default:return"UNKNOWN_FAILURE_REASON"}},
$s=function(C){var l,b,Q;
return((Q=(l=C.actionMetadata)==null?void 0:(b=l.retryScheduleIntervalsInSeconds)==null?void 0:b.length)!=null?Q:0)>0},ZE=function(C){return C.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD"&&!!C.entityKey},nc=function(C){return C.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&!!C.entityKey},Be=function(C){return C.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&!!C.entityKey},Trn=function(C){return C.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE"&&!!C.entityKey},
zY=function(C,l,b,Q,O){O=O===void 0?!1:O;
var M,x,Z,n,B,z;return g.V(function(T){if(T.j==1)return M=g.gG(C,l),x=g.gG(C,"downloadStatusEntity"),g.P(T,HK(b,{mode:"readonly",Wm:!0},function(m){return g.R9.all([D4(m,M,l),D4(m,x,"downloadStatusEntity")])}),2);
Z=T.U;n=Z.length?Z[0]:void 0;if(!n)return T.oY(0);B=mmR;if(z=Z.length>1?Z[1]:void 0){if(z.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&!O)return T.return();z.downloadState=Q}else z={key:x,downloadState:Q};g.D_(n,B,z);return g.P(T,HK(b,{mode:"readwrite",Wm:!0},function(m){return g.R9.all([p6(m,n,l),p6(m,z,"downloadStatusEntity")])}),0)})},TY=function(C,l){return C.actionType===l.actionType&&C.entityKey===l.entityKey},mE=function(C,l){if(C&&C.transferState!=="TRANSFER_STATE_COMPLETE"&&C.transferState!==
"TRANSFER_STATE_FAILED"){var b=g.Eb(C.key).entityId;
GY({transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_BY_USER",statusType:"CANCELLED"},{videoId:b,s0:C,offlineModeType:l})}},tJ=function(C){if(!C||!C.thumbnails)return[];
var l=[];C=g.I(C.thumbnails);for(var b=C.next();!b.done;b=C.next())b=b.value,b.url&&l.push(b.url);return l},tCM=function(C,l,b){b=b===void 0?[]:b;
var Q,O,M,x,Z,n,B,z,T,m,t,U,S;return g.V(function(X){if(X.j==1)return b.length?g.P(X,gF(C,l),2):X.return([]);Q=X.U;O=new Set;M=g.I(Q);for(x=M.next();!x.done;x=M.next())if(Z=x.value,n=Z.id||Z.key)B=g.Eb(n).entityId,O.add(B);z=[];T=g.I(b);for(m=T.next();!m.done;m=T.next())t=m.value,U=t.offlineVideoData,S=void 0,((S=U)==null?0:S.videoId)&&!O.has(U.videoId)&&z.push(t);return X.return(z)})},Um$=function(C,l,b){return new g.Jv(C,{cotn:l,
raw_player_response:b,download_media:!0,start:Infinity,disable_watch_next:!0})},AbC=function(){return{priority:1,
retryScheduleIntervalsInSeconds:[1,2,4]}},UV=function(C,l,b,Q,O,M,x,Z,n,B,z){this.entityType=C;
this.actionId=l;this.action=b;this.parentActionId=Q;this.rootActionId=O===void 0?l:O;this.childActionIds=M;this.prereqActionId=x;this.postreqActionIds=Z;this.hasChildActionFailed=B;this.retryScheduleIndex=0;this.U=z||Date.now();this.retryScheduleIndex=n||0},AJ=function(C){if(!C.key)throw Error("Entity key is required.");
if(!C.actionProto)throw Error("OfflineOrchestrationAction is required.");var l=g.Eb(C.key),b=g.Eb(C.actionProto.entityKey);return new UV(b.entityType,l.entityId,C.actionProto,C.parentActionId,C.rootActionId,C.childActionIds,C.prereqActionId,C.postreqActionIds,C.retryScheduleIndex,C.hasChildActionFailed,Number(C.enqueueTimeSec)*1E3)},ri=function(C){return{key:g.gG(C.actionId,"offlineOrchestrationActionWrapperEntity"),
actionProto:C.action,parentActionId:C.parentActionId,rootActionId:C.rootActionId,childActionIds:C.childActionIds,prereqActionId:C.prereqActionId,postreqActionIds:C.postreqActionIds,retryScheduleIndex:C.retryScheduleIndex,hasChildActionFailed:C.hasChildActionFailed,enqueueTimeSec:(C.U/1E3).toFixed()}},rbs=function(){var C;
return g.V(function(l){return l.j==1?g.P(l,iWC(),2):(C=l.U)?l.return(C.delete("yt-player-local-img")):l.return(!0)})},IC=function(C){var l,b;
return g.V(function(Q){if(Q.j==1)return g.P(Q,iWC(),2);if(Q.j!=3){l=Q.U;if(!l)throw Error("Cache API not supported");return C.length?g.P(Q,l.open("yt-player-local-img"),3):Q.return()}b=Q.U;return g.P(Q,Promise.all(C.map(function(O){return b.delete(O)})),0)})},Sb=function(C){var l,b;
return g.V(function(Q){if(Q.j==1)return g.P(Q,iWC(),2);if(Q.j!=3){l=Q.U;if(!l)throw Error("Cache API not supported");return C.length?g.P(Q,l.open("yt-player-local-img"),3):Q.return()}b=Q.U;return g.P(Q,b.addAll(C),0)})},XK=function(C,l,b,Q,O){var M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a,y,J,W,io,Qp,CR,GT,N,Sk,w6,km,RI,Gq,d6,uo;
return g.V(function(Qm){switch(Qm.j){case 1:return M=g.gG(C,"mainVideoEntity"),x=g.gG(C,"ytMainChannelEntity"),Z=g.gG(C,"transfer"),n=g.gG(C,"videoDownloadContextEntity"),g.P(Qm,HK(l,{mode:"readonly",Wm:!0},function(K){return g.R9.all([D4(K,M,"mainVideoEntity"),D4(K,x,"ytMainChannelEntity"),D4(K,Z,"transfer"),D4(K,n,"videoDownloadContextEntity"),kW(K,"ytMainChannelEntity"),kW(K,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:B=Qm.U;z=g.I(B);T=z.next().value;m=z.next().value;t=z.next().value;U=z.next().value;S=z.next().value;X=z.next().value;u=T;R=m;v=t;a=U;y=S;J=X;if(!u&&!R){Qm.oY(3);break}W=u?tJ(u.thumbnail):[];if(!R){io=[];Qm.oY(4);break}return g.P(Qm,IvM(R,y),5);case 5:io=Qm.U;case 4:return Qp=io,g.P(Qm,IC(W.concat(Qp)),3);case 3:CR=[];GT=g.gG(C,"downloadStatusEntity");N=g.I(J);for(Sk=N.next();!Sk.done;Sk=N.next())w6=Sk.value,km=g.Eb(w6.key).entityId,RI=AJ(w6),Gq=g.Eb(RI.action.entityKey).entityId,km!==C&&Gq!==
C||TY(b,w6.actionProto)||CR.push(w6.key);return g.P(Qm,HK(l,{mode:"readwrite",Wm:!0},function(K){var xm=CR.map(function(WB){return WK(K,WB)});
xm.push(WK(K,M,{U1:!0}));xm.push(WK(K,GT,{U1:!0}));return g.R9.all(xm)}),7);
case 7:uo=(d6=a)==null?void 0:d6.offlineModeType,O&&(xs(O),O.offlineModeType&&(uo=O.offlineModeType)),mE(v,uo),OV(Q,{entityKey:M,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.r6(Qm)}})},KQX=function(C,l,b,Q){var O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a,y,J,W,io,Qp,CR,GT,N,Sk,w6,km,RI,Gq,d6,uo,Qm,K,xm,WB,Sd,cB,mC,yp,Vm,PB,e,d,c,L,k,KR,bo,Uq;
return g.V(function(sq){switch(sq.j){case 1:return O=g.gG(C,"mainPlaylistEntity"),M=g.gG(C,"ytMainChannelEntity"),g.P(sq,HK(l,{mode:"readonly",Wm:!0},function(PF){return g.R9.all([D4(PF,O,"mainPlaylistEntity"),D4(PF,M,"ytMainChannelEntity"),kW(PF,"mainPlaylistEntity"),kW(PF,"mainDownloadsListEntity"),kW(PF,"ytMainChannelEntity"),kW(PF,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:x=sq.U;Z=g.I(x);n=Z.next().value;B=Z.next().value;z=Z.next().value;T=Z.next().value;m=Z.next().value;t=Z.next().value;U=n;S=B;X=z;u=T;R=m;v=t;if(!U&&!S){sq.oY(3);break}a=U?SvB(U):[];if(!S){y=[];sq.oY(4);break}return g.P(sq,IvM(S,R),5);case 5:y=sq.U;case 4:return J=y,g.P(sq,IC(a.concat(J)),3);case 3:W=[];io=new Map;if(!U){sq.oY(7);break}return g.P(sq,XEq(U,X,u),8);case 8:W=sq.U;Qp=g.I(W);for(CR=Qp.next();!CR.done;CR=Qp.next())GT=CR.value,io.set(GT,{videoId:GT,playlistId:C,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});
return g.P(sq,HK(l,{mode:"readonly",Wm:!0},function(PF){return g.R9.all([kW(PF,"transfer"),kW(PF,"videoDownloadContextEntity")])}),9);
case 9:N=sq.U;Sk=g.I(N);w6=Sk.next().value;km=Sk.next().value;RI=w6;Gq=km;d6=g.I(RI);for(uo=d6.next();!uo.done;uo=d6.next())Qm=uo.value,K=g.Eb(Qm.key).entityId,(xm=io.get(K))&&Qm&&(xm.cotn=Qm.cotn);WB=g.I(Gq);for(Sd=WB.next();!Sd.done;Sd=WB.next())cB=Sd.value,mC=g.Eb(cB.key).entityId,(yp=io.get(mC))&&cB&&(yp.offlineModeType=cB.offlineModeType);case 7:Vm=[];PB=g.I(v);for(e=PB.next();!e.done;e=PB.next())d=e.value,c=g.Eb(d.key).entityId,L=AJ(d),c!==C&&L.rootActionId!==C||TY(b,d.actionProto)||Vm.push(d.key);
k=g.gG(C,"mainPlaylistEntity");return g.P(sq,HK(l,{mode:"readwrite",Wm:!0},function(PF){var Np=Vm.map(function(XM){return WK(PF,XM)});
Np.push(WK(PF,k,{U1:!0}));return g.R9.all(Np)}),10);
case 10:if(!U){sq.oY(0);break}W.reverse();if(!W){sq.oY(0);break}KR=g.I(W);bo=KR.next();case 13:if(bo.done){sq.oY(0);break}Uq=bo.value;return g.P(sq,XK(Uq,l,b,Q,io.get(Uq)),14);case 14:bo=KR.next(),sq.oY(13)}})},uAl=function(C,l,b,Q){var O,M,x,Z,n,B,z,T,m;
return g.V(function(t){if(t.j==1)return O=g.gG("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),M=new Map,g.P(t,HK(C,{mode:"readwrite",Wm:!0},function(U){var S=kW(U,"transfer"),X=kW(U,"offlineOrchestrationActionWrapperEntity"),u=kW(U,"videoDownloadContextEntity"),R=D4(U,O,"mainDownloadsListEntity");return g.R9.all([S,X,u,R]).then(function(v){v=g.I(v);var a=v.next().value;var y=v.next().value;var J=v.next().value;var W=v.next().value;v=RqX.map(function(Qp){return r2$(U,Qp)});
y=g.I(y);for(var io=y.next();!io.done;io=y.next())io=io.value,TY(l,io.actionProto)||v.push(WK(U,io.key,{U1:!0}));W&&(W.downloads=[],v.push(p6(U,W,"mainDownloadsListEntity")));if(J)for(J=g.I(J),W=J.next();!W.done;W=J.next())W=W.value,y=g.Eb(W.key).entityId,y=g.gG(y,"transfer"),M.set(y,W.offlineModeType);return g.R9.all(v).then(function(){return a})})}),2);
x=t.U;Z=g.I(x);for(n=Z.next();!n.done;n=Z.next())B=n.value,mE(B,M.get(B.key)),z=g.Eb(B.key).entityId,T={videoId:z,offlineDeleteReason:Q,cotn:B.cotn,offlineModeType:M.get(B.key)},xs(T),m=g.gG(z,"mainVideoEntity"),OV(b,{entityKey:m,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.P(t,rbs(),0)})},SvB=function(C,l){var b=[];
if(C.thumbnailStyleData){C=g.I(C.thumbnailStyleData);for(var Q=C.next();!Q.done;Q=C.next()){var O=void 0,M=void 0,x=void 0;b=b.concat(tJ((O=Q.value)==null?void 0:(M=O.value)==null?void 0:(x=M.collageThumbnail)==null?void 0:x.coverThumbnail))}}l=tJ(l);return b.concat(l)},XEq=function(C,l,b){var Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a,y,J,W,io,Qp;
return g.V(function(CR){Q=[];O=new Set;if(b.length)for(M=g.I(b),x=M.next();!x.done;x=M.next())if(Z=x.value,n=void 0,(n=Z.downloads)==null?0:n.length)for(B=g.I(Z.downloads),z=B.next();!z.done;z=B.next())T=z.value,T.videoItem&&(m=g.Eb(T.videoItem).entityId,O.add(m));if(C.videos){t=g.I(C.videos);for(U=t.next();!U.done;U=t.next())S=U.value,X=JSON.parse(g.Eb(S).entityId),X.videoId&&!O.has(X.videoId)&&Q.push(X.videoId);u=g.I(l);for(R=u.next();!R.done;R=u.next())if(v=R.value,v.key!==C.key&&(a=v.videos))for(y=
g.I(a),J=y.next();!J.done;J=y.next())W=J.value,io=JSON.parse(g.Eb(W).entityId),io.videoId&&(Qp=Q.indexOf(io.videoId),Qp!==-1&&Q.splice(Qp,1))}return CR.return(Q)})},IvM=function(C,l){var b,Q,O,M,x,Z,n,B;
return g.V(function(z){b=tJ(C.avatar);Q=g.I(l);for(O=Q.next();!O.done;O=Q.next())if(M=O.value,M.id!==C.id)for(x=g.I(tJ(M.avatar)),Z=x.next();!Z.done;Z=x.next())n=Z.value,B=b.indexOf(n),B!==-1&&b.splice(B,1);return z.return(b)})},wEY=function(C){var l;
return g.V(function(b){l=g.D(C.frameworkUpdates,Kc);return C.frameworkUpdates&&l?g.P(b,aiY(l),0):b.return()})},dmM=function(C){var l;
if((l=C.onResponseReceivedActions)!=null&&l.length){var b;C=(b=g.D(g.D(C.onResponseReceivedActions[0],eq3),g.j7m))==null?void 0:b.actions;if(C!=null&&C.length)return C}},cbB=function(C){var l,b,Q;
return g.V(function(O){if(O.j==1)return C?g.P(O,Ec(C,g.LZ,"mainDownloadsListEntity"),2):O.return([]);l=O.U;return((b=l)==null?0:(Q=b.downloads)==null?0:Q.length)?O.return(l.downloads.map(function(M){var x;return(x=M.videoItem)!=null?x:""})):O.return([])})},vBX=function(C,l){var b;
return g.V(function(Q){return Q.j==1?g.P(Q,PHm(C,l),2):(b=Q.U)?g.P(Q,HK(C,{mode:"readwrite",Wm:!0},function(O){var M=[p6(O,b.mainDownloadsLibraryEntity,"mainDownloadsLibraryEntity")];b.mainDownloadsListEntity&&M.push(p6(O,b.mainDownloadsListEntity,"mainDownloadsListEntity"));return g.R9.all(M)}),0):Q.oY(0)})},PHm=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v;
return g.V(function(a){if(a.j==1)return b=g.gG("main_downloads_library_id","mainDownloadsLibraryEntity"),Q=g.gG("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.P(a,HK(C,{mode:"readonly",Wm:!0},function(y){return g.R9.all([D4(y,b,"mainDownloadsLibraryEntity"),D4(y,Q,"mainDownloadsListEntity")])}),2);
O=a.U;M=g.I(O);x=M.next().value;Z=M.next().value;n=x;B=Z;n||(n={id:b});z=g.I(l);for(T=z.next();!T.done;T=z.next())if(m=T.value,m===g.LZ){if(n.smartDownloadsList)return a.return();n.smartDownloadsList=m}else if(t=g.Eb(m).entityType,U={},t==="mainPlaylistEntity"?U.playlistItem=m:t==="mainVideoEntity"&&(U.videoItem=m),!g.En(U)){S=void 0;if((S=B)==null?0:S.downloads){X=!1;u=g.I(B.downloads);for(R=u.next();!R.done;R=u.next())if(v=R.value,v.playlistItem===m||v.videoItem===m){X=!0;break}X||B.downloads.push(U)}else B=
{id:Q,downloads:[U]};n.downloadsList=Q}return a.return({mainDownloadsLibraryEntity:n,mainDownloadsListEntity:B})})},avB=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X;
return g.V(function(u){if(u.j==1)return b=g.gG("main_downloads_library_id","mainDownloadsLibraryEntity"),Q=g.gG("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity"),g.P(u,HK(C,{mode:"readonly",Wm:!0},function(R){return g.R9.all([D4(R,b,"mainDownloadsLibraryEntity"),D4(R,Q,"mainDownloadsListEntity"),D4(R,g.LZ,"mainDownloadsListEntity")])}),2);
O=u.U;M=g.I(O);x=M.next().value;Z=M.next().value;n=M.next().value;B=x;z=Z;T=n;if(!B)return u.oY(0);if(l===g.LZ&&((m=T)==null?0:m.downloads))T.downloads=[];else if((t=z)==null?0:t.downloads)for(U=g.Eb(l).entityType,S=0;S<z.downloads.length;S++)if(X=z.downloads[S],U==="mainVideoEntity"&&X.videoItem===l){z.downloads.splice(S,1);break}else if(U==="mainPlaylistEntity"&&X.playlistItem===l){z.downloads.splice(S,1);break}return g.P(u,HK(C,{mode:"readwrite",Wm:!0},function(R){var v=[p6(R,B,"mainDownloadsLibraryEntity")];
z&&v.push(p6(R,z,"mainDownloadsListEntity"));T&&v.push(p6(R,T,"mainDownloadsListEntity"));return g.R9.all(v)}),0)})},RC=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m;
return g.V(function(t){if(t.j==1)return b=g.gG(l,"transfer"),Q=g.gG(l,"videoDownloadContextEntity"),g.P(t,HK(C,{mode:"readonly",Wm:!0},function(U){return g.R9.all([D4(U,b,"transfer"),D4(U,Q,"videoDownloadContextEntity")])}),2);
O=t.U;M=g.I(O);x=M.next().value;Z=M.next().value;n=x;B=Z;m={videoId:l,cotn:(z=n)==null?void 0:z.cotn,offlineModeType:(T=B)==null?void 0:T.offlineModeType};return t.return(m)})},u9=function(C,l,b,Q,O){var M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a,y,J,W,io;
return g.V(function(Qp){switch(Qp.j){case 1:return M=g.gG(C,"musicTrack"),x=g.gG(C,"transfer"),g.P(Qp,HK(l,{mode:"readonly",Wm:!0},function(CR){return g.R9.all([D4(CR,M,"musicTrack"),D4(CR,x,"transfer"),kW(CR,"musicTrack"),kW(CR,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:Z=Qp.U;n=g.I(Z);B=n.next().value;z=n.next().value;T=n.next().value;m=n.next().value;t=B;U=z;S=T;X=m;if(!t){Qp.oY(3);break}return g.P(Qp,LQX(t,S),4);case 4:return u=Qp.U,g.P(Qp,IC(u),3);case 3:R=[];v=g.I(X);for(a=v.next();!a.done;a=v.next())y=a.value,J=g.Eb(y.key).entityId,W=AJ(y),io=g.Eb(W.action.entityKey).entityId,J!==C&&io!==C||TY(b,y.actionProto)||R.push(y.key);return g.P(Qp,HK(l,{mode:"readwrite",Wm:!0},function(CR){var GT=R.map(function(N){return WK(CR,N)});
GT.push(WK(CR,M,{U1:!0}));return g.R9.all(GT)}),6);
case 6:mE(U),O&&xs(O),OV(Q,{entityKey:M,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"}),g.r6(Qp)}})},wi=function(C,l,b,Q,O){var M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a,y,J,W,io,Qp,CR,GT,N,Sk,w6,km,RI,Gq,d6,uo,Qm,K,xm,WB,Sd;
return g.V(function(cB){switch(cB.j){case 1:return M=g.gG(C,l),x=g.gG("music_downloads_library_id","musicDownloadsLibraryEntity"),g.P(cB,HK(b,{mode:"readonly",Wm:!0},function(mC){return g.R9.all([D4(mC,M,l),D4(mC,x,"musicDownloadsLibraryEntity"),kW(mC,l),kW(mC,"offlineOrchestrationActionWrapperEntity")])}),2);
case 2:Z=cB.U;n=g.I(Z);B=n.next().value;z=n.next().value;T=n.next().value;m=n.next().value;t=B;U=z;S=T;X=m;if(!t){cB.oY(3);break}return g.P(cB,LQX(t,S),4);case 4:return u=cB.U,g.P(cB,IC(u),3);case 3:R=[];v=new Map;if(!t){cB.oY(6);break}return g.P(cB,VCX(t,S,U),7);case 7:R=cB.U;a=g.I(R);for(y=a.next();!y.done;y=a.next())J=y.value,W=g.Eb(J).entityId,v.set(W,{videoId:W,playlistId:C,offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});return g.P(cB,gF(b,"transfer"),8);case 8:for(io=cB.U,Qp=
g.I(io),CR=Qp.next();!CR.done;CR=Qp.next())GT=CR.value,N=g.Eb(GT.key).entityId,(Sk=v.get(N))&&GT&&(Sk.cotn=GT.cotn);case 6:w6=[];km=g.I(X);for(RI=km.next();!RI.done;RI=km.next())Gq=RI.value,d6=g.Eb(Gq.key).entityId,uo=AJ(Gq),d6!==C&&uo.rootActionId!==C||TY(Q,Gq.actionProto)||w6.push(Gq.key);Qm=g.gG(C,l);return g.P(cB,HK(b,{mode:"readwrite",Wm:!0},function(mC){var yp=w6.map(function(Vm){return WK(mC,Vm)});
yp.push(WK(mC,Qm,{U1:!0}));return g.R9.all(yp)}),9);
case 9:if(!t){cB.oY(0);break}R.reverse();if(!R.length){cB.oY(0);break}K=g.I(R);xm=K.next();case 12:if(xm.done){cB.oY(0);break}WB=xm.value;Sd=g.Eb(WB).entityId;if(!Sd){cB.oY(13);break}return g.P(cB,u9(Sd,b,Q,O,v.get(Sd)),13);case 13:xm=K.next(),cB.oY(12)}})},eb=function(C,l,b){var Q,O,M,x,Z,n,B;
return g.V(function(z){if(z.j==1)return g.P(z,HK(C,{mode:"readwrite",Wm:!0},function(T){var m=kW(T,"transfer"),t=kW(T,"offlineOrchestrationActionWrapperEntity");return g.R9.all([m,t]).then(function(U){U=g.I(U);var S=U.next().value;var X=U.next().value;U=fvG.map(function(a){return r2$(T,a)});
X=g.I(X);for(var u=X.next();!u.done;u=X.next()){u=u.value;var R=g.Eb(u.actionProto.entityKey).entityType==="musicTrack",v=u.actionProto.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD";TY(l,u.actionProto)||R&&(!R||v)||U.push(WK(T,u.key,{U1:!0}))}return g.R9.all(U).then(function(){return S})})}),2);
Q=z.U;O=g.I(Q);for(M=O.next();!M.done;M=O.next())x=M.value,mE(x),Z=g.Eb(x.key).entityId,n={videoId:Z,offlineDeleteReason:void 0,cotn:x.cotn},xs(n),B=g.gG(Z,"musicTrack"),OV(b,{entityKey:B,failureReason:"OFFLINE_OPERATION_FAILURE_REASON_VIDEO_DELETED"});return g.P(z,rbs(),0)})},oBU=function(C){for(var l,b=g.I(C.additionalMetadatas),Q=b.next();!Q.done;Q=b.next())Q=Q.value,Q.offlineMusicVideoData&&(l=Q.offlineMusicVideoData);
var O,M,x,Z,n;return{id:g.gG(C.videoId,"musicTrack"),videoId:C.videoId,title:C.title,thumbnailDetails:C.thumbnail,lengthMs:String(Number(C.lengthSeconds)*1E3),albumTitle:(O=l)==null?void 0:O.releaseTitle,musicVideoType:(M=l)==null?void 0:M.musicVideoType,contentRating:{explicitType:(x=l)==null?void 0:x.explicitType},artistNames:((Z=l)==null?void 0:Z.byline)||((n=l)==null?void 0:n.channelName),downloadMetadata:g.gG(C.videoId,"musicTrackDownloadMetadataEntity")}},VCX=function(C,l,b){var Q,O,M,x,Z,n,
B,z,T,m,t,U,S,X,u,R,v,a;
return g.V(function(y){Q=[];O=new Set;if((M=b)==null?0:(x=M.downloadedTracks)==null?0:x.length)for(Z=g.I(b.downloadedTracks),n=Z.next();!n.done;n=Z.next())B=n.value,O.add(B);if(C.tracks){z=g.I(C.tracks);for(T=z.next();!T.done;T=z.next())m=T.value,O.has(m)||Q.push(m);t=g.I(l);for(U=t.next();!U.done;U=t.next())if(S=U.value,S.id!==C.id&&(X=S.tracks))for(u=g.I(X),R=u.next();!R.done;R=u.next())v=R.value,a=Q.indexOf(v),a!==-1&&Q.splice(a,1)}return y.return(Q)})},LQX=function(C,l){var b,Q,O,M,x,Z,n,B;
return g.V(function(z){b=tJ(C.thumbnailDetails);Q=g.I(l);for(O=Q.next();!O.done;O=Q.next())if(M=O.value,M.id!==C.id)for(x=g.I(tJ(M.thumbnailDetails)),Z=x.next();!Z.done;Z=x.next())n=Z.value,B=b.indexOf(n),B!==-1&&b.splice(B,1);return z.return(b)})},FQq=function(C,l){var b,Q,O,M,x,Z,n,B,z;
return g.V(function(T){if(T.j==1)return b=g.gG("music_downloads_library_id","musicDownloadsLibraryEntity"),g.P(T,Ec(C,b,"musicDownloadsLibraryEntity"),2);(Q=T.U)||(Q={id:b});O=g.Eb(l).entityType;O==="musicTrack"?(M=Q.downloadedTracks)!=null&&M.includes(l)||(Q.downloadedTracks=((x=Q.downloadedTracks)!=null?x:[]).concat(l)):O==="musicPlaylist"?(Z=Q.downloadedPlaylists)!=null&&Z.includes(l)||(Q.downloadedPlaylists=((n=Q.downloadedPlaylists)!=null?n:[]).concat(l)):O!=="musicAlbumRelease"||(B=Q.downloadedAlbumReleases)!=
null&&B.includes(l)||(Q.downloadedAlbumReleases=((z=Q.downloadedAlbumReleases)!=null?z:[]).concat(l));return g.P(T,NR(C,Q,"musicDownloadsLibraryEntity"),0)})},jvY=function(C,l){var b,Q,O,M,x,Z,n;
return g.V(function(B){if(B.j==1)return b=g.gG("music_downloads_library_id","musicDownloadsLibraryEntity"),g.P(B,Ec(C,b,"musicDownloadsLibraryEntity"),2);Q=B.U;if(!Q)return B.oY(0);O=g.Eb(l).entityType;O==="musicTrack"?M=Q.downloadedTracks:O==="musicPlaylist"&&(M=Q.downloadedPlaylists);if((x=M)==null?0:x.length)for(Z=0;Z<M.length;Z++)if(n=M[Z],n===l){M.splice(Z,1);break}return g.P(B,NR(C,Q,"musicDownloadsLibraryEntity"),0)})},ybn=function(C){var l=C.videos;
C=[];var b=[];if(l){l=g.I(l);for(var Q=l.next();!Q.done;Q=l.next()){var O=Q.value.offlineVideoData.videoId;Q=g.gG(O,"musicTrack");O=g.gG(O,"musicTrackDownloadMetadataEntity");C.push(Q);b.push(O)}}return{pS:C,I7:b}},di=function(C,l,b){l={track:oBU(l)};
b&&(l.playlistId=b);if(C=g.D(C.actionMetadata,Yvl))l.maximumDownloadQuality=C.maximumDownloadQuality;return{musicTrackEntityActionMetadata:l}},kQn=function(C){var l,b,Q,O,M,x,Z,n;
return g.V(function(B){switch(B.j){case 1:return l=g.Ob(),b=YJq(C),Q=g.bM(DmI),g.IP(B,2),M={wN:!0},g.P(B,g.JW(l,b,Q,void 0,M),4);case 4:O=B.U;g.RP(B,3);break;case 2:x=g.ek(B);if(x instanceof g.iD)throw Z="GetOffline network manager error: "+x.message,sV(Z,x),Error(Z);sV("GetOffline fetch request error",x);throw Error("GetOffline fetch request error");case 3:n=ce(O);if(!O)throw sV("Network request failed"),Error("Network request failed");if(n!==void 0)Pe(n);else if(!O.videos||!O.videos.length)throw sV("No data"),
Error("No data");return B.return(O.videos.map(function(z){return z.offlineVideoData}))}})},hqM=function(C){var l,b,Q,O,M,x,Z,n;
return g.V(function(B){switch(B.j){case 1:return l=g.Ob(),b=DE$(C),Q=g.bM(DmI),g.IP(B,2),M={wN:!0},g.P(B,g.JW(l,b,Q,void 0,M),4);case 4:O=B.U;g.RP(B,3);break;case 2:x=g.ek(B);if(x instanceof g.iD)throw Z="GetOffline network manager error for playlist: "+x.message,sV(Z,x),Error(Z);sV("GetOffline fetch request error for playlist",x);throw Error("GetOffline fetch request error for playlist");case 3:n=ce(O);if(!O)throw sV("Network request failed for playlist"),Error("Network request failed for playlist");
if(n!==void 0)Pe(n,"playlist");else if(!O.playlists||!O.playlists.length)throw sV("No data for playlist"),Error("No data for playlist");return B.return(O.playlists.map(function(z){return z.offlinePlaylistData}))}})},WQ3=function(C,l,b,Q){var O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a,y,J,W,io,Qp,CR,GT,N,Sk,w6,km,RI,Gq;
return g.V(function(d6){switch(d6.j){case 1:return g.P(d6,Cc(),2);case 2:O=d6.U;if(!O)return d6.return([]);M=[];if((x=Q)==null?0:x.length){M=Q;d6.oY(3);break}return g.P(d6,gF(O,"mainPlaylistEntity"),4);case 4:M=d6.U;case 3:if(!M.length)return d6.return([]);Z=[];n=Date.now()/1E3;B=g.I(M);z=B.next();case 5:if(z.done)return Z.length?g.P(d6,pEI(Z),10):d6.return([]);T=z.value;if(!T.downloadState){m=void 0;d6.oY(8);break}return g.P(d6,Ec(O,T.downloadState,"mainPlaylistDownloadStateEntity"),9);case 9:m=
d6.U;case 8:t=m;U=void 0;X=(S=(U=T)==null?void 0:U.entityMetadata)&&S.nextAutoRefreshIntervalSeconds?Number(S.nextAutoRefreshIntervalSeconds):NaN;u=Number.isNaN(X)?C:X;v=R=void 0;a=((R=t)==null?0:R.lastSyncedTimestampMillis)?Number((v=t)==null?void 0:v.lastSyncedTimestampMillis)/1E3:0;J=y=void 0;W=((y=t)==null?0:y.addedTimestampMillis)?Number((J=t)==null?void 0:J.addedTimestampMillis)/1E3:0;if(b||!S||a+u<=n){io=[];Qp=void 0;if((Qp=T.videos)==null?0:Qp.length)for(CR=g.I(T.videos),GT=CR.next();!GT.done;GT=
CR.next())N=GT.value,Sk=JSON.parse(g.Eb(N).entityId),Sk.videoId&&io.push(Sk.videoId);w6="0";S&&(km=void 0,w6=String(Number((km=S.offlineLastModifiedTimestampSeconds)!=null?km:0).toFixed()));RI={playlistId:T.playlistId,videoIds:io,offlineLastModifiedTimestamp:w6,autoSync:l,offlineDateAddedTimestamp:String(W.toFixed())};Z.push(RI)}z=B.next();d6.oY(5);break;case 10:return Gq=d6.U,d6.return(Gq)}})},qvI=function(){var C,l,b,Q,O;
return g.V(function(M){if(M.j==1)return g.P(M,Cc(),2);if(M.j!=3)return(C=M.U)?g.P(M,gF(C,"refresh"),3):M.return(!1);l=M.U;if((b=l[0])==null||!b.refreshTime)return M.return(!1);Q=Number(l[0].refreshTime);O=Date.now()/1E3;return M.return(isFinite(Q)&&O>=Q)})},HWl=function(C,l){var b,Q,O;
return g.V(function(M){switch(M.j){case 1:return g.IP(M,2),g.P(M,Jb$(C,l),4);case 4:return Q=M.U,g.P(M,wEY(Q),5);case 5:b=dmM(Q);g.RP(M,3);break;case 2:O=g.ek(M),sV("getAndProcessSmartDownloadsResponse request or processing error",O);case 3:return M.return(b)}})},NrM=function(C,l,b,Q){var O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a,y,J,W,io,Qp,CR,GT,N,Sk,w6,km,RI,Gq;
return g.V(function(d6){switch(d6.j){case 1:return g.P(d6,Cc(),2);case 2:O=d6.U;if(!O)return d6.return([]);M=[];if((x=Q)==null?0:x.length){M=Q;d6.oY(3);break}return g.P(d6,gF(O,"musicPlaylist"),4);case 4:M=d6.U;case 3:if(!M.length)return d6.return([]);Z=[];n=Date.now()/1E3;B=g.I(M);z=B.next();case 5:if(z.done)return Z.length?g.P(d6,pEI(Z),10):d6.return([]);T=z.value;m=void 0;U=(t=(m=T)==null?void 0:m.entityMetadata)&&t.nextAutoRefreshIntervalSeconds?Number(t.nextAutoRefreshIntervalSeconds):NaN;S=
Number.isNaN(U)?C:U;u=X=0;R="DOWNLOAD_SYNC_STATE_UNKNOWN";if(!T.downloadMetadata){d6.oY(8);break}return g.P(d6,Ec(O,T.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),9);case 9:v=d6.U,y=a=void 0,X=Number((y=(a=v)==null?void 0:a.addedTimestampMillis)!=null?y:"0")/1E3,W=J=void 0,u=Number((W=(J=v)==null?void 0:J.lastModifiedTimestampMillis)!=null?W:"0")/1E3,Qp=io=void 0,R=(Qp=(io=v)==null?void 0:io.syncState)!=null?Qp:"DOWNLOAD_SYNC_STATE_UNKNOWN";case 8:CR=void 0;if(b||R!=="DOWNLOAD_SYNC_STATE_UP_TO_DATE"||
!t||Number((CR=t.lastSyncedTimestampSeconds)!=null?CR:0)+S<=n){GT=[];N=void 0;if((N=T.tracks)==null?0:N.length)for(Sk=g.I(T.tracks),w6=Sk.next();!w6.done;w6=Sk.next())km=w6.value,GT.push(g.Eb(km).entityId);RI={playlistId:T.playlistId,videoIds:GT,offlineLastModifiedTimestamp:String(u.toFixed()),autoSync:l,offlineDateAddedTimestamp:String(X.toFixed())};Z.push(RI)}z=B.next();d6.oY(5);break;case 10:return Gq=d6.U,d6.return(Gq)}})},Jb$=function(C,l){var b,Q,O,M,x,Z,n,B,z,T;
return g.V(function(m){switch(m.j){case 1:return b=g.Ob(),g.P(m,Cc(),2);case 2:Q=m.U;if(!Q){m.oY(3);break}return g.P(m,H8U(Q),4);case 4:O=m.U;case 3:var t=O;M={context:g.gZ(),browseId:"FEdownloads",browseRequestSupportedMetadata:{downloadsBrowseParams:{offlineFeatureSettingState:{isSdEnabled:C},offlineClientState:t,clientStateRequestData:{preferredFormatType:l}}}};x=g.bM(EBI);g.IP(m,5);n={wN:!0};return g.P(m,g.JW(b,M,x,void 0,n),7);case 7:Z=m.U;g.RP(m,6);break;case 5:B=g.ek(m);if(B instanceof g.iD)throw z=
"DPS network manager error for smart downloads: "+B.message,sV(z,B),Error(z);sV("DPS fetch request error for smart downloads",B);throw Error("DPS fetch request error for smart downloads");case 6:T=ce(Z);if(Z)T!==void 0&&Pe(T,"smart downloads");else throw sV("Network request failed for smart downloads"),Error("Network request failed for smart downloads");return m.return(Z)}})},CUX=function(C,l){var b,Q,O,M,x,Z,n,B;
return g.V(function(z){switch(z.j){case 1:return b=g.Ob(),Q={context:g.gZ(),videoPlaybackPositionEntities:C,lastSyncTimestampUsec:l},O=g.bM(gBU),g.IP(z,2),x={wN:!0},g.P(z,g.JW(b,Q,O,void 0,x),4);case 4:M=z.U;g.RP(z,3);break;case 2:Z=g.ek(z);if(Z instanceof g.iD)throw n="VPPS network manager error: "+Z.message,sV(n,Z),Error(n);sV("VPPS fetch request error",Z);throw Error("VPPS fetch request error");case 3:B=ce(M);if(M)B!==void 0&&Pe(B,"position sync");else throw sV("Network request failed for position sync"),
Error("Network request failed for position sync");return z.return(M)}})},bum=function(C,l,b){var Q,O,M,x,Z,n,B,z;
return g.V(function(T){switch(T.j){case 1:Q=g.Ob();var m=b.refreshData,t=b.isEnqueuedForExpiredStreamUrlRefetch,U=b.KW,S=b.offlineSourceData,X=b.mediaCapabilities,u={entityKey:C};m&&(u.refreshData=m);t&&(u.isExpiredStreamUrlRefetch=t);U&&(u.downloadParameters=U);S&&(u.offlineSourceData=S);m={context:g.xF(l),signatureTimestamp:20213,videos:[u]};X&&(m.mediaCapabilities=X);O=m;M=g.bM(l1X);g.IP(T,2);Z={wN:!0};return g.P(T,g.JW(Q,O,M,void 0,Z),4);case 4:x=T.U;g.RP(T,3);break;case 2:n=g.ek(T);if(n instanceof
g.iD)throw B="GetPDE network manager error: "+n.message,sV(B,n),Error(B);sV("GetPDE fetch request error",n);throw Error("GetPDE fetch request error");case 3:z=ce(x);if(x)z!==void 0&&Pe(z,"PDE");else throw sV("Network request failed for PDE"),Error("Network request failed for PDE");return T.return(x)}})},ce=function(C){var l;
return(l=C.errorMetadata)==null?void 0:l.status},Pe=function(C,l){l=l?" for "+l:"";
if(C===0)throw C="Empty response body"+l,sV(C),Error(C);C="Response with error"+l;sV(C);throw Error(C);},pEI=function(C){var l,b,Q,O,M,x,Z,n;
return g.V(function(B){switch(B.j){case 1:return l=g.Ob(),b=k8s(C),Q=g.bM(iuq),g.IP(B,2),M={wN:!0},g.P(B,g.JW(l,b,Q,void 0,M),4);case 4:O=B.U;g.RP(B,3);break;case 2:x=g.ek(B);if(x instanceof g.iD)throw Z="offlinePlaylistSyncCheck network manager error: "+x.message,sV(Z,x),Error(Z);sV("offlinePlaylistSyncCheck fetch request error",x);throw Error("offlinePlaylistSyncCheck fetch request error");case 3:n=ce(O);if(!O)throw sV("Network request failed for playlist sync"),Error("Network request failed for playlist sync");
if(n!==void 0)Pe(n,"playlist sync");else if(!O.offlinePlaylistSyncCheckDatas||!O.offlinePlaylistSyncCheckDatas.length)throw sV("No data for playlist sync"),Error("No data for playlist sync");return B.return(O.offlinePlaylistSyncCheckDatas.map(function(z){return z.offlinePlaylistSyncCheckData}))}})},ve=function(C){this.U=C},saG=function(C,l){var b,Q,O,M,x,Z;
return g.V(function(n){switch(n.j){case 1:b=new Map,Q=g.I(l),O=Q.next();case 2:if(O.done){n.oY(4);break}M=O.value;x=b;Z=x.set;return g.P(n,C.j(M),5);case 5:Z.call(x,M,n.U);O=Q.next();n.oY(2);break;case 4:return n.return(b)}})},aC=function(C,l,b,Q,O,M){l=g.gG(l,b);
Q=Object.assign({},M,{priority:Q,retryScheduleIntervalsInSeconds:O});return{actionType:C,entityKey:l,actionMetadata:Q}},Lc=function(C,l,b,Q,O,M){this.status=C;
this.U=l;this.C=b;this.j=Q;this.Z=O;this.downloadState=M},Qa$=function(C,l,b){this.U=C;
this.UC=l;this.Z=b},xcq=function(C,l){var b,Q,O,M,x,Z,n,B,z;
return g.V(function(T){switch(T.j){case 1:return b=l.entityKey,O=(Q=g.D(l.actionMetadata,Vt))==null?void 0:Q.isEnqueuedForExpiredStreamUrlRefetch,g.IP(T,2),M=void 0,g.P(T,OuU(C,l),4);case 4:M=T.U;g.IP(T,5);var m=(m=g.D(l.actionMetadata,Vt))?{maximumDownloadQuality:m.maximumDownloadQuality}:void 0;return g.P(T,bum(b,C.UC,{isEnqueuedForExpiredStreamUrlRefetch:O,KW:m,offlineSourceData:M}),7);case 7:x=T.U;g.RP(T,6,2);break;case 5:return g.ek(T,2),Z=$s(l)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":
"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",sV("PDE handleAdd error"),T.return(fc(l,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",Z,"DOWNLOAD_STATE_FAILED"));case 6:return g.P(T,MsI(C,x,l),8);case 8:return T.return(fc(l,!0,x.orchestrationActions));case 2:return n=g.ek(T),B="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",z="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",n instanceof g.Uu&&n.type==="QUOTA_EXCEEDED"&&(B="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
z="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),sV("PDE handleAdd error"),T.return(fc(l,!1,void 0,B,z,"DOWNLOAD_STATE_FAILED"))}})},Zul=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a,y,J,W,io,Qp;
return g.V(function(CR){switch(CR.j){case 1:return b=l.entityKey,Q=g.Eb(b).entityId,g.P(CR,HK(C.U,{mode:"readonly",Wm:!0},function(GT){var N=D4(GT,b,"playbackData"),Sk=D4(GT,g.gG(Q,"offlineVideoPolicy"),"offlineVideoPolicy");GT=D4(GT,g.gG(Q,"transfer"),"transfer");return g.R9.all([N,Sk,GT])}),2);
case 2:O=CR.U;M=g.I(O);x=M.next().value;Z=M.next().value;n=M.next().value;B=x;z=Z;T=n;if(!B||!z)return CR.return(fc(l,!0));m=[];S=((U=B)==null?0:U.playerResponseJson)?JSON.parse(B.playerResponseJson):null;if(!(T&&S&&C.UC.D("html5_refresh_deprecated_downloads"))){CR.oY(3);break}t=GbG(C,S,T);return g.P(CR,$c$(C,T),4);case 4:m=CR.U;case 3:X={lastPlayerResponseTimestampSeconds:B.playerResponseTimestamp,offlineToken:z.offlineToken,formatIds:m};u={};if((R=T)==null?0:R.maximumDownloadQuality)u.maximumDownloadQuality=
T.maximumDownloadQuality;g.IP(CR,5);v=void 0;return g.P(CR,OuU(C,l),7);case 7:return v=CR.U,g.IP(CR,8),g.P(CR,bum(b,C.UC,{refreshData:X,KW:u,offlineSourceData:v,mediaCapabilities:t}),10);case 10:a=CR.U;g.RP(CR,9,5);break;case 8:return g.ek(CR,5),y=$s(l)?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR",sV("PDE handleRefresh error"),CR.return(fc(l,!1,void 0,"OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED",y,
"DOWNLOAD_STATE_FAILED"));case 9:return g.P(CR,MsI(C,a,l),11);case 11:return CR.return(fc(l,!0,a.orchestrationActions));case 5:return J=g.ek(CR),W="PDE handleRefresh error",J instanceof Error&&(W="PDE handleRefresh error: "+J.message),io="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",Qp="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",J instanceof g.Uu&&J.type==="QUOTA_EXCEEDED"&&(io="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",Qp="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
sV(W),CR.return(fc(l,!1,void 0,io,Qp,"DOWNLOAD_STATE_FAILED"))}})},OuU=function(C,l){var b,Q,O,M;
return g.V(function(x){if(x.j==1)return b=g.Eb(l.entityKey).entityId,Q=g.gG(b,"videoDownloadContextEntity"),g.P(x,Ec(C.U,Q,"videoDownloadContextEntity"),2);O=x.U;return(M=O)!=null&&M.offlineModeType?x.return({offlineModeType:O.offlineModeType}):x.return(void 0)})},MsI=function(C,l,b){var Q,O,M,x,Z;
return g.V(function(n){if(n.j==1){if(!l.frameworkUpdates||!g.D(l.frameworkUpdates,Kc))return n.return();if(!(g.D(l.frameworkUpdates,Kc).mutations&&g.D(l.frameworkUpdates,Kc).mutations.length>0&&g.D(l.frameworkUpdates,Kc).mutations[0].type==="ENTITY_MUTATION_TYPE_DELETE"))return n.oY(2);Q=g.Eb(g.D(l.frameworkUpdates,Kc).mutations[0].entityKey).entityId;return g.P(n,RC(C.U,Q),3)}if(n.j!=2){O=n.U;M=g.D(b.actionMetadata,Vt);if(Z=(x=M)==null?void 0:x.playlistId)O.playlistId=Z;O.offlineDeleteReason="OFFLINE_DELETE_REASON_UNKNOWN";
return g.lC(C.UC)?g.P(n,XK(Q,C.U,b,C.Z,O),2):g.jN(C.UC)?g.P(n,u9(Q,C.U,b,C.Z),2):n.oY(2)}return g.P(n,aiY(g.D(l.frameworkUpdates,Kc)),0)})},fc=function(C,l,b,Q,O,M){return new Lc(l?"OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS":"OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",$s(C),b,Q,O,M)},GbG=function(C,l,b){l=Um$(C.UC,b.cotn,l);
b=g.nt(l);return g.qUo(l,b,C.UC)},$c$=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m;
return g.V(function(t){if(t.j==1)return b=[],g.P(t,HK(C.U,{mode:"readonly",Wm:!0},function(U){var S=[],X=l.offlineVideoStreams;if(X){X=g.I(X);for(var u=X.next();!u.done;u=X.next())S.push(D4(U,u.value,"offlineVideoStreams"))}return g.R9.all(S)}),2);
if(Q=t.U)for(O=g.I(Q),M=O.next();!M.done;M=O.next())if(x=M.value,Z=void 0,(Z=x)==null?0:Z.streamsProgress)for(n=x.streamsProgress,B=0;B<n.length;B++)z=n[B],T=JSON.parse(z.formatStreamBytes),m={itag:T.itag,lmt:T.lastModified,xtags:T.xtags},b.push(m);return t.return(b)})},nKs=function(C,l){this.U=C;
this.UC=l},BDm=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t;
return g.V(function(U){switch(U.j){case 1:return b=$s(l),g.P(U,gF(C.U,"videoPlaybackPositionEntity"),2);case 2:Q=U.U;if(Q.length===0)return U.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));g.IP(U,3);return g.P(U,jJ.getInstance(),5);case 5:O=U.U;if(!O)throw Error("prefStorage is undefined");return g.P(U,O.get("psi"),6);case 6:return M=U.U,n=(Z=(x=M)==null?void 0:x.LZ)!=null?Z:"0",g.P(U,CUX(Q,n),7);case 7:return B=U.U,z={isPaused:B.watchHistoryPaused,LZ:B.syncTimestampUsec},g.P(U,O.set("psi",
z),8);case 8:if(z.isPaused){U.oY(9);break}T=g.D(B.frameworkUpdates,Kc);if(!B.frameworkUpdates||!T){U.oY(9);break}return g.P(U,aiY(T),9);case 9:g.RP(U,4);break;case 3:return m=g.ek(U),t="PPE handleRefresh error: "+(m instanceof Error?m.message:"unknown error"),sV(t),U.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return U.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b))}})},TD3=function(C,l){var b,Q,O,M,x,Z,n,B;
return g.V(function(z){switch(z.j){case 1:return b=$s(l),Q=g.Eb(l.entityKey).entityId,g.IP(z,2),g.P(z,jJ.getInstance(),4);case 4:O=z.U;if(!O)throw Error("prefStorage is undefined");return g.P(z,O.get("psi"),5);case 5:M=z.U;x=g.D(l.actionMetadata,zfG);if(((Z=M)==null?void 0:Z.isPaused)!==!1||(n=x)==null||!n.lastPlaybackPositionSeconds){z.oY(6);break}B={key:g.gG(Q,"videoPlaybackPositionEntity"),videoId:Q,lastPlaybackPositionSeconds:x.lastPlaybackPositionSeconds};return g.P(z,NR(C.U,B,"videoPlaybackPositionEntity"),
6);case 6:g.RP(z,3);break;case 2:return g.ek(z),z.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return z.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b))}})},mcU=function(C,l){var b,Q,O;
return g.V(function(M){switch(M.j){case 1:b=$s(l);g.IP(M,2);Q=g.Eb(l.entityKey).entityId;if(Q==="!*$_ALL_ENTITIES_!*$")return g.P(M,eeI(C.U),5);O=g.gG(Q,"videoPlaybackPositionEntity");return g.P(M,wAs(C.U,O),5);case 5:g.RP(M,3);break;case 2:return g.ek(M),M.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return M.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b))}})},tsY=function(C,l){this.api=C;
this.U=l;this.logger=new g.xc("woffle");this.j=!1;this.dF={bB:this.bB};this.logger.debug("Initialized OfflineMediaManager")},UcG=function(C){return g.V(function(l){return l.return(y2q(C))})},AY$=function(C){var l;
return g.V(function(b){if(b.j==1)return g.P(b,g.z4q(C),2);l=b.U;return b.return(l.filter(function(Q){return!!Q.url}).map(function(Q){return Q.url}))})},oC=function(C,l){var b=g.Lv(l);
if(b===1||b===0)return Promise.resolve();(b=rYU(C,l))&&b.stopVideo();C.Z=0;return UcG(l)},FK=function(C,l,b,Q){b=b===void 0?!1:b;
Q=Q===void 0?!0:Q;var O=typeof l==="string"?l:l.videoDetails.videoId;g.Lv(O)===2&&((l=rYU(C,O))?l.stopVideo():C.logger.info(function(){return"Corresponding player for "+O+" not found. Pausing anyway"}),g.Vc(O,2),C.Z=2,b?I1G(C.U):Q&&SgX(C.U))},rYU=function(C,l){var b;
return((b=C.player)==null?void 0:b.getVideoData().videoId)===l?C.player:null},XaC=function(C,l,b){l.getPlayerResponse();
g.Vc(l.videoId,2);C.Z=2;C.j=!1;var Q;(Q=C.player)==null||Q.dispose();C.player=C.api.td(l);l={};C.player.YS((l.localmediachange=C.bT,l.signatureexpired=C.KL,l.statechange=C.RnE,l),C);var O=C.bB(b);C.player.Fw(g.z6(O,O,!0,"m"),!1);C.logger.debug(function(){return"Starting headless playback with quality: "+O});
C.player.N7(!1)},K6M=function(C,l){this.U=C;
this.UC=l},uuq=function(C,l){var b,Q;
return g.V(function(O){switch(O.j){case 1:return b=$s(l),g.P(O,Ec(C.U,l.entityKey,"transfer"),2);case 2:if(Q=O.U)return O.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));g.IP(O,3);return g.P(O,RfI(C,l),5);case 5:g.RP(O,4);break;case 3:return g.ek(O),O.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return O.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b))}})},waC=function(C,l){var b,Q;
return g.V(function(O){switch(O.j){case 1:return b=$s(l),g.P(O,Ec(C.U,l.entityKey,"transfer"),2);case 2:Q=O.U;if(!Q||Q.transferState!=="TRANSFER_STATE_COMPLETE")return O.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));g.IP(O,3);return g.P(O,RfI(C,l,!0),5);case 5:g.RP(O,4);break;case 3:return g.ek(O),O.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));
case 4:return O.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b))}})},efG=function(C,l){var b,Q,O,M,x,Z,n,B,z,T;
return g.V(function(m){switch(m.j){case 1:return b=$s(l),Q=g.Eb(l.entityKey).entityId,g.P(m,HK(C.U,{mode:"readonly",Wm:!0},function(t){var U=D4(t,l.entityKey,"transfer");t=D4(t,g.gG(Q,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.R9.all([U,t])}),2);
case 2:O=m.U;M=g.I(O);x=M.next().value;Z=M.next().value;n=x;B=Z;if(!n||n.transferState!=="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH")return m.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));g.IP(m,3);n.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE";return g.P(m,NR(C.U,n,"transfer"),5);case 5:z=g.Eb(n.key).entityId;nBI({videoId:z,s0:n,offlineModeType:(T=B)==null?void 0:T.offlineModeType});g.RP(m,4);break;case 3:return g.ek(m),m.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",
b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 4:return m.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b))}})},RfI=function(C,l,b){b=b===void 0?!1:b;
var Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u;return g.V(function(R){switch(R.j){case 1:return Q=g.D(l.actionMetadata,dcl),O=g.Eb(l.entityKey).entityId,M=g.gG(O,"downloadStatusEntity"),g.P(R,HK(C.U,{mode:"readonly",Wm:!0},function(v){var a=D4(v,M,"downloadStatusEntity");v=D4(v,g.gG(O,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.R9.all([a,v])}),2);
case 2:return x=R.U,Z=g.I(x),n=Z.next().value,B=Z.next().value,z=n,T=B,m="TRANSFER_STATE_TRANSFER_IN_QUEUE",((t=z)==null?void 0:t.downloadState)==="DOWNLOAD_STATE_USER_DELETED"&&(m="TRANSFER_STATE_PAUSED_BY_USER"),X={key:l.entityKey,transferState:m,cotn:g.KA(16),enqueuedTimestampMs:Date.now().toString(),maximumDownloadQuality:(U=Q)==null?void 0:U.maximumDownloadQuality,preferredAudioTrack:(S=Q)==null?void 0:S.preferredAudioTrack,transferRetryCount:0,isRefresh:b,hasLoggedFirstStarted:!1},g.P(R,HK(C.U,
{mode:"readwrite",Wm:!0},function(v){var a=[];b&&a.push(WK(v,g.gG(O,"offlineVideoStreams")));a.push(p6(v,X,"transfer"));return g.R9.all(a)}),3);
case 3:if(!b){R.oY(4);break}return g.P(R,UcG(O),4);case 4:$m3({videoId:O,s0:X,offlineModeType:(u=T)==null?void 0:u.offlineModeType}),g.r6(R)}})},PUG=function(C,l,b,Q){if(!C.action.entityKey)throw Error("entityKey is missing.");
var O=g.Eb(C.action.entityKey);O={entityType:O.KK,entityId:O.entityId,offlineOrchestrationActionType:C.action.actionType,orchestrationAction:{orchestrationActionId:C.actionId}};l&&(O.offlineOrchestrationActionResult=l.status,O.isRetryable=b?!1:l.U,l.Z&&(O.offlineOrchestrationFailureReason=cYs(l.Z,O.isRetryable)));var M,x;if((M=C.action.actionMetadata)==null?0:(x=M.offlineLoggingData)==null?0:x.offlineModeType)O.offlineModeType=C.action.actionMetadata.offlineLoggingData.offlineModeType;Q&&(O.additionalOrchestrationActions=
Q.map(function(Z){return{orchestrationActionId:Z.actionId}}));
return O},cYs=function(C,l){return C!=="OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR"||l?C==="OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"&&l?"OFFLINE_ORCHESTRATION_FAILURE_REASON_RECOVERABLE_NETWORK_ERROR":C:"OFFLINE_ORCHESTRATION_FAILURE_REASON_UNRECOVERABLE_NETWORK_ERROR"},vKq=function(C,l){var b={offlineOrchestrationContext:PUG(C)};
l=qJX(l,b);J2n(We3(),l,C.rootActionId)},a1R=function(C,l,b,Q){Q=Q===void 0?[]:Q;
l={offlineOrchestrationContext:PUG(C,l,b,Q)};l=qJX(3,l);J2n(We3(),l,C.rootActionId)},L6Y=function(){this.actions=[]},VsI=function(C,l){l=g.I(l);
for(var b=l.next();!b.done;b=l.next())b=b.value,vKq(b,1),C.actions.push(b);C.actions.sort(C.U)},f1C=function(C,l){if(l)for(var b=0;b<C.actions.length;b++)if(l==="!*$_ALL_ENTITIES_!*$"&&C.actions[b].actionId!==l||l!=="!*$_ALL_ENTITIES_!*$"&&C.actions[b].rootActionId===l&&C.actions[b].actionId!==l)C.actions.splice(b,1),b--},oKs=function(C,l){C=g.I(C.actions);
for(var b=C.next();!b.done;b=C.next())if(b.value.actionId===l)return!0;return!1},jb=function(C,l,b,Q,O){g.F.call(this);
var M=this;this.j=C;this.Fu=l;this.tE=b;this.K=Q;this.UC=O;this.U=new L6Y;this.S=new g.J9;this.Z=new g.Nc(function(){M.retry()});
this.N=NaN;this.B=!1;this.dF={jCu:function(){return M.U},
G9:function(){return M.S},
Mlu:function(){return M.Z},
retry:function(){return M.retry()}};
g.Y(this,this.Z);this.Y=this.j.observe(this.aY.bind(this))},yY3=function(C,l,b,Q,O){var M;
return g.V(function(x){if(x.j==1)return M=new jb(C,l,b,Q,O),g.P(x,F6M(M),2);ja3(M);return x.return(M)})},ja3=function(C){var l=C.U.actions[0];
return C.C?((l==null?void 0:l.action.actionType)==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&C.C[0].action.actionType!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(C.B=!0),Promise.resolve()):Ygm(C)},Ygm=function(C){var l,b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u;
return g.V(function(R){switch(R.j){case 1:if(C.C)throw Error("Already processing an action");if(C.Xu())return R.return();l=C.U.actions.shift();xmX(C.tE,!l);if(l===void 0)return R.return();l.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&l.actionId==="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS"&&f1C(C.U,l.actionId);b="";l.action.actionType==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&l.rootActionId===l.actionId&&(b=l.actionId);Q=[l];C.C=Q;if(O=C.Fu[l.entityType]){R.oY(2);break}C.C=
void 0;return g.P(R,Ygm(C),3);case 3:return R.return();case 2:M=g.I(Q);for(x=M.next();!x.done;x=M.next())Z=x.value,vKq(Z,2);g.IP(R,4,5);return g.P(R,saG(O,Q.map(function(v){return v.action})),7);
case 7:n=R.U,B=g.I(Q),z=B.next();case 8:if(z.done){R.oY(10);break}T=z.value;m=n.get(T.action);return g.P(R,Dc3(C,T,m),9);case 9:z=B.next();R.oY(8);break;case 10:f1C(C.U,b);case 5:g.cF(R);C.C=void 0;g.vF(R,6);break;case 4:return t=g.ek(R),sV("Orchestration error",t),g.IP(R,12),g.P(R,kbl(C,Q),14);case 14:g.RP(R,5);break;case 12:U=g.ek(R);sV("Orchestration retry error",U);S=g.I(Q);for(X=S.next();!X.done;X=S.next())u=X.value,u.retryScheduleIndex<3&&VsI(C.U,[u]);R.oY(5);break;case 6:return g.P(R,Ygm(C),
0)}})},Dc3=function(C,l,b){var Q,O,M,x,Z,n,B,z,T,m,t,U;
return g.V(function(S){switch(S.j){case 1:Q=l.retryScheduleIndex+2===3;if(b.status==="OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS"){S.oY(2);break}if(b.status!=="OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE"){S.oY(0);break}a1R(l,b,Q);if(b.U&&l.retryScheduleIndex+1<3)return g.P(S,kbl(C,[l]),0);M=((O=b)==null?0:O.j)?b.j:"OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN";x={entityKey:l.action.entityKey,failureReason:M};Z=void 0;g.lC(C.UC)?Z="mainVideoDownloadStateEntity":g.jN(C.UC)&&(Z="musicTrackDownloadMetadataEntity");
if(!Z||!b.downloadState){S.oY(7);break}n=g.Eb(l.action.entityKey).entityId;return g.P(S,zY(n,Z,C.j,b.downloadState),7);case 7:OV(C.K,x);if(b.downloadState==="DOWNLOAD_STATE_FAILED"&&C.UC.D("html5_auto_retry_failed_pde_actions")){S.oY(0);break}sV("Orchestration result is not retryable, deleting action");return g.P(S,wAs(C.j,ri(l).key),0);case 2:B=void 0;try{B=(z=b.C)==null?void 0:z.map(function(X){return C.createAction(X,l)})}catch(X){return a1R(l,b,Q),T={entityKey:l.action.entityKey,
failureReason:"OFFLINE_OPERATION_FAILURE_REASON_UNSUPPORTED_ENTITY_FAILED"},OV(C.K,T),sV("Orchestration subactions creation error",X),S.return()}a1R(l,b,Q,B);if(!B){S.oY(12);break}m=B.map(function(X){return ri(X)});
t=0;case 13:if(!(t<B.length)||C.B){S.oY(15);break}return g.P(S,HK(C.j,{mode:"readwrite",Wm:!0},function(X){var u=[];u.push(t5s(X,m.slice(t,t+10),"offlineOrchestrationActionWrapperEntity"));return g.R9.all(u)}),16);
case 16:t+=10;S.oY(13);break;case 15:if(C.B)return C.B=!1,S.return();case 12:return U=ri(l),g.P(S,wAs(C.j,U.key),17);case 17:vKq(l,4),g.r6(S)}})},qgn=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t;
return g.V(function(U){b=[];Q=Infinity;O=4E3;M=g.I(l);for(x=M.next();!x.done;x=M.next())Z=x.value,n=Number(Z.enqueueTimeSec),B=hfI(n),z=Z.retryScheduleIndex,T=z!=null&&z>0,B>0&&T?(Q=Math.min(Q,n),O=Math.min(B,O)):b.push(Z);isFinite(Q)&&(!C.Z.isActive()||Q<C.N)&&(C.N=Q,C.Z.start(O));C.S.vS()||(m=b.length,b=b.filter(function(S){var X;S=((X=S.actionProto)==null?void 0:X.actionType)||"OFFLINE_ORCHESTRATION_ACTION_TYPE_UNKNOWN";return!paY.includes(S)}),t=b.length<m,!C.Z.isActive()&&t&&C.Z.start(1));
b.length>0&&W6l(C,b);return g.P(U,ja3(C),0)})},Huq=function(C){var l,b,Q,O,M,x,Z;
return g.V(function(n){if(n.j==1)return g.P(n,JYq(C),2);l=n.U;b=[];Q=g.I(l);for(O=Q.next();!O.done;O=Q.next())M=O.value,x=g.Eb(M.key),Z=x.entityId,oKs(C.U,Z)||b.push(M);return g.P(n,qgn(C,b),0)})},hfI=function(C){C=C*1E3-Date.now();
return C>4E3?4E3:C},kbl=function(C,l){var b,Q,O;
return g.V(function(M){b=g.I(l);for(Q=b.next();!Q.done;Q=b.next()){O=Q.value;var x=void 0,Z=void 0,n=((Z=O.action)==null?void 0:(x=Z.actionMetadata)==null?void 0:x.retryScheduleIntervalsInSeconds)||[1,2,4];x=1;O.retryScheduleIndex<n.length&&(x=n[O.retryScheduleIndex]);O.U=x*1E3+Date.now();O.retryScheduleIndex++}return g.P(M,NDC(C,l),0)})},F6M=function(C){var l;
return g.V(function(b){if(b.j==1)return g.P(b,gF(C.j,"offlineOrchestrationActionWrapperEntity"),2);l=b.U;return g.P(b,qgn(C,l),0)})},W6l=function(C,l){l.length!==0&&l.forEach(function(b){b=AJ(b);
b.retryScheduleIndex<3&&VsI(C.U,[b])})},JYq=function(C,l){var b;
return g.V(function(Q){if(Q.j==1)return g.P(Q,gF(C.j,"offlineOrchestrationActionWrapperEntity",l),2);b=Q.U;return Q.return(b.filter(LeR))})},NDC=function(C,l){if(l.length===0)return Promise.resolve([]);
l=l.map(function(b){return ri(b)});
return uxI(C.j,l)},EKI=function(C){this.KC=C;
this.U=void 0},gKl=function(C,l){var b,Q,O,M;
return g.V(function(x){b=l.videoId;Q=!0;if(l.captionTracks.length)O=B8s(l),C.U=new g.Ar(C.KC,l,O);else if(l.hs)M=g.u9k(l),C.U=new g.IE(C.KC,l.hs,b,M,l.sS,l.eventId),Q=l.sS;else return x.return();return x.return(new Promise(function(Z){var n;(n=C.U)==null||n.F8({mR:function(){return g.V(function(B){if(B.j==1)return g.P(B,C.mR(b,Q),2);Z();g.r6(B)})},
Sa:function(){}})}))})},Crq=function(C){var l;
return g.V(function(b){if(b.j==1)return g.P(b,j5s(C),2);l=b.U;return b.return(!!l&&l.length>0)})},Ys=function(C){g.F.call(this);
this.U=C;this.j=this.U.observe(this.Z.bind(this))},l8l=function(C,l){var b,Q,O,M,x,Z,n;
return g.V(function(B){switch(B.j){case 1:if(l.length===0)return B.return([]);b=l.map(function(z){return g.gG(z,"transfer")});
return g.P(B,gF(C.U,"transfer",b),2);case 2:Q=B.U;O=Q.filter(LeR).map(function(z){return g.Eb(z.key).entityId});
M=l.filter(function(z){return O.indexOf(z)===-1});
if(M.length===0)return B.return([]);x=g.I(M);Z=x.next();case 3:if(Z.done){B.oY(5);break}n=Z.value;return g.P(B,UcG(n),4);case 4:Z=x.next();B.oY(3);break;case 5:return B.return(M)}})},scm=function(C,l,b,Q,O,M){var x,Z,n;
return g.V(function(B){x="STREAM_TYPE_UNKNOWN";b.video&&b.audio?(x="STREAM_TYPE_AUDIO_AND_VIDEO",sV("unexpected stream type")):b.video&&!b.audio?x="STREAM_TYPE_VIDEO":!b.video&&b.audio&&(x="STREAM_TYPE_AUDIO");Z=g.gG(l,"offlineVideoStreams");n={numBytesDownloaded:O.toFixed(),numTotalBytes:M.toFixed(),streamType:x,streamState:"DOWNLOAD_STREAM_STATE_IN_PROGRESS",formatStreamBytes:JSON.stringify(Q),itag:x==="STREAM_TYPE_AUDIO_AND_VIDEO"?Number(b.itag):void 0};return g.P(B,HK(C,{mode:"readwrite",Wm:!0},
function(z){var T=D4(z,Z,"offlineVideoStreams"),m=D4(z,g.gG(l,"transfer"),"transfer");return g.R9.all([T,m]).then(function(t){t=g.I(t);var U=t.next().value;t=t.next().value;if(!t)return WK(z,Z).then(function(){});
var S=bLC(U);U=iL$(U,Q,n,Z);var X=p6(z,U,"offlineVideoStreams");bLC(U)>S&&(t.lastProgressTimeMs=Date.now().toString());S=[X];t.offlineVideoStreams||(t.offlineVideoStreams=[]);t.offlineVideoStreams.indexOf(Z)===-1&&(t.offlineVideoStreams.push(Z),S.push(p6(z,t,"transfer")));return g.R9.all(S)})}),0)})},Qcq=function(C,l){var b,Q,O,M,x;
return g.V(function(Z){if(Z.j==1)return b=g.gG(l,"offlineVideoStreams"),g.P(Z,Ec(C,b,"offlineVideoStreams"),2);Q=Z.U;if(!Q||!Q.streamsProgress)return Z.return();O=g.I(Q.streamsProgress);for(M=O.next();!M.done;M=O.next())x=M.value,x.streamState="DOWNLOAD_STREAM_STATE_COMPLETE",x.numTotalBytes!==x.numBytesDownloaded&&(x.numBytesDownloaded=x.numTotalBytes);return g.P(Z,NR(C,Q,"offlineVideoStreams"),0)})},iL$=function(C,l,b,Q){if(C&&C.streamsProgress){Q=C;
a:{l=l.itag+";"+l.xtags;for(var O=C.streamsProgress,M=0;M<O.length;M++){var x=JSON.parse(O[M].formatStreamBytes);if(x.itag+";"+x.xtags===l){O[M]=b;b=O;break a}}O.push(b);b=O}Q.streamsProgress=b}else C={key:Q,streamsProgress:[b]};return C},bLC=function(C){if(C==null?0:C.streamsProgress){var l=0;
C=C.streamsProgress;for(var b=0;b<C.length;b++){var Q=C[b];isNaN(Number(Q.numBytesDownloaded))?sV("stream progress bytes number invalid"):l+=Number(Q.numBytesDownloaded)}return l}return 0},OLl=function(C,l,b,Q){g.F.call(this);
var O=this;this.j=C;this.api=l;this.lY=b;this.aY=Q;this.S=new g.J9;this.C=new g.Nc(function(){O.U&&O.U.transferState==="TRANSFER_STATE_TRANSFERRING"&&O.S.vS()&&((O.U.transferRetryCount||0)<3?FK(O.K,O.B,!1,!1):oC(O.K,O.B.videoDetails.videoId),O.m$("TRANSFER_FAILURE_REASON_TIMEOUT_NO_PROGRESS"))});
this.tE=this.ZO=0;this.Y=this.N=!1;this.hE=g.BX(this.api.J().experiments,"html5_transfer_processing_logs_interval");this.B_=new g.FO(this);this.dF={iR_:function(){return O.C},
d1k:function(){return O.aY},
G9:function(){return O.S}};
this.Fu=this.j.observe(this.TC.bind(this));this.K=new tsY(l,this);this.TX=new EKI(l);this.AE=new Ys(this.j);this.CC=this.S.listen("publicytnetworkstatus-online",this.pB.bind(this));this.v_=this.S.listen("publicytnetworkstatus-offline",this.L_r.bind(this));this.Y=this.api.J().D("html5_less_transfer_processing_logs");g.Y(this,this.B_);this.B_.G(l,"offlinetransferpause",this.Gi7);g.lC(this.api.J())?this.Z="mainVideoDownloadStateEntity":g.jN(this.api.J())&&(this.Z="musicTrackDownloadMetadataEntity")},
MmI=function(C){return g.V(function(l){if(l.j==1)l=g.P(l,o4C(),2);
else{var b=C.AE;var Q=g.ax();Q=Object.keys(Q);b=l8l(b,Q);l=g.P(l,b,0)}return l})},ks=function(C,l){l=l===void 0?!1:l;
var b;return g.V(function(Q){if(Q.j==1){if(C.U)throw Error("Already downloading a video");C.tE=0;C.N=!1;return g.P(Q,xkl(C),2)}return Q.j!=4?(b=Q.U,GQq(C.lY,!b),b&&C.S.vS()?l?g.P(Q,new Promise(function(O){g.mZ(O,1E3)}),4):Q.oY(4):(!b&&C.U&&DE(C),Q.oY(0))):g.P(Q,GDq(C,b),0)})},$kq=function(C){return g.V(function(l){if(l.j==1)return C.B?g.P(l,oC(C.K,C.B.videoDetails.videoId),3):l.oY(0);
DE(C);g.r6(l)})},ZLU=function(C,l){var b,Q,O;
return g.V(function(M){switch(M.j){case 1:return g.IP(M,2),(b=!!l.captionTracks.length||!!l.hs)?g.P(M,Crq(l.videoId),4):M.return();case 4:return(Q=M.U)?M.return():g.P(M,gKl(C.TX,l),5);case 5:g.RP(M,0);break;case 2:O=g.ek(M),sV("Caption downloading error",O,l.cotn),g.r6(M)}})},GDq=function(C,l){var b,Q,O,M,x,Z;
return g.V(function(n){switch(n.j){case 1:if(C.N)return n.return();C.N=!0;C.U=l;b=g.Eb(C.U.key);Q=b.entityId;O=void 0;if(C.U.transferState==="TRANSFER_STATE_TRANSFERRING")return g.P(n,hJ(C,Q),7);if(C.U.transferState!=="TRANSFER_STATE_TRANSFER_IN_QUEUE"||C.U.transferRetryCount||C.U.hasLoggedFirstStarted){n.oY(3);break}return g.P(n,hJ(C,Q),5);case 5:return O=n.U,C.U.hasLoggedFirstStarted=!0,g.P(n,n0$(C),6);case 6:ZWC({videoId:Q,s0:C.U,offlineModeType:O},void 0,void 0,!0);n.oY(3);break;case 7:O=n.U,
GY({transferStatusType:"TRANSFER_STATUS_TYPE_RESUME_PROCESSING",statusType:"OFFLINING_RETRIED"},{videoId:Q,s0:C.U,offlineModeType:O});case 3:return g.P(n,BAR(C),8);case 8:return M=null,g.IP(n,9),g.P(n,zCn(C,l),11);case 11:M=n.U;C.B=M;g.RP(n,10);break;case 9:return x=g.ek(n),sV("error getting player response",x,l.cotn),g.P(n,C.m$("TRANSFER_FAILURE_REASON_SERVER_PROPERTY_MISSING"),12);case 12:return n.return();case 10:return Z=Um$(C.api.J(),l.cotn,M),g.P(n,ZLU(C,Z),13);case 13:return g.P(n,AY$(Z.videoId),
14);case 14:Z.O8=n.U,XaC(C.K,Z,l.maximumDownloadQuality),C.C.start(108E5),g.r6(n)}})},xkl=function(C){var l,b;
return g.V(function(Q){if(Q.j==1)return g.P(Q,gF(C.j,"transfer"),2);l=Q.U;b=l.filter(TA3).sort(mkM);return b.length===0?Q.return():Q.return(b[0])})},BAR=function(C){var l,b,Q;
return g.V(function(O){if(O.j==1){if(!C.U)return pc(C,"onTransferStart"),O.return();C.C.start(108E5);return g.P(O,We(C,"TRANSFER_STATE_TRANSFERRING"),2)}l=C.U;return(Q=((b=l)==null?0:b.key)?g.Eb(l.key).entityId:"")&&C.Z?g.P(O,zY(Q,C.Z,C.j,"DOWNLOAD_STATE_DOWNLOAD_IN_PROGRESS"),0):O.oY(0)})},I1G=function(C){var l,b,Q,O;
g.V(function(M){switch(M.j){case 1:if(!C.U){pc(C,"onTransferPausedByUser");M.oY(2);break}l=C.U;C.C.stop();return g.P(M,We(C,"TRANSFER_STATE_PAUSED_BY_USER"),3);case 3:Q=((b=l)==null?0:b.key)?g.Eb(l.key).entityId:"";if(!Q||!C.Z){M.oY(4);break}return g.P(M,zY(Q,C.Z,C.j,"DOWNLOAD_STATE_PAUSED"),4);case 4:return g.P(M,hJ(C,Q),6);case 6:O=M.U,BrM({videoId:Q,s0:l,offlineModeType:O});case 2:DE(C),ks(C),g.r6(M)}})},SgX=function(C){var l,b,Q;
g.V(function(O){if(O.j==1){if(!C.U)return pc(C,"onTransferPausedByNetwork"),O.return();C.C.stop();return g.P(O,We(C,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),2)}if(O.j!=3)return l=C.U,(Q=((b=l)==null?0:b.key)?g.Eb(l.key).entityId:"")&&C.Z?g.P(O,zY(Q,C.Z,C.j,"DOWNLOAD_STATE_PAUSED"),3):O.oY(3);DE(C);g.r6(O)})},tmY=function(C){var l,b,Q,O,M;
g.V(function(x){switch(x.j){case 1:if(!C.U)return pc(C,"onTransferComplete"),x.return();l=C.U;C.C.stop();if(!l||!C.B){x.oY(2);break}b=Um$(C.api.J(),l.cotn,C.B);return g.P(x,ZLU(C,b),2);case 2:return g.P(x,We(C,"TRANSFER_STATE_COMPLETE","DOWNLOAD_STREAM_STATE_COMPLETE"),4);case 4:O=((Q=l)==null?0:Q.key)?g.Eb(l.key).entityId:"";if(!O||!C.Z){x.oY(5);break}return g.P(x,zY(O,C.Z,C.j,"DOWNLOAD_STATE_COMPLETE"),5);case 5:return g.P(x,Qcq(C.j,O),7);case 7:return g.P(x,hJ(C,O),8);case 8:M=x.U,GY({transferStatusType:"TRANSFER_STATUS_TYPE_COMPLETED",
statusType:"SUCCESS"},{videoId:O,s0:l,offlineModeType:M}),DE(C),ks(C),g.r6(x)}})},UkU=function(C,l,b){var Q,O;
g.V(function(M){switch(M.j){case 1:if(!C.U)return pc(C,"onTransferProgress: "+l),M.return();if(C.U.transferState==="TRANSFER_STATE_TRANSFERRING"){M.oY(2);break}return g.P(M,BAR(C),2);case 2:Q=Date.now();if(!(Q-C.ZO>1E3)){M.oY(4);break}C.ZO=Q;return g.P(M,scm(C.j,b.videoId,b.j,b.hW,b.bytesDownloaded,b.U),5);case 5:if(C.Y&&!(C.Y&&Q-C.tE>C.hE)){M.oY(4);break}C.tE=Q;return g.P(M,hJ(C,l),7);case 7:O=M.U,ZWC({videoId:l,s0:C.U,offlineModeType:O},b.bytesDownloaded,b.U);case 4:C.C.start(108E5),g.r6(M)}})},
Ahm=function(C){var l=(C.U.transferRetryCount||0)<3;
l&&(C=C.U,C.transferRetryCount=(C.transferRetryCount||0)+1);return l},rhY=function(C,l){l=l===void 0?"TRANSFER_FAILURE_REASON_UNKNOWN":l;
var b,Q,O,M;return g.V(function(x){if(x.j==1)return C.U||pc(C,"setTransferToFailed: "+l),b="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",l==="TRANSFER_FAILURE_REASON_NETWORK"?b="OFFLINE_OPERATION_FAILURE_REASON_NETWORK_REQUEST_FAILED":l==="TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"&&(b="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED"),g.P(x,We(C,"TRANSFER_STATE_FAILED","DOWNLOAD_STREAM_STATE_ERROR_STREAMS_MISSING",l),2);if(x.j!=3)return OV(C.aY,{entityKey:(Q=C.U)==null?void 0:Q.key,failureReason:b}),
O=C.U?g.Eb(C.U.key).entityId:"",g.P(x,hJ(C,O),3);M=x.U;var Z={videoId:O,s0:C.U,offlineModeType:M},n=l,B={transferStatusType:"TRANSFER_STATUS_TYPE_TERMINATED_WITH_FAILURE",statusType:"FAILED"};n&&(B.transferFailureReason=n,B.failureReason=zqn(n));GY(B,Z);g.r6(x)})},We=function(C,l,b,Q){var O;
return g.V(function(M){if(M.j==1){if(!C.U)return pc(C,"saveTransferState: "+l),M.return();C.U.transferState=l;C.U.failureReason=Q;g.IP(M,2);return g.P(M,n0$(C,function(x){return b?kW(x,"offlineVideoStreams",C.U.offlineVideoStreams).then(function(Z){for(var n=g.I(Z),B=n.next();!B.done;B=n.next())if((B=B.value)&&B.streamsProgress){B=g.I(B.streamsProgress);for(var z=B.next();!z.done;z=B.next())z.value.streamState=b}return t5s(x,Z.filter(function(T){return!!T}),"offlineVideoStreams")}):g.R9.resolve(void 0)}),
4)}if(M.j!=2)return g.RP(M,0);
O=g.ek(M);return O instanceof g.Uu&&O.type==="QUOTA_EXCEEDED"?g.P(M,C.m$("TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE"),0):M.oY(0)})},n0$=function(C,l){var b;
return g.V(function(Q){if(!C.U)return Q.return();b=C.U;return g.P(Q,HK(C.j,{mode:"readwrite",Wm:!0},function(O){var M=[p6(O,b,"transfer")];l&&M.push(l(O));return g.R9.all(M)}),0)})},DE=function(C){C.U=void 0;
C.B=void 0;C.C.stop()},zCn=function(C,l){var b,Q,O,M,x;
return g.V(function(Z){if(Z.j==1)return b=g.Eb(l.key),Q=b.entityId,O=g.gG(Q,"playbackData"),g.P(Z,Ec(C.j,O,"playbackData"),2);M=Z.U;if((x=M)==null?0:x.playerResponseJson)return Z.return(JSON.parse(M.playerResponseJson));throw Error("No PlayerResponse found");})},pc=function(C,l){C.api.gK("woffle",{mcte:l});
sV("missing current transfer entity.")},hJ=function(C,l){var b,Q,O;
return g.V(function(M){if(M.j==1)return g.P(M,Ec(C.j,g.gG(l,"videoDownloadContextEntity"),"videoDownloadContextEntity"),2);b=M.U;return M.return((O=(Q=b)==null?void 0:Q.offlineModeType)!=null?O:void 0)})},TA3=function(C){return I8m[C.transferState]!==void 0},mkM=function(C,l){var b=I8m[C.transferState],Q=I8m[l.transferState];
return b!==Q?b-Q:Number(C.enqueuedTimestampMs)-Number(l.enqueuedTimestampMs)},qF=function(C,l){var b=this;
this.UC=C;this.api=l;this.S=new g.J9;this.B=new g.zQ;this.dF={wZ:function(){return b.Z.dF.wZ()},
G9:function(){return b.S},
tlO:function(){return b.Z},
jW:function(){return b.jW()},
y7:function(){return b.y7()},
NU:function(){return b.NU()},
ev:function(){return b.ev()},
V5:function(){return b.V5()},
NQ:function(Q){return b.NQ(Q)}};
this.Z=new QvG(function(){return ShR(b)},function(){b.NU()},this.api.PJ(),this.api.D.bind(this.api));
this.U=new Qt(this.api);OWl(this.Z)},ShR=function(C){return g.V(function(l){C.api.VY("onOrchestrationBecameLeader");
return g.P(l,C.y7(),0)})},K7s=function(C){var l,b;
return g.V(function(Q){if(Q.j==1)return g.P(Q,Cc(),2);if(Q.j!=3){l=Q.U;if(!l)return sV("PES is undefined"),Q.return();C.j=new OLl(l,C.api,C.Z,C.U);b=C.Lz(l);return g.P(Q,yY3(l,b,C.Z,C.U,C.UC),3)}C.K=Q.U;return g.P(Q,XyR(C),0)})},XyR=function(C){var l;
return g.V(function(b){switch(b.j){case 1:if(!C.j)return sV("transferManager is undefined"),b.return();if(C.j.U){b.oY(2);break}return g.P(b,ks(C.j),2);case 2:if(!C.UC.D("woffle_enable_main_downloads_library")){b.oY(4);break}return g.P(b,C.Vs(),4);case 4:if(!C.UC.D("html5_offline_playback_position_sync")){b.oY(6);break}return g.P(b,C.Hy(),7);case 7:return g.P(b,C.NQ(864E5),6);case 6:return g.P(b,C.refreshAllStaleEntities(43200,!0),9);case 9:return g.P(b,C.EJ(),10);case 10:if(!C.UC.D("html5_retry_downloads_for_expiration")){b.oY(11);
break}return g.P(b,C.V5(),11);case 11:return C.N=g.tc(function(){C.refreshAllStaleEntities(43200,!0);C.EJ()},9E5),g.g5(g.lV(),function(){return C.ev()}),g.P(b,Cc(),13);
case 13:return l=b.U,g.P(b,svX(l),14);case 14:MCq(C.Z),g.r6(b)}})},RCR=function(){var C,l,b,Q,O,M;
return g.V(function(x){switch(x.j){case 1:return g.P(x,Cc(),2);case 2:C=x.U;if(!C)return x.return([]);l=Date.now()/1E3;return g.P(x,gF(C,"offlineVideoPolicy"),3);case 3:b=x.U,Q=g.I(b),O=Q.next();case 4:if(O.done){x.oY(6);break}M=O.value;if(!(M.expirationTimestamp&&Number(M.expirationTimestamp)<l)){x.oY(5);break}M.action="OFFLINE_VIDEO_POLICY_ACTION_DISABLE";M.offlinePlaybackDisabledReason="OFFLINE_PLAYBACK_DISABLED_REASON_CLIENT_OFFLINE_CONTENT_EXPIRED";return g.P(x,NR(C,M,"offlineVideoPolicy"),5);
case 5:O=Q.next();x.oY(4);break;case 6:return x.return(b.map(function(Z){return Z.key}))}})},JJ=function(C,l,b,Q,O){var M,x,Z;
return g.V(function(n){if(n.j==1)return g.P(n,Cc(),2);M=n.U;if(!M)return n.return([]);x=l.map(function(B){var z=g.gG(B,b);z={actionType:Q,entityKey:z,actionMetadata:Object.assign({},AbC(),O)};Q!=="OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"&&(z.actionMetadata.priority=0);B=new UV(b,B,z);return ri(B)});
Z=uxI(M,x);OWl(C.Z);return n.return(Z)})},u$U=function(C,l,b,Q){var O,M,x,Z,n,B,z,T;
return g.V(function(m){switch(m.j){case 1:O=[],M=g.I(l),x=M.next();case 2:if(x.done){m.oY(4);break}Z=x.value;if(Z.upToDate||b&&!Z.shouldAutoSyncMetadata||!Z.playlistId){m.oY(3);break}n={};switch(Q){case "mainPlaylistEntity":B={nextAutoRefreshIntervalSeconds:Z.checkInSeconds,autoSync:b};n={mainPlaylistEntityActionMetadata:B};break;case "musicPlaylist":z={autoSync:b},n={musicPlaylistEntityActionMetadata:z}}return g.P(m,JJ(C,[Z.playlistId],Q,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",n),6);case 6:(T=
m.U)&&O.push.apply(O,g.w(T));case 3:x=M.next();m.oY(2);break;case 4:return m.return(O)}})},wyM=function(C,l){var b;
return g.V(function(Q){return l.length?(b=AbC(),g.D_(b,Vt,{isEnqueuedForExpiredStreamUrlRefetch:!0}),C.api.gK("qrd",{v:l.length}),Q.return(JJ(C,l,"playbackData","OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",b))):Q.return([])})},eCR=function(C,l,b){this.U=C;
this.UC=l;this.Z=b},PrG=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R;
return g.V(function(v){switch(v.j){case 1:return b=$s(l),Q=g.Eb(l.entityKey),O=Q.entityId,M=[],g.IP(v,2),g.P(v,dkl(C,O),4);case 4:M=v.U;if(!(C.UC.D("woffle_enable_main_downloads_library")&&((x=M)==null?0:x.length))){v.oY(5);break}return g.P(v,vBX(C.U,[l.entityKey]),5);case 5:g.RP(v,3);break;case 2:return Z=g.ek(v),n="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",B="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Z instanceof g.Uu&&Z.type==="QUOTA_EXCEEDED"?(n="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
B="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"):sV("Playlist add error"),v.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,n,B));case 3:z=[];if(!C.UC.D("html5_offline_prevent_redownload_downloaded_video")){v.oY(7);break}return g.P(v,tCM(C.U,"mainVideoEntity",M),8);case 8:M=v.U;case 7:if((T=M)==null?0:T.length)for(m=g.I(M),t=m.next();!t.done;t=m.next())if(U=t.value,S=U.offlineVideoData,X=void 0,(X=S)==null?0:X.videoId)u=void 0,R=Number(((u=l.actionMetadata)==null?void 0:u.priority)||
0)+1,z.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",S.videoId,"mainVideoEntity",R,He,chG(l,S,O)));return v.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,z))}})},a8X=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a,y,J,W,io,Qp,CR,GT,N,Sk,w6,km,RI,Gq,d6,uo,Qm,K,xm,WB,Sd,cB,mC,yp,Vm,PB,e,d,c,L,k,KR,bo,Uq,sq,PF,Np,XM,X7,vP,WZ,pG,qN,rS,$_,cw,t_,Pw,DK,k5,S4,sY,J7,Om,Ra,hP;
return g.V(function(tl){switch(tl.j){case 1:return b=$s(l),Q=l.entityKey,O=g.Eb(Q).entityId,M=[],x=!1,O==="!*$_ALL_ENTITIES_!*$"?(x=!0,g.P(tl,gF(C.U,"mainPlaylistEntity"),5)):g.P(tl,Ec(C.U,Q,"mainPlaylistEntity"),4);case 4:(Z=tl.U)&&M.push(Z);tl.oY(3);break;case 5:M=tl.U;case 3:if((n=M)==null||!n.length)return tl.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));B=g.D(l.actionMetadata,v03);T=(z=B)==null?void 0:z.nextAutoRefreshIntervalSeconds;t=(m=B)==null?void 0:m.autoSync;U=[];X=S=
!0;u=!1;if(!x&&t===!1){tl.oY(6);break}g.IP(tl,7);return g.P(tl,WQ3(0,!!t,!0,M),9);case 9:U=tl.U;g.RP(tl,8);break;case 7:R=g.ek(tl);if(!(R instanceof Error&&R.message==="No data")){R instanceof Error&&R.message==="Empty response body"&&sV(R.message);tl.oY(8);break}return O==="!*$_ALL_ENTITIES_!*$"?g.P(tl,uAl(C.U,l,C.Z,"OFFLINE_DELETE_REASON_UNAVAILABLE"),8):g.P(tl,KQX(O,C.U,l,C.Z),8);case 8:if(!U.length||!x&&U[0].playlistId!==O)return tl.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b));case 6:if(x){v=[];a=g.I(U);for(y=a.next();!y.done;y=a.next())J=y.value,J.upToDate||t&&!J.shouldAutoSyncMetadata||!J.playlistId||(W={nextAutoRefreshIntervalSeconds:J.checkInSeconds,autoSync:t},v.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",J.playlistId,"mainPlaylistEntity",0,He,{mainPlaylistEntityActionMetadata:W})));return tl.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,v))}U.length&&(io=U[0],u=!!io.upToDate,t&&(S=(Qp=io.shouldAutoSyncMetadata)!=null?Qp:!0,X=(CR=io.shouldAutoSyncVideos)!=
null?CR:!0,io.checkInSeconds&&(T=io.checkInSeconds)));if(u||!S)return tl.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));GT=[];N=M[0];if(!N.downloadState){Sk=void 0;tl.oY(15);break}return g.P(tl,Ec(C.U,N.downloadState,"mainPlaylistDownloadStateEntity"),16);case 16:Sk=tl.U;case 15:return w6=Sk,RI=((km=w6)==null?0:km.addedTimestampMillis)?String(w6.addedTimestampMillis):void 0,g.IP(tl,17),g.P(tl,dkl(C,O,RI,T),19);case 19:GT=tl.U;g.RP(tl,18);break;case 17:Gq=g.ek(tl);if(!(Gq instanceof
Error&&Gq.message==="No data for playlist")){if(Gq instanceof Error&&Gq.message==="Empty response body for playlist")sV(Gq.message);else return d6="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",uo="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Gq instanceof g.Uu&&Gq.type==="QUOTA_EXCEEDED"&&(d6="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",uo="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),tl.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,d6,uo));
tl.oY(18);break}return g.P(tl,KQX(O,C.U,l,C.Z),18);case 18:if(!X)return tl.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));Qm=[];K=new Map;if((xm=GT)==null?0:xm.length)for(WB=g.I(GT),Sd=WB.next();!Sd.done;Sd=WB.next())cB=Sd.value,mC=cB.offlineVideoData,yp=void 0,((yp=mC)==null?0:yp.videoId)&&K.set(mC.videoId,mC);Vm=new Map;PB=[];if((e=N)==null?0:(d=e.videos)==null?0:d.length)for(c=g.I(N.videos),L=c.next();!L.done;L=c.next())if(k=L.value,KR=JSON.parse(g.Eb(k).entityId),bo=KR.videoId)K.has(bo)?
(Vm.set(bo,K.get(bo)),K.delete(bo)):PB.push(bo);sq=Number(((Uq=l.actionMetadata)==null?void 0:Uq.priority)||0)+1;PF=g.I(K.entries());for(Np=PF.next();!Np.done;Np=PF.next())XM=Np.value,X7=g.I(XM),vP=X7.next().value,WZ=X7.next().value,pG=vP,qN=WZ,Qm.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",pG,"mainVideoEntity",sq,He,chG(l,qN,O)));rS=g.I(Vm.entries());for($_=rS.next();!$_.done;$_=rS.next())cw=$_.value,t_=g.I(cw),Pw=t_.next().value,DK=t_.next().value,k5=Pw,S4=DK,Qm.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
k5,"mainVideoEntity",sq,He,chG(l,S4,O)));sY=g.I(PB);for(J7=sY.next();!J7.done;J7=sY.next())Om=J7.value,Ra={playlistId:O},hP={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"},mainVideoEntityActionMetadata:Ra},Qm.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",Om,"mainVideoEntity",0,He,hP));return tl.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,Qm))}})},L7G=function(C,l){var b,Q,O,M;
return g.V(function(x){switch(x.j){case 1:return b=$s(l),g.IP(x,2),Q=g.Eb(l.entityKey).entityId,Q==="!*$_ALL_ENTITIES_!*$"?g.P(x,uAl(C.U,l,C.Z,(O=l.actionMetadata)==null?void 0:(M=O.offlineLoggingData)==null?void 0:M.offlineDeleteReason),5):g.P(x,KQX(Q,C.U,l,C.Z),6);case 6:if(!C.UC.D("woffle_enable_main_downloads_library")){x.oY(5);break}return g.P(x,avB(C.U,l.entityKey),5);case 5:g.RP(x,3);break;case 2:return g.ek(x),x.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
"OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return x.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b))}})},dkl=function(C,l,b,Q){var O,M,x,Z,n,B,z;
return g.V(function(T){switch(T.j){case 1:return g.P(T,hqM([l]),2);case 2:return O=T.U,g.P(T,Vml(C,O[0],b,Q),3);case 3:return M=T.U,x=M.mainPlaylistEntity,Z=M.OuK,B=SvB(x,(n=Z)==null?void 0:n.avatar),g.IP(T,4),g.P(T,Sb(B),6);case 6:g.RP(T,5);break;case 4:z=g.ek(T),z instanceof Error&&z.message==="Failed to fetch"&&sV(z.message);case 5:return T.return(O[0].videos)}})},Vml=function(C,l,b,Q){var O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a;
return g.V(function(y){switch(y.j){case 1:O=Date.now().toString();b||(b=O);M=l.videos;x=l.playlistId;Z=[];n=[];if(M)for(B=g.I(M),z=B.next();!z.done;z=B.next()){T=z.value;m=T.offlineVideoData;if(!m||!m.videoId)throw sV("Invalid offlineVideoData for playlist"),Error("Invalid offlineVideoData for playlist");t=m.videoId;U={videoId:t,playlistId:x};S={id:g.gG(JSON.stringify(U),"mainPlaylistVideoEntity"),video:g.gG(t,"mainVideoEntity")};Z.push(S);n.push(S.id)}u={key:g.gG(x,"mainPlaylistDownloadStateEntity"),
addedTimestampMillis:b,lastSyncedTimestampMillis:O};R={key:g.gG(x,"mainPlaylistEntity"),playlistId:x,videos:n,title:l.title,thumbnailStyleData:f8I(l),visibility:o0G(l),downloadState:u.key};l.channel&&(v=l.channel.offlineChannelData,X=F7s(g.gG(x,"ytMainChannelEntity"),v),R.channelOwner=X.id);((a=R)==null?0:a.entityMetadata)?(R.entityMetadata.offlineLastModifiedTimestampSeconds=l.lastModifiedTimestamp,Q&&(R.entityMetadata.nextAutoRefreshIntervalSeconds=String(Q))):R&&(R.entityMetadata={nextAutoRefreshIntervalSeconds:Q?
String(Q):void 0,offlineLastModifiedTimestampSeconds:l.lastModifiedTimestamp});g.IP(y,2);return g.P(y,HK(C.U,{mode:"readwrite",Wm:!0},function(J){var W=p6(J,R,"mainPlaylistEntity"),io=p6(J,u,"mainPlaylistDownloadStateEntity");W=[W,io];io=g.I(Z);for(var Qp=io.next();!Qp.done;Qp=io.next())W.push(p6(J,Qp.value,"mainPlaylistVideoEntity"));X&&W.push(p6(J,X,"ytMainChannelEntity"));return g.R9.all(W)}),4);
case 4:g.RP(y,3);break;case 2:throw g.ek(y),sV("PES failure for playlist"),Error("PES failure for playlist");case 3:return y.return({mainPlaylistEntity:R,OuK:X,KKC:Z})}})},F7s=function(C,l){return{id:C,
channelId:l.channelId,title:l.title,avatar:l.thumbnail}},f8I=function(C){var l=[],b=C.videos;
b&&b.length>0&&l.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_FIRST_VIDEO"),value:{collageThumbnail:{coverThumbnail:b[0].offlineVideoData.thumbnail}}});if((C=C.additionalMetadadatas)&&C.length>0)for(C=g.I(C),b=C.next();!b.done;b=C.next()){var Q=b.value.offlineBundleItemPlaylistData,O=void 0;b=(O=Q)==null?void 0:O.style;O=void 0;Q={collageThumbnail:{coverThumbnail:(O=Q)==null?void 0:O.coverThumbnail}};switch(b){case "BUNDLE_ITEM_STYLE_UNSPECIFIED":l.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_UNKNOWN"),
value:Q});break;case "BUNDLE_ITEM_STYLE_TWO_BY_TWO":l.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_TWO_BY_TWO"),value:Q});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO_AVATAR":l.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO_AVATAR"),value:Q});break;case "BUNDLE_ITEM_STYLE_ONE_AND_TWO":l.push({key:Number("PLAYLIST_THUMBNAIL_STYLE_ONE_AND_TWO"),value:Q})}}return l},o0G=function(C){switch(C.privacy){case "PRIVATE":return"PLAYLIST_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_VISIBILITY_UNLISTED";default:return"PLAYLIST_VISIBILITY_UNKNOWN"}},chG=function(C,l,b){l={offlineVideoData:l,
playlistId:b};if(C=g.D(C.actionMetadata,v03))l.maximumDownloadQuality=C.maximumDownloadQuality;return{mainVideoEntityActionMetadata:l}},jcG=function(C,l,b){this.U=C;
this.UC=l;this.Z=b},DkB=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t,U;
return g.V(function(S){switch(S.j){case 1:return b=$s(l),Q=g.Eb(l.entityKey),O=Q.entityId,M=g.D(l.actionMetadata,NF),Z=!((x=M)==null?0:x.playlistId),g.IP(S,2),g.P(S,yhG(C,O,void 0,(n=M)==null?void 0:n.offlineVideoData,Z),4);case 4:g.RP(S,3);break;case 2:return B=g.ek(S),z="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",T="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",B instanceof g.Uu&&B.type==="QUOTA_EXCEEDED"&&(z="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",T="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
S.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,z,T));case 3:m=1;m=Number(((t=l.actionMetadata)==null?void 0:t.priority)||0)+1;var X=(X=g.D(l.actionMetadata,NF))?{playbackDataActionMetadata:{maximumDownloadQuality:X.maximumDownloadQuality}}:void 0;U=aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",O,"playbackData",m,Yhs,X);return S.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,[U]))}})},kDs=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R;
return g.V(function(v){switch(v.j){case 1:return b=$s(l),Q=g.Eb(l.entityKey),O=Q.entityId,g.P(v,Ec(C.U,l.entityKey,"mainVideoEntity"),2);case 2:M=v.U;if(!M){x=void 0;v.oY(3);break}return g.P(v,Ec(C.U,M.downloadState,"mainVideoDownloadStateEntity"),4);case 4:x=v.U;case 3:Z=x;if(!M||!Z)return v.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));g.IP(v,5);return g.P(v,yhG(C,O,Z.addedTimestampMillis,(B=g.D(l.actionMetadata,NF))==null?void 0:B.offlineVideoData),7);case 7:z=1;z=Number(((T=
l.actionMetadata)==null?void 0:T.priority)||0)+1;n=aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",O,"playbackData",z,Yhs);g.RP(v,6);break;case 5:m=g.ek(v);if(!(m instanceof Error&&m.message==="No data")){if(m instanceof Error&&m.message==="Empty response body")sV(m.message);else return t="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",U="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",m instanceof g.Uu&&m.type==="QUOTA_EXCEEDED"&&(t="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
U="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),v.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,t,U));v.oY(6);break}return g.P(v,RC(C.U,O),9);case 9:S=v.U;X=g.D(l.actionMetadata,NF);if(R=(u=X)==null?void 0:u.playlistId)S.playlistId=R;S.offlineDeleteReason="OFFLINE_DELETE_REASON_UNAVAILABLE";return g.P(v,XK(O,C.U,l,C.Z,S),6);case 6:return v.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,n?[n]:void 0))}})},hC$=function(C,l){var b,Q,O,M,x,Z,n,B,z,T;
return g.V(function(m){switch(m.j){case 1:return b=$s(l),g.IP(m,2),Q=g.Eb(l.entityKey).entityId,Q==="!*$_ALL_ENTITIES_!*$"?g.P(m,uAl(C.U,l,C.Z,(z=l.actionMetadata)==null?void 0:(T=z.offlineLoggingData)==null?void 0:T.offlineDeleteReason),5):g.P(m,RC(C.U,Q),6);case 6:O=m.U;M=g.D(l.actionMetadata,NF);if(Z=(x=M)==null?void 0:x.playlistId)O.playlistId=Z;O.offlineDeleteReason=(n=l.actionMetadata)==null?void 0:(B=n.offlineLoggingData)==null?void 0:B.offlineDeleteReason;return g.P(m,XK(Q,C.U,l,C.Z,O),7);
case 7:if(!C.UC.D("woffle_enable_main_downloads_library")){m.oY(5);break}return g.P(m,avB(C.U,l.entityKey),5);case 5:g.RP(m,3);break;case 2:return g.ek(m),m.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return m.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b))}})},yhG=function(C,l,b,Q,O){var M,x,Z,n,B,z;
return g.V(function(T){switch(T.j){case 1:if(M=Q){T.oY(2);break}return g.P(T,kQn([l]),3);case 3:x=T.U,M=x[0];case 2:return g.P(T,pyl(C,M,b,O),4);case 4:Z=T.U;n=Z.mainVideoEntity;B=Z.channelEntity;g.IP(T,5);var m=tJ(n.thumbnail),t=tJ(B.avatar);return g.P(T,Sb(m.concat(t)),7);case 7:g.RP(T,0);break;case 5:z=g.ek(T),z instanceof Error&&z.message==="Failed to fetch"&&sV(z.message),g.r6(T)}})},pyl=function(C,l,b,Q){var O,M,x,Z,n,B,z,T,m,t,U,S,X;
return g.V(function(u){switch(u.j){case 1:b||(b=Date.now().toString());M=(O=l.channel)==null?void 0:O.offlineChannelData;x={id:g.gG(l.videoId,"ytMainChannelEntity"),channelId:M.channelId,title:M.title,avatar:M.thumbnail};Z={key:g.gG(l.videoId,"mainVideoDownloadStateEntity"),playbackData:g.gG(l.videoId,"playbackData"),addedTimestampMillis:b,videoDownloadContextEntity:g.gG(l.videoId,"videoDownloadContextEntity")};n={key:g.gG(l.videoId,"videoPlaybackPositionEntity"),videoId:l.videoId,lastPlaybackPositionSeconds:"0"};
C.UC.D("html5_offline_playback_position_sync")&&(B={playbackPosition:n.key});z=g.gG(l.videoId,"mainVideoEntity");T={key:z,videoId:l.videoId,title:l.title,thumbnail:l.thumbnail,localizedStrings:{viewCount:l.shortViewCountText},userState:B,lengthSeconds:l.lengthSeconds?Number(l.lengthSeconds):void 0,publishedTimestampMillis:l.publishedTimestamp?(Number(l.publishedTimestamp)*1E3).toString():void 0,formattedDescription:l.description,owner:x.id,downloadState:Z.key};if(!C.UC.D("woffle_enable_main_downloads_library")||
!Q){u.oY(2);break}return g.P(u,PHm(C.U,[z]),3);case 3:if(U=u.U)m=U.mainDownloadsLibraryEntity,t=U.mainDownloadsListEntity;case 2:return X=mmR,S={key:g.gG(l.videoId,"downloadStatusEntity"),downloadState:"DOWNLOAD_STATE_PENDING_DOWNLOAD"},g.D_(Z,X,S),g.P(u,HK(C.U,{mode:"readwrite",Wm:!0},function(R){var v=p6(R,x,"ytMainChannelEntity"),a=p6(R,Z,"mainVideoDownloadStateEntity"),y=p6(R,T,"mainVideoEntity");v=[v,a,y];C.UC.D("html5_offline_playback_position_sync")&&(a=p6(R,n,"videoPlaybackPositionEntity"),
v.push(a));m&&(a=p6(R,m,"mainDownloadsLibraryEntity"),v.push(a));t&&(a=p6(R,t,"mainDownloadsListEntity"),v.push(a));S&&(R=p6(R,S,"downloadStatusEntity"),v.push(R));return g.R9.all(v)}),4);
case 4:return u.return({mainVideoEntity:T,channelEntity:x})}})},W7R=function(C,l,b){this.U=C;
this.UC=l;this.Z=b},JhU=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a,y,J,W,io,Qp,CR,GT,N;
return g.V(function(Sk){switch(Sk.j){case 1:return b=$s(l),Q=[],g.P(Sk,jJ.getInstance(),2);case 2:O=Sk.U;if(!O){Sk.oY(3);break}return g.P(Sk,O.get("sdois"),4);case 4:return M=Sk.U,g.P(Sk,(Z=O)==null?void 0:Z.get("lmqf"),5);case 5:x=Sk.U;case 3:g.IP(Sk,6);if(M===void 0)throw Error("prefStorage or opt-in state is undefined");n=[];if(M){Sk.oY(8);break}return g.P(Sk,cbB(C.U),9);case 9:n=Sk.U,n.reverse();case 8:if(!n.length){Sk.oY(10);break}B=g.I(n);z=B.next();case 11:if(z.done){Sk.oY(10);break}T=z.value;
if(!T){Sk.oY(12);break}m=g.Eb(T).entityId;return g.P(Sk,RC(C.U,m),14);case 14:return t=Sk.U,t.offlineDeleteReason="OFFLINE_DELETE_REASON_PARENT_LIST_DELETE",g.P(Sk,XK(m,C.U,{entityKey:T,actionType:l.actionType},C.Z,t),12);case 12:z=B.next();Sk.oY(11);break;case 10:return g.P(Sk,Jb$(M,(U=x)!=null?U:"SD"),16);case 16:return S=Sk.U,g.P(Sk,wEY(S),17);case 17:X=dmM(S);if(!C.UC.D("woffle_enable_main_downloads_library")){Sk.oY(18);break}if(M){Sk.oY(19);break}return g.P(Sk,avB(C.U,g.LZ),19);case 19:return g.P(Sk,
vBX(C.U,[g.LZ]),18);case 18:if((u=X)==null?0:u.length)for(R=g.I(X),v=R.next();!v.done;v=R.next())if(y=a=v.value,J=y.actionType,W=y.entityKey,io=y.actionMetadata,J&&W&&io&&!g.D(io,qhC)){J==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(io.offlineLoggingData={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_DELETE"});if(Qp=g.D(a.actionMetadata,NF))Qp.playlistId="DOWNLOADS_LIST_ENTITY_ID_SMART_DOWNLOADS",a.actionMetadata=Object.assign({},a.actionMetadata,{mainVideoEntityActionMetadata:Qp});Q.push(a)}g.RP(Sk,
7);break;case 6:return CR=g.ek(Sk),GT="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",N="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",CR instanceof g.Uu&&CR.type==="QUOTA_EXCEEDED"&&(GT="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",N="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),Sk.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,GT,N));case 7:return Sk.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,Q))}})},HLn=function(){qF.apply(this,
arguments);
this.Y="mainVideoEntity"},NAX=function(C,l,b){l=l===void 0?43200:l;
b=b===void 0?!0:b;var Q=Q===void 0?!1:Q;var O,M,x;return g.V(function(Z){switch(Z.j){case 1:if(!C.S.vS())return Z.return([]);O=[];g.IP(Z,2);return g.P(Z,WQ3(l,b,Q),4);case 4:O=Z.U;g.RP(Z,3);break;case 2:M=g.ek(Z),M instanceof Error&&M.message==="No data"||M instanceof Error&&M.message==="Empty response body"&&sV(M.message);case 3:return x=u$U(C,O,b,"mainPlaylistEntity"),Z.return(x)}})},E0M=function(C,l,b,Q){Q=Q===void 0?!1:Q;
var O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R;return g.V(function(v){switch(v.j){case 1:return O=[],g.P(v,qvI(),2);case 2:return(M=v.U)||Q?g.P(v,HWl(l,b),3):v.return([]);case 3:x=v.U;if((Z=x)==null||!Z.length)return v.return([]);n={offlineDeleteReason:"OFFLINE_DELETE_REASON_PARENT_LIST_REFRESH"};B=g.I(x);z=B.next();case 4:if(z.done){v.oY(6);break}m=T=z.value;t=m.actionType;U=m.entityKey;S=m.actionMetadata;if(!(t&&U&&S)||g.D(S,qhC)){v.oY(5);break}t==="OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE"&&(S.offlineLoggingData=
n);X=g.Eb(U);u=X.entityId;return g.P(v,JJ(C,[u],"mainVideoEntity",t,S),8);case 8:R=v.U,O=O.concat(R);case 5:z=B.next();v.oY(4);break;case 6:return v.return(O)}})},g0M=function(C,l){this.U=C;
this.Z=l},ltq=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u;
return g.V(function(R){switch(R.j){case 1:return b=$s(l),Q=g.Eb(l.entityKey),O=Q.entityId,M=[],g.IP(R,2),g.P(R,C5U(C,O),4);case 4:M=R.U;if((x=M)==null||!x.length){R.oY(5);break}return g.P(R,FQq(C.U,l.entityKey),5);case 5:g.RP(R,3);break;case 2:return Z=g.ek(R),n="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",B="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Z instanceof g.Uu&&Z.type==="QUOTA_EXCEEDED"&&(n="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",B="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
R.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,n,B));case 3:return z=[],g.P(R,tCM(C.U,"musicTrack",M),7);case 7:M=R.U;if(M.length)for(T=g.I(M),m=T.next();!m.done;m=T.next())if(t=m.value,U=t.offlineVideoData,S=void 0,(S=U)==null?0:S.videoId)X=void 0,u=Number(((X=l.actionMetadata)==null?void 0:X.priority)||0)+1,z.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",U.videoId,"musicTrack",u,EV,di(l,U,O)));return R.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,z))}})},
bKB=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a,y,J,W,io,Qp,CR,GT,N,Sk,w6,km,RI,Gq,d6,uo,Qm,K,xm,WB,Sd,cB,mC,yp,Vm,PB,e,d,c,L,k,KR,bo,Uq,sq,PF,Np,XM,X7,vP,WZ;
return g.V(function(pG){switch(pG.j){case 1:return b=$s(l),Q=l.entityKey,O=g.Eb(Q).entityId,M=[],x=!1,O==="!*$_ALL_ENTITIES_!*$"?(x=!0,g.P(pG,gF(C.U,"musicAlbumRelease"),5)):g.P(pG,Ec(C.U,Q,"musicAlbumRelease"),4);case 4:(Z=pG.U)&&M.push(Z);pG.oY(3);break;case 5:M=pG.U;case 3:if((n=M)==null||!n.length)return pG.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));if(x){B=[];z=g.I(M);for(T=z.next();!T.done;T=z.next())m=T.value,t=g.Eb(m.id).entityId,B.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",
t,"musicAlbumRelease",0,EV));return pG.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,B))}U=[];S=M[0];X=void 0;if(!S.downloadMetadata){pG.oY(6);break}return g.P(pG,Ec(C.U,S.downloadMetadata,"musicAlbumReleaseDownloadMetadataEntity"),7);case 7:u=pG.U,X=Number((v=(R=u)==null?void 0:R.addedTimestampMillis)!=null?v:"0")/1E3;case 6:return g.IP(pG,8),g.P(pG,C5U(C,O,(a=X)==null?void 0:a.toString()),10);case 10:U=pG.U;g.RP(pG,9);break;case 8:y=g.ek(pG);if(!(y instanceof Error&&y.message===
"No data")){if(y instanceof Error&&y.message==="Empty response body")sV(y.message);else return J="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",W="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",y instanceof g.Uu&&y.type==="QUOTA_EXCEEDED"&&(J="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",W="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),pG.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,J,W));pG.oY(9);break}return g.P(pG,wi(O,"musicAlbumRelease",C.U,
l,C.Z),9);case 9:io=[];Qp=new Map;if((CR=U)==null?0:CR.length)for(GT=g.I(U),N=GT.next();!N.done;N=GT.next())Sk=N.value,w6=Sk.offlineVideoData,km=void 0,((km=w6)==null?0:km.videoId)&&Qp.set(w6.videoId,w6);RI=new Map;Gq=[];if((d6=S)==null?0:(uo=d6.tracks)==null?0:uo.length)for(Qm=g.I(S.tracks),K=Qm.next();!K.done;K=Qm.next())if(xm=K.value,WB=g.Eb(xm).entityId)Qp.has(WB)?(RI.set(WB,Qp.get(WB)),Qp.delete(WB)):Gq.push(WB);cB=Number(((Sd=l.actionMetadata)==null?void 0:Sd.priority)||0)+1;mC=g.I(Qp.entries());
for(yp=mC.next();!yp.done;yp=mC.next())Vm=yp.value,PB=g.I(Vm),e=PB.next().value,d=PB.next().value,c=e,L=d,io.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",c,"musicTrack",cB,EV,di(l,L)));k=g.I(RI.entries());for(KR=k.next();!KR.done;KR=k.next())bo=KR.value,Uq=g.I(bo),sq=Uq.next().value,PF=Uq.next().value,Np=sq,XM=PF,io.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",Np,"musicTrack",cB,EV,di(l,XM)));X7=g.I(Gq);for(vP=X7.next();!vP.done;vP=X7.next())WZ=vP.value,io.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
WZ,"musicTrack",0,EV));return pG.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,io))}})},iKR=function(C,l){var b,Q;
return g.V(function(O){switch(O.j){case 1:return b=$s(l),g.IP(O,2),Q=g.Eb(l.entityKey).entityId,Q==="!*$_ALL_ENTITIES_!*$"?g.P(O,eb(C.U,l,C.Z),5):g.P(O,wi(Q,"musicAlbumRelease",C.U,l,C.Z),6);case 6:return g.P(O,jvY(C.U,l.entityKey),5);case 5:g.RP(O,3);break;case 2:return g.ek(O),O.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return O.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b))}})},C5U=function(C,l,b){var Q,O,M;
return g.V(function(x){switch(x.j){case 1:return g.P(x,hqM([l]),2);case 2:return Q=x.U,g.P(x,spR(C,Q[0],b),3);case 3:return O=x.U,M=tJ(O.thumbnailDetails),g.P(x,Sb(M),4);case 4:return x.return(Q[0].videos)}})},spR=function(C,l,b){var Q,O,M,x,Z,n,B,z,T,m,t,U,S,X;
return g.V(function(u){if(u.j==1){Q=l.additionalMetadadatas;O=void 0;if(Q&&Q.length>0)for(M=g.I(Q),x=M.next();!x.done;x=M.next())if(Z=x.value,Z.offlineMusicPlaylistData){O=Z.offlineMusicPlaylistData;break}n=l.playlistId;B=ybn(l);z=B.pS;T=B.I7;m=b?(Number(b)*1E3).toString():Date.now().toString();t=l.lastModifiedTimestamp?(Number(l.lastModifiedTimestamp)*1E3).toString():"0";U={id:g.gG(n,"musicAlbumReleaseDownloadMetadataEntity"),trackDownloadMetadatas:T,lastModifiedTimestampMillis:t,addedTimestampMillis:m,
syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"};S={id:g.gG(n,"musicAlbumRelease"),title:l.title,audioPlaylistId:n,trackCount:l.totalVideoCount,tracks:z,downloadMetadata:U.id};O&&(S.thumbnailDetails=(X=O.albumHqThumbnail)!=null?X:O.albumArtistThumbnail,S.artistDisplayName=O.albumArtistDisplayName,S.releaseDate=O.albumReleaseDate,S.contentRating={explicitType:O.albumReleaseExplicitType},S.releaseType=O.albumReleaseType);return g.P(u,HK(C.U,{mode:"readwrite",Wm:!0},function(R){var v=p6(R,S,"musicAlbumRelease");
R=p6(R,U,"musicAlbumReleaseDownloadMetadataEntity");return g.R9.all([v,R])}),2)}return u.return(S)})},QpR=function(C,l){this.U=C;
this.Z=l},MoY=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u;
return g.V(function(R){switch(R.j){case 1:return b=$s(l),Q=g.Eb(l.entityKey),O=Q.entityId,M=[],g.IP(R,2),g.P(R,OKl(C,O),4);case 4:M=R.U;if((x=M)==null||!x.length){R.oY(5);break}return g.P(R,FQq(C.U,l.entityKey),5);case 5:g.RP(R,3);break;case 2:return Z=g.ek(R),n="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",B="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Z instanceof g.Uu&&Z.type==="QUOTA_EXCEEDED"&&(n="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",B="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),
R.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,n,B));case 3:return z=[],g.P(R,tCM(C.U,"musicTrack",M),7);case 7:M=R.U;if(M.length)for(T=g.I(M),m=T.next();!m.done;m=T.next())if(t=m.value,U=t.offlineVideoData,S=void 0,(S=U)==null?0:S.videoId)X=void 0,u=Number(((X=l.actionMetadata)==null?void 0:X.priority)||0)+1,z.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",U.videoId,"musicTrack",u,gi,di(l,U,O)));return R.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,z))}})},
xDB=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a,y,J,W,io,Qp,CR,GT,N,Sk,w6,km,RI,Gq,d6,uo,Qm,K,xm,WB,Sd,cB,mC,yp,Vm,PB,e,d,c,L,k,KR,bo,Uq,sq,PF,Np,XM,X7,vP,WZ,pG,qN,rS,$_,cw,t_,Pw,DK,k5,S4,sY,J7;
return g.V(function(Om){switch(Om.j){case 1:return b=$s(l),Q=l.entityKey,O=g.Eb(Q).entityId,M=[],x=!1,O==="!*$_ALL_ENTITIES_!*$"?(x=!0,g.P(Om,gF(C.U,"musicPlaylist"),5)):g.P(Om,Ec(C.U,Q,"musicPlaylist"),4);case 4:(Z=Om.U)&&M.push(Z);Om.oY(3);break;case 5:M=Om.U;case 3:if((n=M)==null||!n.length)return Om.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));B=g.D(l.actionMetadata,Yvl);T=(z=B)==null?void 0:z.autoSync;m=[];U=t=!0;S=!1;X=void 0;if(!x&&T===!1){Om.oY(6);break}g.IP(Om,7);return g.P(Om,
NrM(0,!!T,!0,M),9);case 9:m=Om.U;g.RP(Om,8);break;case 7:u=g.ek(Om);if(!(u instanceof Error&&u.message==="No data")){u instanceof Error&&u.message==="Empty response body"&&sV(u.message);Om.oY(8);break}return O==="!*$_ALL_ENTITIES_!*$"?g.P(Om,eb(C.U,l,C.Z),8):g.P(Om,wi(O,"musicPlaylist",C.U,l,C.Z),8);case 8:if(!m.length||!x&&m[0].playlistId!==O)return Om.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));case 6:if(x){R=[];v=g.I(m);for(a=v.next();!a.done;a=v.next())y=a.value,y.upToDate||
T&&!y.shouldAutoSyncMetadata||!y.playlistId||(J={autoSync:T},R.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",y.playlistId,"musicPlaylist",0,gi,{musicPlaylistEntityActionMetadata:J})));return Om.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,R))}m.length&&(W=m[0],S=!!W.upToDate,T&&(t=(io=W.shouldAutoSyncMetadata)!=null?io:!0,U=(Qp=W.shouldAutoSyncVideos)!=null?Qp:!0,W.checkInSeconds&&(X=W.checkInSeconds)));if(S||!t)return Om.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b));CR=[];GT=M[0];N=void 0;if(!GT.downloadMetadata){Om.oY(15);break}return g.P(Om,Ec(C.U,GT.downloadMetadata,"musicPlaylistDownloadMetadataEntity"),16);case 16:Sk=Om.U,N=Number((km=(w6=Sk)==null?void 0:w6.addedTimestampMillis)!=null?km:"0")/1E3;case 15:return g.IP(Om,17),g.P(Om,OKl(C,O,(RI=N)==null?void 0:RI.toString(),X),19);case 19:CR=Om.U;g.RP(Om,18);break;case 17:Gq=g.ek(Om);if(!(Gq instanceof Error&&Gq.message==="No data")){if(Gq instanceof Error&&Gq.message==="Empty response body")sV(Gq.message);
else return d6="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",uo="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",Gq instanceof g.Uu&&Gq.type==="QUOTA_EXCEEDED"&&(d6="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",uo="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),Om.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,d6,uo));Om.oY(18);break}return g.P(Om,wi(O,"musicPlaylist",C.U,l,C.Z),18);case 18:if(!U)return Om.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b));Qm=[];K=new Map;if((xm=CR)==null?0:xm.length)for(WB=g.I(CR),Sd=WB.next();!Sd.done;Sd=WB.next())cB=Sd.value,mC=cB.offlineVideoData,yp=void 0,((yp=mC)==null?0:yp.videoId)&&K.set(mC.videoId,mC);Vm=new Map;PB=[];if((e=GT)==null?0:(d=e.tracks)==null?0:d.length)for(c=g.I(GT.tracks),L=c.next();!L.done;L=c.next())if(k=L.value,KR=g.Eb(k).entityId)K.has(KR)?(Vm.set(KR,K.get(KR)),K.delete(KR)):PB.push(KR);Uq=Number(((bo=l.actionMetadata)==null?void 0:bo.priority)||0)+1;sq=g.I(K.entries());for(PF=sq.next();!PF.done;PF=
sq.next())Np=PF.value,XM=g.I(Np),X7=XM.next().value,vP=XM.next().value,WZ=X7,pG=vP,Qm.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",WZ,"musicTrack",Uq,gi,di(l,pG)));qN=g.I(Vm.entries());for(rS=qN.next();!rS.done;rS=qN.next())$_=rS.value,cw=g.I($_),t_=cw.next().value,Pw=cw.next().value,DK=t_,k5=Pw,Qm.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",DK,"musicTrack",Uq,gi,di(l,k5)));S4=g.I(PB);for(sY=S4.next();!sY.done;sY=S4.next())J7=sY.value,Qm.push(aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
J7,"musicTrack",0,gi));return Om.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,Qm))}})},G1C=function(C,l){var b,Q;
return g.V(function(O){switch(O.j){case 1:return b=$s(l),g.IP(O,2),Q=g.Eb(l.entityKey).entityId,Q==="!*$_ALL_ENTITIES_!*$"?g.P(O,eb(C.U,l,C.Z),5):g.P(O,wi(Q,"musicPlaylist",C.U,l,C.Z),6);case 6:return g.P(O,jvY(C.U,l.entityKey),5);case 5:g.RP(O,3);break;case 2:return g.ek(O),O.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return O.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b))}})},OKl=function(C,l,b,Q){var O,M,x;
return g.V(function(Z){switch(Z.j){case 1:return g.P(Z,hqM([l]),2);case 2:return O=Z.U,g.P(Z,$D3(C,O[0],b,Q),3);case 3:return M=Z.U,x=tJ(M.thumbnailDetails),g.P(Z,Sb(x),4);case 4:return Z.return(O[0].videos)}})},$D3=function(C,l,b,Q){var O,M,x,Z,n,B,z,T,m;
return g.V(function(t){return t.j==1?(O=l.playlistId,M=ybn(l),x=M.pS,Z=M.I7,n=b?(Number(b)*1E3).toString():Date.now().toString(),B=l.lastModifiedTimestamp?(Number(l.lastModifiedTimestamp)*1E3).toString():"0",z={id:g.gG(O,"musicPlaylistDownloadMetadataEntity"),trackDownloadMetadatas:Z,lastModifiedTimestampMillis:B,addedTimestampMillis:n,syncState:"DOWNLOAD_SYNC_STATE_UP_TO_DATE"},T={id:g.gG(O,"musicPlaylist"),title:l.title,playlistId:O,thumbnailDetails:l.thumbnail,visibility:ZKB(l),trackCount:l.totalVideoCount,
tracks:x,downloadMetadata:z.id},Q&&(((m=T)==null?0:m.entityMetadata)?T.entityMetadata.nextAutoRefreshIntervalSeconds=String(Q):T&&(T.entityMetadata={nextAutoRefreshIntervalSeconds:String(Q)})),g.P(t,HK(C.U,{mode:"readwrite",Wm:!0},function(U){var S=p6(U,T,"musicPlaylist");U=p6(U,z,"musicPlaylistDownloadMetadataEntity");return g.R9.all([S,U])}),2)):t.return(T)})},ZKB=function(C){switch(C.privacy){case "PRIVATE":return"PLAYLIST_ENTITY_VISIBILITY_PRIVATE";
case "PUBLIC":return"PLAYLIST_ENTITY_VISIBILITY_PUBLIC";case "UNLISTED":return"PLAYLIST_ENTITY_VISIBILITY_UNLISTED";default:return"PLAYLIST_ENTITY_VISIBILITY_UNKNOWN"}},ndY=function(C,l){this.U=C;
this.Z=l},mDM=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t,U;
return g.V(function(S){switch(S.j){case 1:return b=$s(l),Q=g.Eb(l.entityKey),O=Q.entityId,M=g.D(l.actionMetadata,BEq),g.IP(S,2),g.P(S,ziI(C,O,void 0,(x=M)==null?void 0:x.track,(Z=M)==null?void 0:Z.albumRelease),4);case 4:if((n=M)==null?0:n.playlistId){S.oY(5);break}return g.P(S,FQq(C.U,l.entityKey),5);case 5:g.RP(S,3);break;case 2:return B=g.ek(S),z="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",T="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",B instanceof g.Uu&&B.type==="QUOTA_EXCEEDED"&&
(z="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",T="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),S.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,z,T));case 3:t=Number(((m=l.actionMetadata)==null?void 0:m.priority)||0)+1;var X=(X=g.D(l.actionMetadata,BEq))?{playbackDataActionMetadata:{maximumDownloadQuality:X.maximumDownloadQuality}}:void 0;U=aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",O,"playbackData",t,TEX,X);return S.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b,[U]))}})},toB=function(C,l){var b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X;
return g.V(function(u){switch(u.j){case 1:return b=$s(l),Q=g.Eb(l.entityKey),O=Q.entityId,g.P(u,Ec(C.U,l.entityKey,"musicTrack"),2);case 2:M=u.U;if(!M){x=void 0;u.oY(3);break}return g.P(u,Ec(C.U,M.downloadMetadata,"musicTrackDownloadMetadataEntity"),4);case 4:x=u.U;case 3:Z=x;if(!M||!Z)return u.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b));B=g.D(l.actionMetadata,BEq);g.IP(u,5);return g.P(u,ziI(C,O,Z.addedTimestampMillis,(z=B)==null?void 0:z.track,(T=B)==null?void 0:T.albumRelease),
7);case 7:t=Number(((m=l.actionMetadata)==null?void 0:m.priority)||0)+1;n=aC("OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH",O,"playbackData",t,TEX);g.RP(u,6);break;case 5:U=g.ek(u);if(!(U instanceof Error&&U.message==="No data")){if(U instanceof Error&&U.message==="Empty response body")sV(U.message);else return S="OFFLINE_OPERATION_FAILURE_REASON_UNKNOWN",X="OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED",U instanceof g.Uu&&U.type==="QUOTA_EXCEEDED"&&(S="OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED",
X="OFFLINE_ORCHESTRATION_FAILURE_REASON_NO_STORAGE"),u.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,S,X));u.oY(6);break}return g.P(u,u9(O,C.U,l,C.Z),6);case 6:return u.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",b,n?[n]:void 0))}})},UDX=function(C,l){var b,Q;
return g.V(function(O){switch(O.j){case 1:return b=$s(l),g.IP(O,2),Q=g.Eb(l.entityKey).entityId,Q==="!*$_ALL_ENTITIES_!*$"?g.P(O,eb(C.U,l,C.Z),5):g.P(O,u9(Q,C.U,l,C.Z),6);case 6:return g.P(O,jvY(C.U,l.entityKey),5);case 5:g.RP(O,3);break;case 2:return g.ek(O),O.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_FAILURE",b,void 0,"OFFLINE_OPERATION_FAILURE_REASON_DATABASE_REQUEST_FAILED","OFFLINE_ORCHESTRATION_FAILURE_REASON_DATABASE_OPERATION_FAILED"));case 3:return O.return(new Lc("OFFLINE_ORCHESTRATION_ACTION_RESULT_SUCCESS",
b))}})},ziI=function(C,l,b,Q,O){var M,x,Z,n,B,z;
return g.V(function(T){switch(T.j){case 1:if(M=Q){T.oY(2);break}return g.P(T,kQn([l]),3);case 3:x=T.U,Z=x[0],M=oBU(Z);case 2:return g.P(T,APX(C,M,l,O,b),4);case 4:n=T.U;B=n.musicTrackEntity;z=n.HP;var m=tJ(B.thumbnailDetails),t=[];z&&(t=tJ(z.thumbnailDetails));return g.P(T,Sb(m.concat(t)),0)}})},APX=function(C,l,b,Q,O){var M;
return g.V(function(x){return x.j==1?(O||(O=Date.now().toString()),M={id:g.gG(b,"musicTrackDownloadMetadataEntity"),playbackData:g.gG(b,"playbackData"),addedTimestampMillis:O,videoDownloadContextEntity:g.gG(b,"videoDownloadContextEntity")},Q&&(l.albumRelease=Q.id),g.P(x,HK(C.U,{mode:"readwrite",Wm:!0},function(Z){var n=[],B=p6(Z,M,"musicTrackDownloadMetadataEntity");n.push(B);B=p6(Z,l,"musicTrack");n.push(B);Q&&(Z=p6(Z,Q,"musicAlbumRelease"),n.push(Z));return g.R9.all(n)}),2)):x.j!=3?g.P(x,zY(b,"musicTrackDownloadMetadataEntity",
C.U,"DOWNLOAD_STATE_PENDING_DOWNLOAD"),3):x.return({musicTrackEntity:l,
HP:Q})})},C_=function(){qF.apply(this,arguments);
this.Y="musicTrack"},rPM=function(C,l,b){l=l===void 0?43200:l;
b=b===void 0?!0:b;var Q=Q===void 0?!1:Q;var O,M;return g.V(function(x){switch(x.j){case 1:if(!C.S.vS())return x.return([]);O=[];g.IP(x,2);return g.P(x,NrM(l,b,Q),4);case 4:O=x.U;g.RP(x,3);break;case 2:g.ek(x);case 3:return M=u$U(C,O,b,"musicPlaylist"),x.return(M)}})},Its=function(){g.m5.apply(this,arguments);
var C=this;this.events=new g.FO(this);this.UC=this.player.J();this.dF={aAC:function(){return C.U},
Tu:function(){return C.Tu()},
Lb:function(l){return C.Lb(l)}}},Sfm=function(C){var l;
C=g.D((l=C.getWatchNextResponse())==null?void 0:l.currentVideoEndpoint,g.i3);if(C==null?0:C.playlistId)var b=C.playlistId;return b},XiG=function(C,l){var b,Q,O,M;
return g.V(function(x){if(x.j==1){b=l.clientPlaybackNonce;Q={cpn:b,offlineSourceVisualElement:g.Rs(l.CC||"").getAsJson(),selectedOfflineMode:"OFFLINE_NOW",isPartialPlayback:!1};l.j&&(Q.videoFmt=Number(l.j.itag));l.C&&(Q.audioFmt=Number(l.C.itag));if((O=Sfm(l))&&l.videoId){var Z=l.videoId;Z=O!=="PPSV"?Promise.resolve(!1):C.U.cw(Z);x=g.P(x,Z,3)}else x=x.oY(2);return x}x.j!=2&&(M=x.U)&&(Q.selectedOfflineMode="OFFLINE_MODE_TYPE_AUTO_OFFLINE");C.j=b;g.ZM("offlinePlaybackStarted",Q);g.r6(x)})};
g.dw.prototype.td=g.Oq(51,function(C){return this.app.td(C)});
g.mi.prototype.td=g.Oq(50,function(C){return g.jCF(this,9,C)});
g.r(oT,f6);g.Mp.Object.defineProperties(oT.prototype,{entityMetadata:{configurable:!0,enumerable:!0,get:function(){return this.U.entityMetadata},
set:function(C){this.U.entityMetadata=C}}});
g.r(T8M,oT);T8M.prototype.j=function(){return[]};
g.r(m4B,oT);m4B.prototype.j=function(){return[]};
g.r(ttn,oT);ttn.prototype.j=function(){return[]};
g.r(U4$,oT);U4$.prototype.j=function(){return[]};
g.r(A13,oT);A13.prototype.j=function(){var C=[];this.U.alternateChannel&&C.push(this.U.alternateChannel);this.U.alternateChannelList&&C.push.apply(C,g.w(this.U.alternateChannelList));this.U.oneofChannelEntity&&C.push(this.U.oneofChannelEntity);return[].concat(g.w(new Set(C)))};
g.r(r1U,oT);r1U.prototype.j=function(){var C=[];this.U.entryCollection&&C.push(this.U.entryCollection);return[].concat(g.w(new Set(C)))};
g.r(IKX,f6);IKX.prototype.j=function(){var C=[];this.U.video&&C.push(this.U.video);return[].concat(g.w(new Set(C)))};
g.r(S5X,oT);S5X.prototype.j=function(){var C=[];this.U.parentPlaylist&&C.push(this.U.parentPlaylist);if(this.U.entries)for(var l=g.I(this.U.entries),b=l.next();!b.done;b=l.next())C.push.apply(C,g.w((new IKX(b.value)).j()));return[].concat(g.w(new Set(C)))};
g.r(Xln,oT);Xln.prototype.j=function(){var C=[];this.U.descriptionEntity&&C.push(this.U.descriptionEntity);this.U.creators&&C.push.apply(C,g.w(this.U.creators));this.U.theBiggestFan&&C.push(this.U.theBiggestFan);return[].concat(g.w(new Set(C)))};
g.r(KpG,oT);KpG.prototype.j=function(){return[]};
g.r(RPG,oT);RPG.prototype.j=function(){return[]};
g.r(uWU,oT);uWU.prototype.j=function(){return[]};
g.r(wlY,oT);wlY.prototype.j=function(){return[]};
g.r(ePs,oT);ePs.prototype.j=function(){return[]};
g.r(d4M,oT);d4M.prototype.j=function(){return[]};
g.r(c1I,oT);c1I.prototype.j=function(){return[]};
g.r(PNR,oT);PNR.prototype.j=function(){return[]};
g.r(v5s,oT);v5s.prototype.j=function(){return[]};
g.r(aKR,oT);aKR.prototype.j=function(){var C=[];this.U.downloadsList&&C.push(this.U.downloadsList);this.U.smartDownloadsList&&C.push(this.U.smartDownloadsList);this.U.recommendedDownloadsList&&C.push(this.U.recommendedDownloadsList);this.U.refresh&&C.push(this.U.refresh);return[].concat(g.w(new Set(C)))};
g.r(Lpm,f6);Lpm.prototype.j=function(){var C=[];this.U.video&&C.push(this.U.video);this.U.playlist&&C.push(this.U.playlist);this.U.videoItem&&C.push(this.U.videoItem);this.U.playlistItem&&C.push(this.U.playlistItem);return[].concat(g.w(new Set(C)))};
g.r(Vts,oT);Vts.prototype.j=function(){var C=[];this.U.refresh&&C.push(this.U.refresh);if(this.U.downloads)for(var l=g.I(this.U.downloads),b=l.next();!b.done;b=l.next())C.push.apply(C,g.w((new Lpm(b.value)).j()));return[].concat(g.w(new Set(C)))};
g.r(fKs,oT);fKs.prototype.j=function(){var C=[];this.U.localImageEntities&&C.push.apply(C,g.w(this.U.localImageEntities));return[].concat(g.w(new Set(C)))};
g.r(o5n,oT);o5n.prototype.j=function(){var C=[];this.U.playbackData&&C.push(this.U.playbackData);this.U.localImageEntities&&C.push.apply(C,g.w(this.U.localImageEntities));this.U.videoDownloadContextEntity&&C.push(this.U.videoDownloadContextEntity);return[].concat(g.w(new Set(C)))};
g.r(FpM,oT);FpM.prototype.j=function(){return[]};
g.r(jbX,oT);jbX.prototype.j=function(){var C=[];this.U.fakeChildren&&C.push.apply(C,g.w(this.U.fakeChildren));return[].concat(g.w(new Set(C)))};
g.r(y1M,oT);y1M.prototype.j=function(){var C=[];this.U.video&&C.push(this.U.video);this.U.playbackData&&C.push(this.U.playbackData);this.U.offlineVideoPolicy&&C.push(this.U.offlineVideoPolicy);return[].concat(g.w(new Set(C)))};
g.r(Y5B,oT);Y5B.prototype.j=function(){return[]};
g.r(D4G,oT);D4G.prototype.j=function(){var C=[];this.U.channelOwner&&C.push(this.U.channelOwner);this.U.videos&&C.push.apply(C,g.w(this.U.videos));this.U.collaboratorChannels&&C.push.apply(C,g.w(this.U.collaboratorChannels));this.U.downloadState&&C.push(this.U.downloadState);this.U.refresh&&C.push(this.U.refresh);return[].concat(g.w(new Set(C)))};
g.r(kRC,oT);kRC.prototype.j=function(){var C=[];this.U.video&&C.push(this.U.video);this.U.channelContributor&&C.push(this.U.channelContributor);return[].concat(g.w(new Set(C)))};
g.r(hPm,f6);hPm.prototype.j=function(){var C=[];this.U.localImageEntities&&C.push.apply(C,g.w(this.U.localImageEntities));this.U.videoDownloadContextEntity&&C.push(this.U.videoDownloadContextEntity);return[].concat(g.w(new Set(C)))};
g.r(pls,f6);pls.prototype.j=function(){var C=[];this.U.recommendedVideoMetadata&&C.push.apply(C,g.w((new hPm(this.U.recommendedVideoMetadata)).j()));return[].concat(g.w(new Set(C)))};
g.r(Wp$,f6);Wp$.prototype.j=function(){var C=[];this.U.playbackPosition&&C.push(this.U.playbackPosition);return[].concat(g.w(new Set(C)))};
g.r(q53,oT);q53.prototype.j=function(){var C=[];this.U.owner&&C.push(this.U.owner);this.U.downloadState&&C.push(this.U.downloadState);this.U.userState&&C.push.apply(C,g.w((new Wp$(this.U.userState)).j()));this.U.additionalMetadata&&C.push.apply(C,g.w((new pls(this.U.additionalMetadata)).j()));return[].concat(g.w(new Set(C)))};
g.r(J1B,oT);J1B.prototype.j=function(){var C=[];this.U.userChannelDetails&&C.push(this.U.userChannelDetails);return[].concat(g.w(new Set(C)))};
g.r(Hd$,oT);Hd$.prototype.j=function(){var C=[];this.U.channelOwner&&C.push(this.U.channelOwner);this.U.playbackPosition&&C.push(this.U.playbackPosition);this.U.localImageEntities&&C.push.apply(C,g.w(this.U.localImageEntities));this.U.downloadStatus&&C.push(this.U.downloadStatus);return[].concat(g.w(new Set(C)))};
g.r(N8B,oT);N8B.prototype.j=function(){return[]};
g.r(E5R,oT);E5R.prototype.j=function(){return[]};
g.r(g5M,oT);g5M.prototype.j=function(){return[]};
g.r(C6R,oT);C6R.prototype.j=function(){return[]};
g.r(leC,oT);leC.prototype.j=function(){return[]};
g.r(byB,oT);byB.prototype.j=function(){return[]};
g.r(iys,oT);iys.prototype.j=function(){return[]};
g.r(soq,oT);soq.prototype.j=function(){return[]};
g.r(QoY,oT);QoY.prototype.j=function(){return[]};
g.r(OyB,oT);OyB.prototype.j=function(){return[]};
g.r(M$B,oT);M$B.prototype.j=function(){return[]};
g.r(xPX,oT);xPX.prototype.j=function(){var C=[];this.U.trackDownloadMetadatas&&C.push.apply(C,g.w(this.U.trackDownloadMetadatas));return[].concat(g.w(new Set(C)))};
g.r(Gmm,oT);
Gmm.prototype.j=function(){var C=[];this.U.downloadedTracks&&C.push.apply(C,g.w(this.U.downloadedTracks));this.U.smartDownloadedTracks&&C.push.apply(C,g.w(this.U.smartDownloadedTracks));this.U.downloadedEpisodes&&C.push.apply(C,g.w(this.U.downloadedEpisodes));this.U.downloadedAlbumReleases&&C.push.apply(C,g.w(this.U.downloadedAlbumReleases));this.U.smartDownloadedAlbumReleases&&C.push.apply(C,g.w(this.U.smartDownloadedAlbumReleases));this.U.downloadedPlaylists&&C.push.apply(C,g.w(this.U.downloadedPlaylists));this.U.smartDownloadedPlaylists&&
C.push.apply(C,g.w(this.U.smartDownloadedPlaylists));this.U.metadataOnlyTracks&&C.push.apply(C,g.w(this.U.metadataOnlyTracks));return[].concat(g.w(new Set(C)))};
g.r($PU,oT);$PU.prototype.j=function(){var C=[];this.U.trackDownloadMetadatas&&C.push.apply(C,g.w(this.U.trackDownloadMetadatas));return[].concat(g.w(new Set(C)))};
g.r(ZyC,oT);ZyC.prototype.j=function(){var C=[];this.U.playbackData&&C.push(this.U.playbackData);this.U.localImageEntities&&C.push.apply(C,g.w(this.U.localImageEntities));this.U.videoDownloadContextEntity&&C.push(this.U.videoDownloadContextEntity);return[].concat(g.w(new Set(C)))};
g.r(nDm,oT);nDm.prototype.j=function(){var C=[];this.U.musicLibraryStatusEntity&&C.push(this.U.musicLibraryStatusEntity);this.U.primaryArtists&&C.push.apply(C,g.w(this.U.primaryArtists));this.U.details&&C.push(this.U.details);this.U.userDetails&&C.push(this.U.userDetails);this.U.tracks&&C.push.apply(C,g.w(this.U.tracks));this.U.share&&C.push(this.U.share);this.U.downloadMetadata&&C.push(this.U.downloadMetadata);this.U.refresh&&C.push(this.U.refresh);return[].concat(g.w(new Set(C)))};
g.r(B3$,oT);B3$.prototype.j=function(){var C=[];this.U.albumRelease&&C.push(this.U.albumRelease);this.U.tracks&&C.push.apply(C,g.w(this.U.tracks));return[].concat(g.w(new Set(C)))};
g.r(zIs,oT);zIs.prototype.j=function(){var C=[];this.U.albumRelease&&C.push(this.U.albumRelease);return[].concat(g.w(new Set(C)))};
g.r(T3M,oT);T3M.prototype.j=function(){var C=[];this.U.details&&C.push(this.U.details);this.U.userDetails&&C.push(this.U.userDetails);return[].concat(g.w(new Set(C)))};
g.r(mPX,oT);mPX.prototype.j=function(){var C=[];this.U.parentArtist&&C.push(this.U.parentArtist);return[].concat(g.w(new Set(C)))};
g.r(t$q,oT);t$q.prototype.j=function(){var C=[];this.U.parentArtist&&C.push(this.U.parentArtist);return[].concat(g.w(new Set(C)))};
g.r(UPB,oT);UPB.prototype.j=function(){return[]};
g.r(A0m,oT);A0m.prototype.j=function(){return[]};
g.r(r0X,f6);r0X.prototype.j=function(){var C=[];this.U.creatorEntity&&C.push(this.U.creatorEntity);return[].concat(g.w(new Set(C)))};
g.r(Ien,oT);
Ien.prototype.j=function(){var C=[];this.U.tracks&&C.push.apply(C,g.w(this.U.tracks));this.U.refresh&&C.push(this.U.refresh);this.U.musicLibraryStatusEntity&&C.push(this.U.musicLibraryStatusEntity);this.U.details&&C.push(this.U.details);this.U.downloadMetadata&&C.push(this.U.downloadMetadata);this.U.sideloadMetadata&&C.push(this.U.sideloadMetadata);this.U.userDetails&&C.push(this.U.userDetails);this.U.entryCollection&&C.push(this.U.entryCollection);this.U.share&&C.push(this.U.share);this.U.podcastShowAdditionalMetadata&&C.push.apply(C,
g.w((new r0X(this.U.podcastShowAdditionalMetadata)).j()));return[].concat(g.w(new Set(C)))};
g.r(S2q,oT);S2q.prototype.j=function(){return[]};
g.r(XMG,oT);
XMG.prototype.j=function(){var C=[];this.U.musicLibraryStatusEntity&&C.push(this.U.musicLibraryStatusEntity);this.U.artists&&C.push.apply(C,g.w(this.U.artists));this.U.audioModeVersion&&C.push(this.U.audioModeVersion);this.U.videoModeVersion&&C.push(this.U.videoModeVersion);this.U.userDetails&&C.push(this.U.userDetails);this.U.details&&C.push(this.U.details);this.U.albumRelease&&C.push(this.U.albumRelease);this.U.share&&C.push(this.U.share);this.U.libraryEdit&&C.push(this.U.libraryEdit);this.U.downloadMetadata&&
C.push(this.U.downloadMetadata);this.U.playbackPosition&&C.push(this.U.playbackPosition);this.U.lyrics&&C.push(this.U.lyrics);return[].concat(g.w(new Set(C)))};
g.r(Ksq,oT);Ksq.prototype.j=function(){var C=[];this.U.parentTrack&&C.push(this.U.parentTrack);return[].concat(g.w(new Set(C)))};
g.r(RIY,oT);RIY.prototype.j=function(){var C=[];this.U.parentTrack&&C.push(this.U.parentTrack);return[].concat(g.w(new Set(C)))};
g.r(uIM,oT);uIM.prototype.j=function(){return[]};
g.r(wMC,oT);wMC.prototype.j=function(){return[]};
g.r(eIl,oT);eIl.prototype.j=function(){return[]};
g.r(dP$,oT);dP$.prototype.j=function(){return[]};
g.r(c0q,oT);c0q.prototype.j=function(){var C=[];this.U.transfer&&C.push(this.U.transfer);this.U.adsPlaybackData&&C.push.apply(C,g.w(this.U.adsPlaybackData));this.U.drmLicense&&C.push(this.U.drmLicense);this.U.offlineVideoPolicy&&C.push(this.U.offlineVideoPolicy);this.U.videoDownloadContextEntity&&C.push(this.U.videoDownloadContextEntity);return[].concat(g.w(new Set(C)))};
g.r(P6C,oT);P6C.prototype.j=function(){return[]};
g.r(vD3,oT);vD3.prototype.j=function(){var C=[];this.U.offlineVideoStreams&&C.push.apply(C,g.w(this.U.offlineVideoStreams));this.U.captionTrack&&C.push.apply(C,g.w(this.U.captionTrack));return[].concat(g.w(new Set(C)))};
g.r(aeM,oT);aeM.prototype.j=function(){return[]};
g.r(LsM,oT);LsM.prototype.j=function(){return[]};
g.r(V$m,oT);V$m.prototype.j=function(){return[]};
g.r(feq,oT);feq.prototype.j=function(){return[]};
g.r(oDq,oT);oDq.prototype.j=function(){return[]};
g.r(FsM,oT);FsM.prototype.j=function(){return[]};
g.r(joG,oT);joG.prototype.j=function(){return[]};
g.r(y0M,oT);y0M.prototype.j=function(){return[]};
g.r(Y2C,oT);Y2C.prototype.j=function(){return[]};
g.r(DP3,oT);DP3.prototype.j=function(){return[]};
g.r(kmm,oT);kmm.prototype.j=function(){return[]};
g.r(hI$,oT);hI$.prototype.j=function(){return[]};
g.r(pM$,oT);pM$.prototype.j=function(){return[]};
g.r(WsC,oT);WsC.prototype.j=function(){return[]};
g.r(q2I,oT);q2I.prototype.j=function(){return[]};
g.r(J0I,oT);J0I.prototype.j=function(){return[]};
g.r(HyR,oT);HyR.prototype.j=function(){return[]};
g.r(N3I,oT);N3I.prototype.j=function(){return[]};
g.r(EDm,oT);EDm.prototype.j=function(){return[]};
g.r(gD$,oT);gD$.prototype.j=function(){return[]};
var EBI=["browse","music/browse","unplugged/browse"],iuq=["offline/playlist_sync_check"],DmI=["offline"],gBU=["offline/offline_video_playback_position_sync"],l1X=["offline/get_playback_data_entity"],FX;jJ.getInstance=function(){return g.V(function(C){return C.return(new Promise(function(l){g.gJ().then(function(b){b?(jJ.instance||(jJ.instance=new jJ(b)),l(jJ.instance)):l(void 0)})}))})};
jJ.prototype.get=function(C){var l=this,b,Q,O;return g.V(function(M){if(M.j==1)return g.P(M,i8R(l.token),2);if(M.j!=3)return b=M.U,g.P(M,b.get("prefs",C),3);Q=M.U;if(!Q)return M.return();O=(0,g.h)();return Q.expirationTimestampMs<=O?M.return():M.return(Q.value)})};
jJ.prototype.set=function(C,l,b){b=b===void 0?31536E3:b;var Q=this,O,M,x;return g.V(function(Z){if(Z.j==1)return O=(0,g.h)(),M={key:C,value:l,expirationTimestampMs:O+b*1E3},g.P(Z,i8R(Q.token),2);x=Z.U;return g.P(Z,g.LC(x,"prefs",M),0)})};
jJ.prototype.remove=function(C){var l=this,b;return g.V(function(Q){if(Q.j==1)return g.P(Q,i8R(l.token),2);b=Q.U;return g.P(Q,b.delete("prefs",C),0)})};
g.r(yA,g.qO);g.r(YW,xEn);YW.prototype.Z=function(C,l){l=$El(l);C=(new TextEncoder).encode(JSON.stringify(C));return this.U.encrypt(C,l)};
YW.prototype.j=function(C,l){if(!(C instanceof Uint8Array))throw s5R(1);var b=new TextDecoder;l=$El(l);C=this.U.decrypt(C,l);return JSON.parse(b.decode(C))};
var Z83={accountLinkStatusEntity:uWU,booleanEntity:ttn,buttonEntity:pM$,captionTrack:uIM,channelHandle:T8M,commerceAcquisitionClientPayloadEntity:q2I,commerceCartListEntity:J0I,contextNoteFeedEntityPayload:m4B,continuationTokenEntity:Y5B,downloadQualityPickerEntity:c1I,downloadsPageRefreshTokenEntity:v5s,downloadsPageViewConfigurationEntity:N8B,downloadStatusEntity:PNR,dismissState:joG,sfvAudioItemCurrentlyPlayingEntity:feq,emojiFountainDataEntity:kmm,emojiCustomizationSetEntity:DP3,fakeChannel:A13,
fakePlaylist:r1U,fakePlaylistEntryCollection:S5X,fakeVideo:Xln,fakeVideoDescription:KpG,featuredProductsEntity:QoY,flowStateEntity:RPG,iconBadgeEntity:HyR,interstitialInteractionStateEntity:ePs,likeButtonAnimationEntity:E5R,liveChatPollStateEntity:d4M,liveViewerLeaderboardChatEntryPointStateEntity:LsM,liveViewerLeaderboardPointsEntity:V$m,liveReactionsDataEntity:hI$,logoEntity:wlY,macroMarkerEntity:g5M,mainDownloadsLibraryEntity:aKR,mainDownloadsListEntity:Vts,mainPlaylistDownloadStateEntity:fKs,
mainPlaylistEntity:D4G,mainPlaylistVideoEntity:kRC,mainVideoDownloadStateEntity:o5n,mainVideoEntity:q53,markersEngagementPanelSyncEntity:C6R,markersVisibilityOverrideEntity:leC,musicAlbumReleaseDetail:B3$,musicAlbumReleaseDownloadMetadataEntity:xPX,musicAlbumRelease:nDm,musicAlbumReleaseUserDetail:zIs,musicArtistDetail:mPX,musicArtist:T3M,musicArtistUserDetail:t$q,musicDownloadsLibraryEntity:Gmm,musicLibraryEdit:UPB,musicLibraryStatusEntity:A0m,musicPlaylist:Ien,musicPlaylistDownloadMetadataEntity:$PU,
musicShare:S2q,musicTrackDetail:Ksq,musicTrackDownloadMetadataEntity:ZyC,musicTrack:XMG,musicTrackUserDetail:RIY,offlineOrchestrationActionWrapperEntity:wMC,offlineVideoPolicy:eIl,offlineVideoStreams:dP$,offlineabilityEntity:FpM,orchestrationWebSamplingEntity:jbX,pageHeaderEntity:y0M,pdpStateEntity:N3I,pinnedProductEntity:OyB,playbackData:c0q,playerStateEntity:byB,quantityIncrementerEntity:EDm,refresh:P6C,saveToPlaylistListEntity:oDq,settingEntity:FsM,stringEntity:U4$,suggestedFeedbackChipStateEntity:iys,
transfer:vD3,trendingOfferEntity:M$B,videoDownloadContextEntity:aeM,videoOverviewAsyncDataEntity:gD$,videoPlaybackPositionEntity:WsC,votingEntity:Y2C,ytMainChannelEntity:J1B,youchatPendingResponseEntity:soq,ytMainDownloadedVideoEntity:y1M,ytMainVideoEntity:Hd$};g.r(qR,xEn);qR.prototype.Z=function(C){return C};
qR.prototype.j=function(C){if(C instanceof Uint8Array)throw s5R(0);return C};
g.r(JK,g.F);JK.prototype.observe=function(C){var l=this;this.observers.push(C);return function(){var b=l.observers.indexOf(C);b>=0&&l.observers.splice(b,1)}};
JK.prototype.j=function(C){ReM(this,C.data)};
JK.prototype.QY=function(){this.channel.close()};
var c2R,eq3=new g.u5("elementsCommand");var Kc=new g.u5("entityBatchUpdate");var mmR=new g.u5("downloadStatusEntity");var v03=new g.u5("mainPlaylistEntityActionMetadata");var NF=new g.u5("mainVideoEntityActionMetadata");var Yvl=new g.u5("musicPlaylistEntityActionMetadata");var BEq=new g.u5("musicTrackEntityActionMetadata");var qhC=new g.u5("localImageEntityActionMetadata");var Vt=new g.u5("playbackDataActionMetadata");var dcl=new g.u5("transferEntityActionMetadata");var zfG=new g.u5("videoPlaybackPositionEntityActionMetadata");var pAl;new g.zQ;new g.zQ;NuI.prototype.request=function(C,l,b){l=l===void 0?{}:l;return this.locks.request(C,l,function(Q){return b(Q)})};var i9=g.qp.caches,b9,bWB;l9.prototype.open=function(C){return i9.open(CHM(C))};
l9.prototype.has=function(C){return i9.has(CHM(C))};
l9.prototype.delete=function(C){return i9.delete(CHM(C))};
l9.prototype.match=function(C,l){var b=this,Q,O,M,x,Z,n;return g.V(function(B){switch(B.j){case 1:return g.P(B,b.keys(),2);case 2:Q=B.U,O=g.I(Q),M=O.next();case 3:if(M.done){B.oY(5);break}x=M.value;return g.P(B,b.open(x),6);case 6:return Z=B.U,g.P(B,Z.match(C,l),7);case 7:if(n=B.U)return B.return(n);M=O.next();B.oY(3);break;case 5:return B.return()}})};
g.r(g4m,l9);g4m.prototype.keys=function(){var C,l,b,Q,O,M,x,Z,n;return g.V(function(B){if(B.j==1)return C=[],l=g.J3("CacheStorage keys"),g.P(B,i9.keys(),2);b=B.U;Q=g.I(b);for(O=Q.next();!O.done;O=Q.next()){M=O.value;var z=M.indexOf(":");x=z===-1?{CG:M}:{CG:M.substring(0,z),datasyncId:M.substring(z+1)};Z=x.CG;n=x.datasyncId;n===l&&C.push(Z)}return B.return(C)})};g.r(Qt,g.F);Qt.prototype.Z=function(C){this.api.VY("onOfflineOperationFailure",C.data)};
Qt.prototype.C=function(C){this.api.publish("offlinetransferpause",C.data)};
Qt.prototype.QY=function(){var C;(C=this.U)==null||C.close();var l;(l=this.j)==null||l.close()};QvG.prototype.df=function(){this.U&&MF(this)};
QvG.prototype.pG=function(){this.j&&this.j.resolve();this.Z=this.U=!1;this.Y()};var paY=["OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"];var RqX="captionTrack downloadStatusEntity ytMainChannelEntity mainPlaylistEntity mainPlaylistDownloadStateEntity mainPlaylistVideoEntity mainVideoEntity mainVideoDownloadStateEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity videoPlaybackPositionEntity".split(" ");var fvG="downloadStatusEntity musicAlbumRelease musicDownloadsLibraryEntity musicPlaylist musicTrack musicTrackDownloadMetadataEntity offlineVideoPolicy offlineVideoStreams playbackData transfer videoDownloadContextEntity".split(" ");g.r(Qa$,ve);Qa$.prototype.j=function(C){return ZE(C)?xcq(this,C):nc(C)?Zul(this,C):Promise.reject(Error("Unsupported action type: "+C.actionType))};g.r(nKs,ve);nKs.prototype.j=function(C){return nc(C)?BDm(this,C):Trn(C)?TD3(this,C):Be(C)?mcU(this,C):Promise.reject(Error("Unsupported action type: "+C.actionType))};g.A=tsY.prototype;g.A.RnE=function(C){var l=this,b,Q,O,M;return g.V(function(x){if(!g.q(C.state,128))return x.oY(0);b=C.state.mF;var Z=(Q=b)==null?void 0:Q.errorCode,n=(O=b)==null?void 0:O.J2;M=Z==="net.connect"&&n===1?"TRANSFER_FAILURE_REASON_NETWORK_LOST":(Z==null?0:Z.startsWith("net."))?"TRANSFER_FAILURE_REASON_NETWORK":"TRANSFER_FAILURE_REASON_INTERNAL";return g.P(x,l.m$(l.player.getVideoData().videoId,M),0)})};
g.A.m$=function(C,l){var b=this;return g.V(function(Q){if(Q.j==1){if(b.j)return Q.return();b.j=!0;return l==="TRANSFER_FAILURE_REASON_NETWORK_LOST"?(FK(b,C,!1,!0),Q.oY(0)):g.P(Q,oC(b,C),3)}g.Vc(C,4);return g.P(Q,b.U.m$(l),0)})};
g.A.bT=function(C){C.status===2?(C.status!==this.Z&&(BAR(this.U),g.Vc(C.videoId,2)),C.KB&&UkU(this.U,C.videoId,C.KB)):C.status===4?(oC(this,C.videoId),this.m$(C.videoId,C.Ny?"TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":"TRANSFER_FAILURE_REASON_INTERNAL")):C.status===1&&tmY(this.U);this.Z=C.status;this.api.VY("localmediachange",{videoId:C.videoId,status:C.status})};
g.A.KL=function(){var C=this,l;return g.V(function(b){if(b.j==1){if(C.j)return b.return();C.j=!0;l=C.player.getVideoData().videoId;return g.P(b,oC(C,l),2)}return g.P(b,C.U.KL(),0)})};
g.A.bB=function(C){switch(C){case "HD_1080":return"hd1080";case "HD":return"hd720";case "SD":return"large";case "LD":return"tiny";default:return"hd720"}};
g.A.D=function(C){return this.api.J().D(C)};g.r(K6M,ve);K6M.prototype.j=function(C){return ZE(C)?uuq(this,C):nc(C)?waC(this,C):Trn(C)?efG(this,C):Promise.reject(Error("Unsupported action type: "+C.actionType))};L6Y.prototype.U=function(C,l){var b=C.action.actionMetadata.priority-l.action.actionMetadata.priority;b===0&&(C.U<l.U?b=-1:C.U>l.U&&(b=1));return b};g.r(jb,g.F);jb.prototype.QY=function(){this.Y&&this.Y();g.F.prototype.QY.call(this)};
jb.prototype.createAction=function(C,l){var b=g.Eb(C.entityKey).entityType,Q=g.KA(16);return new UV(b,Q,C,l.actionId,l.rootActionId)};
jb.prototype.aY=function(C){var l=this,b,Q,O,M,x,Z,n,B,z;return g.V(function(T){if(T.j==1){if(l.Xu())return T.return();Q=(b=C.offlineOrchestrationActionWrapperEntity)!=null?b:new Set;O=[];M=g.I(Q);for(x=M.next();!x.done;x=M.next())Z=x.value,n=g.Eb(Z),B=n.entityId,oKs(l.U,B)||O.push(Z);return g.P(T,JYq(l,O),2)}z=T.U;return g.P(T,qgn(l,z),0)})};
jb.prototype.retry=function(){var C=this;return g.V(function(l){return g.P(l,Huq(C),0)})};EKI.prototype.mR=function(C,l){l=l===void 0?!0:l;var b=this,Q,O,M,x,Z,n,B,z;return g.V(function(T){switch(T.j){case 1:if(!b.U)return T.return();Q=[];O=g.lf(b.U.j,l);M=[];for(x={FA:0};x.FA<O.length;x={FA:x.FA},x.FA++)Z=O[x.FA],n=b.U.GL(Z,"json3"),B=g.c7(n,{withCredentials:!0,format:"RAW"},3,500).then(function(m){return function(t){t={metadata:g.rx(O[m.FA]),trackData:t.xhr.responseText};M.push(t)}}(x)).cF(function(m){sV("Caption fetch error",m)}),Q.push(B);
return g.P(T,zPR(Q),2);case 2:return g.IP(T,3),g.P(T,Fe$(C,M),5);case 5:g.RP(T,0);break;case 3:z=g.ek(T),sV("Caption DB transaction error",z),g.r6(T)}})};g.r(Ys,g.F);Ys.prototype.QY=function(){this.j&&this.j();g.F.prototype.QY.call(this)};
Ys.prototype.Z=function(C){var l=this,b,Q,O,M,x,Z,n,B;return g.V(function(z){Q=(b=C.transfer)!=null?b:new Set;O=[];M=g.I(Q);for(x=M.next();!x.done;x=M.next())Z=x.value,n=g.Eb(Z),B=n.entityId,O.push(B);return O.length===0?z.return():g.P(z,l8l(l,O),0)})};g.r(OLl,g.F);g.A=OLl.prototype;g.A.QY=function(){this.Fu&&this.Fu();this.AE.dispose();this.C.dispose();this.CC&&g.l_(this.S.W9,this.CC);this.v_&&g.l_(this.S.W9,this.v_);g.F.prototype.QY.call(this)};
g.A.Gi7=function(C){var l=this,b,Q,O;return g.V(function(M){switch(M.j){case 1:b=g.gG(C,"transfer");if(l.U&&b===l.U.key){FK(l.K,l.B,!0);l.C.stop();M.oY(0);break}return g.P(M,HK(l.j,{mode:"readwrite",Wm:!0},function(x){return D4(x,b,"transfer").then(function(Z){if(Z&&Z.transferState!=="TRANSFER_STATE_COMPLETE"&&Z.transferState!=="TRANSFER_STATE_FAILED")return Z.transferState="TRANSFER_STATE_PAUSED_BY_USER",p6(x,Z,"transfer").then(function(){return Z})})}),3);
case 3:Q=M.U;if(!Q){M.oY(0);break}if(!C||!l.Z){M.oY(5);break}return g.P(M,zY(C,l.Z,l.j,"DOWNLOAD_STATE_PAUSED"),5);case 5:return g.P(M,hJ(l,C),7);case 7:O=M.U,BrM({videoId:C,s0:Q,offlineModeType:O}),g.r6(M)}})};
g.A.L_r=function(){var C=this;if(this.U&&this.B){FK(this.K,this.B,!1);var l=this.U,b=(l==null?0:l.key)?g.Eb(l.key).entityId:"";b&&this.Z&&(new Promise(function(Q,O){zY(b,C.Z,C.j,"DOWNLOAD_STATE_PAUSED").catch(function(M){O(M)})})).catch(function(Q){sV("Download state setting error",Q)})}this.C.stop()};
g.A.pB=function(){this.U?GDq(this,this.U):ks(this)};
g.A.TC=function(C){var l=this;return g.V(function(b){switch(b.j){case 1:if(!l.U){b.oY(2);break}if(l.U.transferState==="TRANSFER_STATE_COMPLETE"||l.U.transferState==="TRANSFER_STATE_FAILED"||!C.transfer||!C.transfer.has(l.U.key)){b.oY(3);break}return g.P(b,Ec(l.j,l.U.key,"transfer"),4);case 4:l.U=b.U;if(l.U){b.oY(3);break}return g.P(b,$kq(l),3);case 3:if(l.U)return b.return();case 2:return g.P(b,ks(l),0)}})};
g.A.m$=function(C,l){var b=this,Q,O,M,x,Z;return g.V(function(n){switch(n.j){case 1:if(!b.U){pc(b,"onTransferFailure: "+C);n.oY(2);break}Q=b.U;M=((O=Q)==null?0:O.key)?g.Eb(Q.key).entityId:"";a:switch(C){case "TRANSFER_FAILURE_REASON_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_EXTERNAL_FILESYSTEM_WRITE":case "TRANSFER_FAILURE_REASON_PLAYABILITY":case "TRANSFER_FAILURE_REASON_TOO_MANY_RETRIES":var B=!1;break a;default:B=!0}return B&&Ahm(b)?g.P(n,We(b,"TRANSFER_STATE_TRANSFER_IN_QUEUE"),8):g.P(n,
rhY(b,C),5);case 5:if(!M||!b.Z){n.oY(2);break}return g.P(n,zY(M,b.Z,b.j,"DOWNLOAD_STATE_FAILED"),2);case 8:return g.P(n,hJ(b,M),9);case 9:x=n.U;GY({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_RETRY"},{videoId:M,s0:Q,offlineModeType:x});if(!M||!b.Z){n.oY(2);break}return g.P(n,zY(M,b.Z,b.j,"DOWNLOAD_STATE_RETRYABLE_FAILURE"),2);case 2:DE(b),Z=ks(b,!0),l&&l(Z),g.r6(n)}})};
g.A.KL=function(C){var l=this,b,Q,O,M,x,Z,n,B,z,T,m,t;return g.V(function(U){switch(U.j){case 1:if(!l.U){pc(l,"onMaybeTransferStreamsExpired");U.oY(2);break}return Ahm(l)?g.P(U,We(l,"TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"),9):g.P(U,rhY(l,"TRANSFER_FAILURE_REASON_STREAM_MISSING"),5);case 5:if(!l.Z){U.oY(2);break}b=l.U;O=((Q=b)==null?0:Q.key)?g.Eb(b.key).entityId:"";if(!O){U.oY(2);break}return g.P(U,zY(O,l.Z,l.j,"DOWNLOAD_STATE_FAILED"),2);case 9:return l.U||pc(l,"onMaybeTransferStreamsExpiredRetryAttempting"),
M=l.U,Z=((x=M)==null?0:x.key)?g.Eb(M.key).entityId:"",g.P(U,hJ(l,Z),10);case 10:return n=U.U,GY({transferStatusType:"TRANSFER_STATUS_TYPE_DEQUEUED_BY_PLAYER_RESPONSE_EXPIRATION"},{videoId:Z,s0:M,offlineModeType:n}),B=AbC(),g.D_(B,Vt,{isEnqueuedForExpiredStreamUrlRefetch:!0}),z=g.gG(Z,"playbackData"),T={actionType:"OFFLINE_ORCHESTRATION_ACTION_TYPE_ADD",entityKey:z,actionMetadata:B},m=ri(new UV("playbackData",Z,T)),g.P(U,NR(l.j,m,"offlineOrchestrationActionWrapperEntity"),2);case 2:DE(l),t=ks(l,!0),
C&&C(t),g.r6(U)}})};
var KxR={},I8m=(KxR.TRANSFER_STATE_TRANSFERRING=1,KxR.TRANSFER_STATE_TRANSFER_IN_QUEUE=2,KxR);g.A=qF.prototype;g.A.jW=function(){return this.B.promise};
g.A.y7=function(){if(this.j&&this.K)return this.B.promise;K7s(this).then(this.B.resolve).catch(this.B.reject);return this.B.promise};
g.A.Lz=function(C){var l={};return l.playbackData=new Qa$(C,this.UC,this.U),l.transfer=new K6M(C,this.UC),l.videoPlaybackPositionEntity=new nKs(C,this.UC),l};
g.A.ev=function(){var C=this;return g.V(function(l){return C.j?g.P(l,MmI(C.j),0):l.oY(0)})};
g.A.NU=function(){var C=this,l,b;return g.V(function(Q){if(Q.j==1)return C.j||C.K?g.P(Q,C.jW(),2):Q.return();C.N!==void 0&&(g.Ac(C.N),C.N=void 0);C.C!==void 0&&(g.Ac(C.C),C.C=void 0);(l=C.j)==null||l.dispose();C.j=void 0;(b=C.K)==null||b.dispose();C.K=void 0;C.api.VY("onOrchestrationLostLeader");C.B=new g.zQ;g.r6(Q)})};
g.A.isOrchestrationLeader=function(){return this.Z.U};
g.A.cw=function(){return g.V(function(C){return C.return(!1)})};
g.A.t8=function(C){var l=this.U;l.api.publish("offlinetransferpause",C);var b;(b=l.j)==null||b.postMessage(C)};
g.A.pB=function(C){var l,b;return g.V(function(Q){if(Q.j==1)return g.P(Q,Cc(),2);l=Q.U;if(!l)return Q.return();b=g.gG(C,"transfer");return g.P(Q,HK(l,{mode:"readwrite",Wm:!0},function(O){var M=D4(O,b,"transfer"),x=D4(O,g.gG(C,"videoDownloadContextEntity"),"videoDownloadContextEntity");return g.R9.all([M,x]).then(function(Z){Z=g.I(Z);var n=Z.next().value;var B=Z.next().value;return n&&n.transferState==="TRANSFER_STATE_PAUSED_BY_USER"?(n.transferState="TRANSFER_STATE_TRANSFER_IN_QUEUE",p6(O,n,"transfer").then(function(){GY({transferStatusType:"TRANSFER_STATUS_TYPE_REENQUEUED_BY_USER_RESUME",
statusType:"USER_RESUMED"},{videoId:C,s0:n,offlineModeType:B==null?void 0:B.offlineModeType});return g.R9.resolve(null)})):g.R9.resolve(null)})}),0)})};
g.A.Bd=function(C){C=C===void 0?43200:C;var l=this,b,Q,O,M,x,Z,n,B;return g.V(function(z){if(z.j==1)return l.S.vS()?g.P(z,Cc(),2):z.return(RCR());if(z.j!=3){b=z.U;if(!b)return z.return([]);Q=Date.now()/1E3;return g.P(z,gF(b,"offlineVideoPolicy"),3)}O=z.U;M=[];x=g.I(O);for(Z=x.next();!Z.done;Z=x.next())n=Z.value,Number(n.lastUpdatedTimestampSeconds)+C<=Q&&(B=g.Eb(n.key).entityId,M.push(B));return M.length?z.return(JJ(l,M,l.Y,"OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH")):z.return([])})};
g.A.deleteAll=function(){return JJ(this,["!*$_ALL_ENTITIES_!*$"],this.Y,"OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",{offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}})};
g.A.refreshAllStaleEntities=function(C){var l=this;return g.V(function(b){return b.j==1?g.P(b,l.Bd(C),2):b.return(b.U)})};
g.A.setUpPositionSyncInterval=function(C){var l=this;this.C!==void 0&&(g.Ac(this.C),this.C=void 0);var b=C!=null?C:864E5;this.C=g.tc(function(){l.NQ(b)},b)};
g.A.NQ=function(C){var l=this,b,Q,O,M,x,Z;return g.V(function(n){switch(n.j){case 1:return g.IP(n,2),g.P(n,jJ.getInstance(),4);case 4:b=n.U;if(!b)throw Error("prefStorage is undefined");return g.P(n,b.get("psi"),5);case 5:Q=n.U;M=((O=Q)==null?0:O.LZ)?Number(Q.LZ)/1E3:0;x=Date.now();if(!(M+C<=x)){n.oY(6);break}return g.P(n,JJ(l,["!*$_ALL_ENTITIES_!*$"],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_REFRESH"),6);case 6:g.RP(n,0);break;case 2:Z=g.ek(n),sV("Offline manager error",Z),
g.r6(n)}})};
g.A.V5=function(){var C=this,l,b,Q,O,M,x,Z;return g.V(function(n){if(n.j==1)return g.P(n,Cc(),2);if(n.j!=3)return(l=n.U)?g.P(n,gF(l,"transfer"),3):n.return([]);b=n.U;Q=[];O=g.I(b);for(M=O.next();!M.done;M=O.next())x=M.value,x.transferState==="TRANSFER_STATE_WAITING_FOR_PLAYER_RESPONSE_REFRESH"&&x.key&&(Z=g.Eb(x.key).entityId,Q.push(Z));return n.return(wyM(C,Q))})};
g.A.EJ=function(){return g.V(function(C){return C.return([])})};
g.A.Vs=function(){return g.V(function(C){g.r6(C)})};
g.A.Hy=function(){return g.V(function(C){g.r6(C)})};g.r(eCR,ve);eCR.prototype.j=function(C){return ZE(C)?PrG(this,C):nc(C)?a8X(this,C):Be(C)?L7G(this,C):Promise.reject(Error("Unsupported action type: "+C.actionType))};
var He=[10];g.r(jcG,ve);jcG.prototype.j=function(C){return ZE(C)?DkB(this,C):nc(C)?kDs(this,C):Be(C)?hC$(this,C):Promise.reject(Error("Unsupported action type: "+C.actionType))};
var Yhs=[10];g.r(W7R,ve);W7R.prototype.j=function(C){return nc(C)?JhU(this,C):Promise.reject(Error("Unsupported action type: "+C.actionType))};g.r(HLn,qF);g.A=HLn.prototype;g.A.Lz=function(C){var l=qF.prototype.Lz.call(this,C);l.mainVideoEntity=new jcG(C,this.UC,this.U);l.mainPlaylistEntity=new eCR(C,this.UC,this.U);l.mainDownloadsListEntity=new W7R(C,this.UC,this.U);return l};
g.A.refreshAllStaleEntities=function(C,l){var b=this,Q,O,M,x,Z,n,B,z,T,m,t;return g.V(function(U){switch(U.j){case 1:Q=[];if(!b.UC.D("web_player_offline_playlist_auto_refresh")){U.oY(2);break}return g.P(U,NAX(b,C,l),3);case 3:Q=U.U;case 2:return g.P(U,jJ.getInstance(),4);case 4:return O=U.U,g.P(U,(M=O)==null?void 0:M.get("sdois"),5);case 5:return x=U.U,g.P(U,(Z=O)==null?void 0:Z.get("lmqf"),6);case 6:n=U.U;if(!x){U.oY(7);break}z=Q;T=z.concat;return g.P(U,E0M(b,x,(B=n)!=null?B:"SD",C===0),8);case 8:Q=
T.call(z,U.U);case 7:return m=Q,t=m.concat,g.P(U,qF.prototype.refreshAllStaleEntities.call(b,C,l),9);case 9:return Q=t.call(m,U.U),U.return(Q)}})};
g.A.cw=function(C){var l,b,Q,O,M,x,Z,n;return g.V(function(B){if(B.j==1)return g.P(B,Cc(),2);if(B.j!=3)return(l=B.U)?g.P(B,Ec(l,g.LZ,"mainDownloadsListEntity"),3):B.return(!1);b=B.U;if((Q=b)==null?0:(O=Q.downloads)==null?0:O.length)for(M=g.gG(C,"mainVideoEntity"),x=g.I(b.downloads),Z=x.next();!Z.done;Z=x.next())if(n=Z.value,n.videoItem===M)return B.return(!0);return B.return(!1)})};
g.A.EJ=function(){var C=this,l,b,Q,O,M,x,Z,n;return g.V(function(B){if(B.j==1)return g.P(B,Cc(),2);if(B.j!=3)return(l=B.U)?g.P(B,gF(l,"downloadStatusEntity"),3):B.return([]);b=B.U;Q=[];O=g.I(b);for(M=O.next();!M.done;M=O.next())x=M.value,x.downloadState==="DOWNLOAD_STATE_USER_DELETED"&&x.key&&(Z=g.Eb(x.key).entityId,Q.push(Z));return Q.length?(n={offlineLoggingData:{offlineDeleteReason:"OFFLINE_DELETE_REASON_USER_INITIATED"}},B.return(JJ(C,Q,"mainVideoEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_DELETE",
n))):B.return([])})};
g.A.Hy=function(){var C;return g.V(function(l){return l.j==1?g.P(l,Cc(),2):(C=l.U)?g.P(l,HK(C,{mode:"readwrite",Wm:!0},function(b){return kW(b,"mainVideoEntity").then(function(Q){var O=[];Q=g.I(Q);for(var M=Q.next();!M.done;M=Q.next()){M=M.value;var x=void 0;(x=M.userState)!=null&&x.playbackPosition||(x=g.Eb(M.key).entityId,x={key:g.gG(x,"videoPlaybackPositionEntity"),videoId:x,lastPlaybackPositionSeconds:"0"},O.push(p6(b,x,"videoPlaybackPositionEntity")),M.userState={playbackPosition:x.key},O.push(p6(b,
M,"mainVideoEntity")))}return g.R9.all(O)})}),0):l.return()})};
g.A.Vs=function(){var C,l,b,Q,O,M,x,Z,n,B,z,T,m,t,U,S,X,u,R,v,a,y,J,W,io,Qp,CR,GT,N,Sk,w6,km,RI,Gq,d6,uo,Qm,K;return g.V(function(xm){if(xm.j==1)return g.P(xm,Cc(),2);if(xm.j!=3){C=xm.U;if(!C)return xm.return();l=g.gG("DOWNLOADS_LIST_ENTITY_ID_MANUAL_DOWNLOADS","mainDownloadsListEntity");return g.P(xm,HK(C,{mode:"readonly",Wm:!0},function(WB){return g.R9.all([D4(WB,l,"mainDownloadsListEntity"),D4(WB,g.LZ,"mainDownloadsListEntity"),kW(WB,"mainVideoEntity"),kW(WB,"mainPlaylistEntity")])}),3)}b=xm.U;
Q=g.I(b);O=Q.next().value;M=Q.next().value;x=Q.next().value;Z=Q.next().value;n=O;B=M;z=x;T=Z;m=new Set;if((t=n)==null?0:(U=t.downloads)==null?0:U.length)for(S=g.I(n.downloads),X=S.next();!X.done;X=S.next())u=X.value,R=void 0,(v=(R=u.videoItem)!=null?R:u.playlistItem)&&m.add(v);if((a=B)==null?0:(y=a.downloads)==null?0:y.length)for(J=g.I(B.downloads),W=J.next();!W.done;W=J.next())io=W.value,io.videoItem&&m.add(io.videoItem);Qp=new Set;CR=[];GT=g.I(T);for(N=GT.next();!N.done;N=GT.next()){Sk=N.value;
if(Sk.videos)for(w6=g.I(Sk.videos),km=w6.next();!km.done;km=w6.next())RI=km.value,(Gq=JSON.parse(g.Eb(RI).entityId).videoId)&&Qp.add(Gq);Sk.key&&!m.has(Sk.key)&&CR.push(Sk.key)}d6=g.I(z);for(uo=d6.next();!uo.done;uo=d6.next())Qm=uo.value,Qm.key&&!m.has(Qm.key)&&(K=g.Eb(Qm.key).entityId,Qp.has(K)||CR.push(Qm.key));return CR.length?g.P(xm,vBX(C,CR),0):xm.oY(0)})};g.r(g0M,ve);g0M.prototype.j=function(C){return ZE(C)?ltq(this,C):nc(C)?bKB(this,C):Be(C)?iKR(this,C):Promise.reject(Error("Unsupported action type: "+C.actionType))};
var EV=[10];g.r(QpR,ve);QpR.prototype.j=function(C){return ZE(C)?MoY(this,C):nc(C)?xDB(this,C):Be(C)?G1C(this,C):Promise.reject(Error("Unsupported action type: "+C.actionType))};
var gi=[10];g.r(ndY,ve);ndY.prototype.j=function(C){return ZE(C)?mDM(this,C):nc(C)?toB(this,C):Be(C)?UDX(this,C):Promise.reject(Error("Unsupported action type: "+C.actionType))};
var TEX=[10];g.r(C_,qF);C_.prototype.Lz=function(C){var l=qF.prototype.Lz.call(this,C);l.musicTrack=new ndY(C,this.U);l.musicPlaylist=new QpR(C,this.U);l.musicAlbumRelease=new g0M(C,this.U);return l};
C_.prototype.refreshAllStaleEntities=function(C,l){var b=this,Q,O,M;return g.V(function(x){if(x.j==1)return g.P(x,rPM(b,C,l),2);if(x.j!=3)return O=Q=x.U,M=O.concat,g.P(x,qF.prototype.refreshAllStaleEntities.call(b,C,l),3);Q=M.call(O,x.U);return x.return(Q)})};g.r(Its,g.m5);g.A=Its.prototype;g.A.create=function(){var C=this;g.Y(this,this.events);if(g.lC(this.UC))this.U=new HLn(this.UC,this.player);else if(g.jN(this.UC)||g.sy(this.UC)==="WEB_MUSIC_INTEGRATIONS")this.U=new C_(this.UC,this.player);this.events.G(this.player,"onPlaybackStartExternal",function(){C.Tu()});
this.events.G(this.player,"videodatachange",function(){C.Tu()});
this.UC.D("html5_offline_playback_position_sync")&&this.events.G(this.player,"presentingplayerstatechange",this.Lb)};
g.A.Vf=function(){return!1};
g.A.iF=function(C,l,b,Q){var O=this;return g.V(function(M){return O.U?M.return(JJ(O.U,C,l,b,Q)):M.return(Promise.reject())})};
g.A.deleteAll=function(){return this.U.deleteAll()};
g.A.Bd=function(C){return this.U.Bd(C)};
g.A.refreshAllStaleEntities=function(C){return this.U.refreshAllStaleEntities(C)};
g.A.setUpPositionSyncInterval=function(C){this.U.setUpPositionSyncInterval(C)};
g.A.t8=function(C){this.U.t8(C)};
g.A.pB=function(C){return this.U.pB(C)};
g.A.Tu=function(){var C=this,l;return g.V(function(b){l=C.player.getVideoData();return g.Hz(l)?Sfm(l)&&C.j!==l.clientPlaybackNonce?g.P(b,XiG(C,l),0):b.oY(0):b.return()})};
g.A.Lb=function(C){var l=this,b,Q,O,M,x,Z,n;return g.V(function(B){if(B.j==1)return b=l.player.getVideoData(),Q=b.Nd,g.t6(C,2)||g.t6(C,512)?g.P(B,Cc(),2):B.return();if(B.j!=3){O=B.U;if(!O)return sV("PES is undefined"),B.return();M=b.videoId;return g.P(B,Ec(O,g.gG(M,"mainVideoEntity"),"mainVideoEntity"),3)}x=B.U;if(!x)return B.return();Z=Math.floor(Q).toString();n={videoPlaybackPositionEntityActionMetadata:{lastPlaybackPositionSeconds:Z}};return g.P(B,l.iF([M],"videoPlaybackPositionEntity","OFFLINE_ORCHESTRATION_ACTION_TYPE_UPDATE",
n),0)})};
g.A.isOrchestrationLeader=function(){return this.U.isOrchestrationLeader()};
g.A.updateDownloadState=function(C,l){var b,Q,O,M;return g.V(function(x){if(x.j==1)return g.P(x,Cc(),2);b=x.U;if(!b)return sV("PES is undefined"),x.return();Q=g.Eb(C);O=Q.entityType;M=Q.entityId;return g.P(x,zY(M,O,b,l,!0),0)})};g.T4("offline",Its);})(_yt_player);
